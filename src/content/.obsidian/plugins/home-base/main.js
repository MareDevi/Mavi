/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/utils/file-utils.ts
var file_utils_exports = {};
__export(file_utils_exports, {
  SUPPORTED_EXTENSIONS: () => SUPPORTED_EXTENSIONS2,
  VIEW_TYPE_MAP: () => VIEW_TYPE_MAP,
  getFileByPath: () => getFileByPath,
  getFileExtension: () => getFileExtension,
  getViewTypeForFile: () => getViewTypeForFile,
  isBaseFile: () => isBaseFile,
  isCanvasFile: () => isCanvasFile,
  isMarkdownLike: () => isMarkdownLike,
  isMdxFile: () => isMdxFile,
  isSupportedExtension: () => isSupportedExtension,
  leafHasFile: () => leafHasFile,
  pathsEqual: () => pathsEqual,
  trimFileExtension: () => trimFileExtension
});
function isSupportedExtension(extension) {
  return SUPPORTED_EXTENSIONS2.includes(extension);
}
function getFileExtension(path) {
  var _a;
  const parts = path.split(".");
  return parts.length > 1 ? ((_a = parts[parts.length - 1]) != null ? _a : "").toLowerCase() : "";
}
function getViewTypeForFile(file) {
  const ext = file.extension.toLowerCase();
  if (isSupportedExtension(ext)) {
    return VIEW_TYPE_MAP[ext];
  }
  return "markdown";
}
function isMarkdownLike(file) {
  const ext = file.extension.toLowerCase();
  return ext === "md" || ext === "mdx";
}
function isMdxFile(file) {
  return file.extension.toLowerCase() === "mdx";
}
function isCanvasFile(file) {
  return file.extension.toLowerCase() === "canvas";
}
function isBaseFile(file) {
  return file.extension.toLowerCase() === "base";
}
function getFileByPath(app, path) {
  const exactMatch = app.vault.getAbstractFileByPath(path);
  if (exactMatch instanceof import_obsidian6.TFile) {
    return exactMatch;
  }
  const file = app.metadataCache.getFirstLinkpathDest(path, "/");
  return file;
}
function trimFileExtension(path) {
  const lastDot = path.lastIndexOf(".");
  if (lastDot > 0) {
    const ext = path.slice(lastDot + 1).toLowerCase();
    if (SUPPORTED_EXTENSIONS2.includes(ext)) {
      return path.slice(0, lastDot);
    }
  }
  return path;
}
function pathsEqual(path1, path2) {
  const norm1 = trimFileExtension(path1).toLowerCase();
  const norm2 = trimFileExtension(path2).toLowerCase();
  return norm1 === norm2;
}
function leafHasFile(leaf, filePath) {
  var _a, _b;
  const state = (_b = (_a = leaf.view) == null ? void 0 : _a.getState) == null ? void 0 : _b.call(_a);
  const leafFile = state == null ? void 0 : state.file;
  if (!leafFile) return false;
  return pathsEqual(leafFile, filePath);
}
var import_obsidian6, SUPPORTED_EXTENSIONS2, VIEW_TYPE_MAP;
var init_file_utils = __esm({
  "src/utils/file-utils.ts"() {
    import_obsidian6 = require("obsidian");
    SUPPORTED_EXTENSIONS2 = ["md", "mdx", "canvas", "base"];
    VIEW_TYPE_MAP = {
      "md": "markdown",
      "mdx": "markdown",
      "canvas": "canvas",
      "base": "bases"
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => HomeBasePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian12 = require("obsidian");

// src/settings.ts
var HomeBaseType = /* @__PURE__ */ ((HomeBaseType2) => {
  HomeBaseType2["File"] = "File";
  HomeBaseType2["Workspace"] = "Workspace";
  HomeBaseType2["Random"] = "Random file";
  HomeBaseType2["RandomFolder"] = "Random in folder";
  HomeBaseType2["Graph"] = "Graph view";
  HomeBaseType2["None"] = "Nothing";
  HomeBaseType2["Journal"] = "Journal";
  HomeBaseType2["DailyNote"] = "Daily Note";
  HomeBaseType2["WeeklyNote"] = "Weekly Note";
  HomeBaseType2["MonthlyNote"] = "Monthly Note";
  HomeBaseType2["YearlyNote"] = "Yearly Note";
  return HomeBaseType2;
})(HomeBaseType || {});
var DEFAULT_SETTINGS = {
  // General
  homeBasePath: "",
  // Legacy
  homeBaseType: "File" /* File */,
  homeBaseValue: "",
  openOnStartup: true,
  openWhenEmpty: false,
  openViewMode: "default",
  openMode: "replace-all",
  manualOpenMode: "retain",
  // Tab Behavior
  replaceNewTab: false,
  newTabMode: "only-when-empty",
  keepExistingTabs: true,
  // UI Features
  showStickyHomeIcon: false,
  stickyIconName: "home",
  hideHomeTabHeader: false,
  replaceMobileNewTab: false,
  // Mobile
  separateMobile: false,
  mobileHomeBasePath: "",
  // Legacy
  mobileHomeBaseType: "File" /* File */,
  mobileHomeBaseValue: "",
  // Automation
  commandOnOpen: "",
  // View behavior
  revertView: false,
  autoScroll: false,
  hideReleaseNotes: false
  // OFF by default
};
var VIEW_MODE_OPTIONS = {
  "default": "Default",
  "preview": "Reading view",
  "source": "Source mode",
  "live": "Live Preview"
};
var NEW_TAB_MODE_OPTIONS = {
  "only-when-empty": "Only when no tabs are open",
  "always": "Always replace new tabs"
};
var OPENING_MODE_OPTIONS = {
  "replace-all": "Replace all open notes",
  "replace-last": "Replace last note",
  "retain": "Keep open notes"
};
var UNCHANGEABLE_TYPES = [
  "Random file" /* Random */,
  "Graph view" /* Graph */,
  "Nothing" /* None */,
  "Daily Note" /* DailyNote */,
  "Weekly Note" /* WeeklyNote */,
  "Monthly Note" /* MonthlyNote */,
  "Yearly Note" /* YearlyNote */
];

// src/ui/settings-tab.ts
var import_obsidian5 = require("obsidian");

// src/utils/settings-compat.ts
var import_obsidian = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading) {
  if ((0, import_obsidian.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (heading) {
    const headingEl = containerEl.createDiv("setting-group-heading");
    headingEl.createEl("h3", { text: heading });
  }
  return {
    addSetting(cb) {
      const setting = new import_obsidian.Setting(containerEl);
      cb(setting);
    }
  };
}

// src/ui/file-suggest.ts
var import_obsidian2 = require("obsidian");
var SUPPORTED_EXTENSIONS = ["md", "mdx", "canvas", "base"];
var FilePathSuggest = class extends import_obsidian2.AbstractInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
    this.inputEl = inputEl;
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    const files = [];
    this.app.vault.getAllLoadedFiles().forEach((file) => {
      if (file instanceof import_obsidian2.TFile) {
        if (SUPPORTED_EXTENSIONS.includes(file.extension)) {
          if (file.path.toLowerCase().includes(lowerQuery) || file.basename.toLowerCase().includes(lowerQuery)) {
            files.push(file);
          }
        }
      }
    });
    files.sort((a, b) => {
      const aStartsWith = a.path.toLowerCase().startsWith(lowerQuery);
      const bStartsWith = b.path.toLowerCase().startsWith(lowerQuery);
      if (aStartsWith && !bStartsWith) return -1;
      if (!aStartsWith && bStartsWith) return 1;
      return a.path.localeCompare(b.path);
    });
    return files.slice(0, 20);
  }
  renderSuggestion(file, el) {
    el.createEl("div", {
      text: file.basename,
      cls: "suggestion-title"
    });
    if (file.parent && file.parent.path !== "/") {
      el.createEl("small", {
        text: file.parent.path,
        cls: "suggestion-path"
      });
    }
    if (file.extension !== "md") {
      el.createEl("span", {
        text: file.extension.toUpperCase(),
        cls: "suggestion-flair"
      });
    }
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};
var FolderSuggest = class extends import_obsidian2.AbstractInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
    this.inputEl = inputEl;
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    const folders = [];
    this.app.vault.getAllLoadedFiles().forEach((file) => {
      if (file instanceof import_obsidian2.TFolder) {
        if (file.path.toLowerCase().includes(lowerQuery)) {
          folders.push(file);
        }
      }
    });
    folders.sort((a, b) => a.path.localeCompare(b.path));
    return folders.slice(0, 20);
  }
  renderSuggestion(folder, el) {
    el.createEl("div", { text: folder.path || "/" });
  }
  selectSuggestion(folder) {
    this.inputEl.value = folder.path;
    this.inputEl.trigger("input");
    this.close();
  }
};
var WorkspaceSuggest = class extends import_obsidian2.AbstractInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
    this.inputEl = inputEl;
  }
  getSuggestions(query) {
    var _a, _b, _c;
    const workspacesPlugin = (_b = (_a = this.app.internalPlugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b.workspaces;
    if (!(workspacesPlugin == null ? void 0 : workspacesPlugin.enabled) || !((_c = workspacesPlugin.instance) == null ? void 0 : _c.workspaces)) {
      return [];
    }
    const workspaces = Object.keys(workspacesPlugin.instance.workspaces);
    const lowerQuery = query.toLowerCase();
    return workspaces.filter(
      (workspace) => workspace.toLowerCase().includes(lowerQuery)
    );
  }
  renderSuggestion(workspace, el) {
    el.createEl("div", { text: workspace });
  }
  selectSuggestion(workspace) {
    this.inputEl.value = workspace;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/ui/command-suggest.ts
var import_obsidian3 = require("obsidian");
var CommandSuggest = class extends import_obsidian3.AbstractInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
    this.inputEl = inputEl;
  }
  getSuggestions(query) {
    var _a;
    const lowerQuery = query.toLowerCase();
    const commands = [];
    const appWithCommands = this.app;
    const allCommands = (_a = appWithCommands.commands) == null ? void 0 : _a.commands;
    if (allCommands) {
      for (const command of Object.values(allCommands)) {
        if (command.name.toLowerCase().includes(lowerQuery) || command.id.toLowerCase().includes(lowerQuery)) {
          commands.push(command);
        }
      }
    }
    commands.sort((a, b) => a.name.localeCompare(b.name));
    return commands.slice(0, 30);
  }
  renderSuggestion(command, el) {
    el.createEl("div", {
      text: command.name,
      cls: "suggestion-title"
    });
    el.createEl("small", {
      text: command.id,
      cls: "suggestion-note"
    });
  }
  selectSuggestion(command) {
    this.inputEl.value = command.id;
    this.inputEl.trigger("input");
    this.close();
  }
};
function getCommandById(app, commandId) {
  var _a;
  const appWithCommands = app;
  const commands = (_a = appWithCommands.commands) == null ? void 0 : _a.commands;
  return commands == null ? void 0 : commands[commandId];
}
function executeCommand(app, commandId) {
  var _a, _b;
  if (!commandId) return false;
  const appWithCommands = app;
  const result = (_b = (_a = appWithCommands.commands) == null ? void 0 : _a.executeCommandById) == null ? void 0 : _b.call(_a, commandId);
  return result !== false;
}

// src/ui/icon-picker.ts
var import_obsidian4 = require("obsidian");
var IconPicker = class extends import_obsidian4.Modal {
  constructor(app, currentIcon, callback) {
    super(app);
    this.searchResults = [];
    this.selectedIcon = currentIcon;
    this.callback = callback;
  }
  onOpen() {
    this.containerEl.addClass("mod-confirmation");
    this.modalEl.addClass("iconic-icon-picker");
    this.setTitle("Change icon");
    const searchSetting = new import_obsidian4.Setting(this.contentEl);
    if (!import_obsidian4.Platform.isPhone) {
      searchSetting.setName("Search");
    }
    searchSetting.addSearch((searchField) => {
      searchField.setPlaceholder("Search icons...").onChange(() => this.updateSearchResults());
      searchField.inputEl.enterKeyHint = "go";
      this.searchField = searchField;
    });
    if (this.selectedIcon) {
      this.searchField.setValue(this.selectedIcon);
    }
    this.searchResultsSetting = new import_obsidian4.Setting(this.contentEl);
    this.searchResultsSetting.settingEl.addClass("iconic-search-results");
    this.searchResultsSetting.settingEl.tabIndex = 0;
    this.searchResultsSetting.settingEl.addEventListener("wheel", (event) => {
      if (document.body.hasClass("mod-rtl")) {
        this.searchResultsSetting.settingEl.scrollLeft -= event.deltaY;
      } else {
        this.searchResultsSetting.settingEl.scrollLeft += event.deltaY;
      }
    }, { passive: true });
    const buttonContainer = this.modalEl.createDiv({ cls: "modal-button-container" });
    new import_obsidian4.ButtonComponent(buttonContainer).setButtonText("Cancel").onClick(() => this.close()).buttonEl.addClass("mod-cancel");
    new import_obsidian4.ButtonComponent(buttonContainer).setButtonText("Save").setCta().onClick(() => {
      this.callback(this.selectedIcon);
      this.close();
    });
    requestAnimationFrame(() => {
      this.searchField.inputEl.select();
      this.updateSearchResults();
    });
  }
  /**
   * Update search results based on current query
   */
  updateSearchResults() {
    const query = this.searchField.getValue().toLowerCase().trim();
    const fuzzySearch = (0, import_obsidian4.prepareFuzzySearch)(query);
    const matches = [];
    const iconIds = (0, import_obsidian4.getIconIds)();
    if (query) {
      for (const iconId of iconIds) {
        const iconName = this.formatIconName(iconId);
        if (iconId === query || iconId.toLowerCase() === query) {
          matches.push([0, [iconId, iconName]]);
        } else {
          const fuzzyMatch = fuzzySearch(iconName);
          if (fuzzyMatch) {
            matches.push([fuzzyMatch.score, [iconId, iconName]]);
          }
        }
      }
    } else {
      for (const iconId of iconIds) {
        const iconName = this.formatIconName(iconId);
        matches.push([0, [iconId, iconName]]);
      }
    }
    matches.sort(([scoreA], [scoreB]) => scoreA > scoreB ? -1 : 1);
    this.searchResults.length = 0;
    const maxResults = 100;
    for (const [, iconEntry] of matches) {
      this.searchResults.push(iconEntry);
      if (this.searchResults.length >= maxResults) break;
    }
    this.searchResultsSetting.clear();
    for (const [iconId, iconName] of this.searchResults) {
      this.searchResultsSetting.addExtraButton((iconButton) => {
        iconButton.setTooltip(iconName, {
          delay: 300,
          placement: import_obsidian4.Platform.isPhone ? "top" : "bottom"
        });
        const iconEl = iconButton.extraSettingsEl;
        iconEl.addClass("iconic-search-result");
        iconEl.tabIndex = -1;
        (0, import_obsidian4.setIcon)(iconEl, iconId);
        if (iconId === this.selectedIcon) {
          iconEl.addClass("is-selected");
        }
        iconEl.addEventListener("click", () => {
          this.selectedIcon = iconId;
          this.callback(iconId);
          this.close();
        });
        if (import_obsidian4.Platform.isPhone) {
          iconEl.addEventListener("contextmenu", () => {
            var _a;
            (_a = navigator.vibrate) == null ? void 0 : _a.call(navigator, 100);
          });
        }
      });
    }
    if (this.searchResults.length === 0) {
      this.searchResultsSetting.addExtraButton((button) => {
        button.extraSettingsEl.addClasses(["iconic-invisible", "iconic-search-result"]);
      });
    }
  }
  /**
   * Format icon ID into readable name
   */
  formatIconName(iconId) {
    let name = iconId.replace(/^lucide-/, "");
    name = name.replace(/-/g, " ");
    return name.split(" ").map(
      (word) => word.charAt(0).toUpperCase() + word.slice(1)
    ).join(" ");
  }
  onClose() {
    this.contentEl.empty();
  }
};

// src/ui/settings-tab.ts
var HomeBaseSettingTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const isMobile = this.plugin.settings.separateMobile;
    const activeType = isMobile ? this.plugin.settings.mobileHomeBaseType : this.plugin.settings.homeBaseType;
    const activeValue = isMobile ? this.plugin.settings.mobileHomeBaseValue : this.plugin.settings.homeBaseValue;
    const generalGroup = createSettingsGroup(containerEl);
    generalGroup.addSetting((setting) => {
      setting.setName("Homepage").setDesc("What to open as your home base").addDropdown((dropdown) => {
        let pluginDisabled = false;
        for (const type of Object.values(HomeBaseType)) {
          if (!this.plugin.hasRequiredPlugin(type)) {
            if (type === activeType) {
              pluginDisabled = true;
              dropdown.addOption(type, type);
            } else {
              dropdown.selectEl.createEl("option", {
                text: type,
                attr: { disabled: "true" }
              });
              continue;
            }
          } else {
            dropdown.addOption(type, type);
          }
        }
        dropdown.setValue(activeType || "File" /* File */).onChange(async (value) => {
          if (isMobile) {
            this.plugin.settings.mobileHomeBaseType = value;
          } else {
            this.plugin.settings.homeBaseType = value;
          }
          await this.plugin.saveSettings();
          const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
          const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
          this.display();
          requestAnimationFrame(() => {
            if (scrollContainer) {
              scrollContainer.scrollTop = scrollTop;
            }
          });
        });
        if (pluginDisabled) {
          setting.descEl.createDiv({
            text: "The plugin required for this homepage type isn't available.",
            cls: "mod-warning"
          });
        }
      });
    });
    if (!UNCHANGEABLE_TYPES.includes(activeType)) {
      generalGroup.addSetting((setting) => {
        let desc = "";
        let placeholder = "";
        if (activeType === "File" /* File */) {
          desc = "The file to open as your home base (supports .md, .mdx, .canvas, .base)";
          placeholder = "Path to home base file";
        } else if (activeType === "Workspace" /* Workspace */) {
          desc = "The workspace to load as your home base";
          placeholder = "Workspace name";
        } else if (activeType === "Random in folder" /* RandomFolder */) {
          desc = "The folder to pick a random file from";
          placeholder = "Folder path";
        } else if (activeType === "Journal" /* Journal */) {
          desc = "The journal name";
          placeholder = "Journal name";
        }
        setting.setName(activeType === "File" /* File */ ? "File" : activeType === "Workspace" /* Workspace */ ? "Workspace" : activeType === "Random in folder" /* RandomFolder */ ? "Folder" : activeType === "Journal" /* Journal */ ? "Journal" : "Value").setDesc(desc).addText((text) => {
          if (activeType === "File" /* File */) {
            new FilePathSuggest(this.app, text.inputEl);
          } else if (activeType === "Workspace" /* Workspace */) {
            new WorkspaceSuggest(this.app, text.inputEl);
          } else if (activeType === "Random in folder" /* RandomFolder */) {
            new FolderSuggest(this.app, text.inputEl);
          }
          text.setPlaceholder(placeholder).setValue(activeValue || "").onChange(async (value) => {
            if (isMobile) {
              this.plugin.settings.mobileHomeBaseValue = value;
              if (activeType === "File" /* File */) {
                this.plugin.settings.mobileHomeBasePath = value;
              }
            } else {
              this.plugin.settings.homeBaseValue = value;
              if (activeType === "File" /* File */) {
                this.plugin.settings.homeBasePath = value;
              }
            }
            await this.plugin.saveSettings();
          });
        });
      });
    }
    generalGroup.addSetting((setting) => {
      setting.setName("Open on startup").setDesc("Open the home base when launching Obsidian").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.openOnStartup).onChange(async (value) => {
          this.plugin.settings.openOnStartup = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Open when empty").setDesc("Open the home base when there's only one empty tab").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.openWhenEmpty).onChange(async (value) => {
          this.plugin.settings.openWhenEmpty = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Opening mode (startup)").setDesc("How to handle existing tabs when opening on startup").addDropdown((dropdown) => {
        for (const [value, label] of Object.entries(OPENING_MODE_OPTIONS)) {
          dropdown.addOption(value, label);
        }
        dropdown.setValue(this.plugin.settings.openMode).onChange(async (value) => {
          this.plugin.settings.openMode = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Opening mode (manual)").setDesc("How to handle existing tabs when opening manually").addDropdown((dropdown) => {
        for (const [value, label] of Object.entries(OPENING_MODE_OPTIONS)) {
          dropdown.addOption(value, label);
        }
        dropdown.setValue(this.plugin.settings.manualOpenMode).onChange(async (value) => {
          this.plugin.settings.manualOpenMode = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("View mode").setDesc("How to open markdown and MDX files (canvas/base use native views)").addDropdown((dropdown) => {
        for (const [value, label] of Object.entries(VIEW_MODE_OPTIONS)) {
          dropdown.addOption(value, label);
        }
        dropdown.setValue(this.plugin.settings.openViewMode).onChange(async (value) => {
          this.plugin.settings.openViewMode = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Revert view on close").setDesc("When navigating away from the home base, restore the default view").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.revertView).onChange(async (value) => {
          this.plugin.settings.revertView = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Auto-scroll").setDesc("When opening the home base, scroll to the bottom and focus on the last line").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.autoScroll).onChange(async (value) => {
          this.plugin.settings.autoScroll = value;
          await this.plugin.saveSettings();
        });
      });
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Hide release notes").setDesc("Never display release notes when Obsidian updates").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.hideReleaseNotes).onChange(async (value) => {
          this.plugin.settings.hideReleaseNotes = value;
          await this.plugin.saveSettings();
        });
      });
    });
    const tabGroup = createSettingsGroup(containerEl, "Tab Behavior");
    tabGroup.addSetting((setting) => {
      setting.setName("Replace new tabs").setDesc("Open home base instead of new empty tabs").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.replaceNewTab).onChange(async (value) => {
          this.plugin.settings.replaceNewTab = value;
          await this.plugin.saveSettings();
          const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
          const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
          this.display();
          requestAnimationFrame(() => {
            if (scrollContainer) {
              scrollContainer.scrollTop = scrollTop;
            }
          });
        });
      });
    });
    if (this.plugin.settings.replaceNewTab) {
      tabGroup.addSetting((setting) => {
        setting.setName("New tab replacement mode").setDesc("When to replace new tabs with home base").addDropdown((dropdown) => {
          for (const [value, label] of Object.entries(NEW_TAB_MODE_OPTIONS)) {
            dropdown.addOption(value, label);
          }
          dropdown.setValue(this.plugin.settings.newTabMode).onChange(async (value) => {
            this.plugin.settings.newTabMode = value;
            await this.plugin.saveSettings();
          });
        });
      });
    }
    const uiGroup = createSettingsGroup(containerEl, "UI Features");
    uiGroup.addSetting((setting) => {
      setting.setName("Sticky home icon").setDesc("Show a home icon in the tab bar that stays pinned to the left (desktop only)").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.showStickyHomeIcon).onChange(async (value) => {
          this.plugin.settings.showStickyHomeIcon = value;
          await this.plugin.saveSettings();
          this.plugin.updateStickyTabIcon();
          const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
          const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
          this.display();
          requestAnimationFrame(() => {
            if (scrollContainer) {
              scrollContainer.scrollTop = scrollTop;
            }
          });
        });
      });
    });
    if (this.plugin.settings.showStickyHomeIcon) {
      uiGroup.addSetting((setting) => {
        setting.setName("Icon").setDesc("The icon to display in the sticky home icon").addButton((button) => {
          const iconName = this.plugin.settings.stickyIconName || "home";
          button.setButtonText("Change icon").setIcon(iconName).onClick(() => {
            const picker = new IconPicker(
              this.app,
              this.plugin.settings.stickyIconName,
              (icon) => {
                void (async () => {
                  this.plugin.settings.stickyIconName = icon;
                  await this.plugin.saveSettings();
                  this.plugin.stickyTabService.update();
                  this.display();
                })();
              }
            );
            picker.open();
          });
        });
      });
      uiGroup.addSetting((setting) => {
        setting.setName("Hide tab header").setDesc("Hide the ghost tab header when it's open, using the sticky icon as the tab indicator").addToggle((toggle) => {
          toggle.setValue(this.plugin.settings.hideHomeTabHeader).onChange(async (value) => {
            this.plugin.settings.hideHomeTabHeader = value;
            await this.plugin.saveSettings();
            this.plugin.stickyTabService.updateTabHeaders();
          });
        });
      });
    }
    uiGroup.addSetting((setting) => {
      setting.setName("Replace mobile new tab button").setDesc("Change the mobile new tab button to a home icon").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.replaceMobileNewTab).onChange(async (value) => {
          this.plugin.settings.replaceMobileNewTab = value;
          await this.plugin.saveSettings();
          this.plugin.updateMobileButton();
        });
      });
    });
    const mobileGroup = createSettingsGroup(containerEl, "Mobile");
    mobileGroup.addSetting((setting) => {
      setting.setName("Separate mobile homepage").setDesc("Use a different homepage on mobile devices").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.separateMobile).onChange(async (value) => {
          this.plugin.settings.separateMobile = value;
          await this.plugin.saveSettings();
          const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
          const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
          this.display();
          requestAnimationFrame(() => {
            if (scrollContainer) {
              scrollContainer.scrollTop = scrollTop;
            }
          });
        });
      });
    });
    if (this.plugin.settings.separateMobile) {
      mobileGroup.addSetting((setting) => {
        setting.setName("Mobile homepage").setDesc("What to open as your home base on mobile").addDropdown((dropdown) => {
          for (const type of Object.values(HomeBaseType)) {
            dropdown.addOption(type, type);
          }
          dropdown.setValue(this.plugin.settings.mobileHomeBaseType || "File" /* File */).onChange(async (value) => {
            this.plugin.settings.mobileHomeBaseType = value;
            await this.plugin.saveSettings();
            const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
            const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
            this.display();
            requestAnimationFrame(() => {
              if (scrollContainer) {
                scrollContainer.scrollTop = scrollTop;
              }
            });
          });
        });
      });
      if (!UNCHANGEABLE_TYPES.includes(this.plugin.settings.mobileHomeBaseType)) {
        mobileGroup.addSetting((setting) => {
          const mobileType = this.plugin.settings.mobileHomeBaseType;
          let desc = "";
          let placeholder = "";
          if (mobileType === "File" /* File */) {
            desc = "The file to open as your home base on mobile";
            placeholder = "Path to home base file";
          } else if (mobileType === "Workspace" /* Workspace */) {
            desc = "The workspace to load as your home base on mobile";
            placeholder = "Workspace name";
          } else if (mobileType === "Random in folder" /* RandomFolder */) {
            desc = "The folder to pick a random file from on mobile";
            placeholder = "Folder path";
          } else if (mobileType === "Journal" /* Journal */) {
            desc = "The journal name for mobile";
            placeholder = "Journal name";
          }
          setting.setName(mobileType === "File" /* File */ ? "Mobile file" : mobileType === "Workspace" /* Workspace */ ? "Mobile workspace" : mobileType === "Random in folder" /* RandomFolder */ ? "Mobile folder" : mobileType === "Journal" /* Journal */ ? "Mobile journal" : "Mobile value").setDesc(desc).addText((text) => {
            if (mobileType === "File" /* File */) {
              new FilePathSuggest(this.app, text.inputEl);
            } else if (mobileType === "Workspace" /* Workspace */) {
              new WorkspaceSuggest(this.app, text.inputEl);
            } else if (mobileType === "Random in folder" /* RandomFolder */) {
              new FolderSuggest(this.app, text.inputEl);
            }
            text.setPlaceholder(placeholder).setValue(this.plugin.settings.mobileHomeBaseValue || "").onChange(async (value) => {
              this.plugin.settings.mobileHomeBaseValue = value;
              if (mobileType === "File" /* File */) {
                this.plugin.settings.mobileHomeBasePath = value;
              }
              await this.plugin.saveSettings();
            });
          });
        });
      }
    }
    const automationGroup = createSettingsGroup(containerEl, "Automation");
    automationGroup.addSetting((setting) => {
      const commandId = this.plugin.settings.commandOnOpen;
      const command = commandId ? getCommandById(this.app, commandId) : void 0;
      const displayValue = command ? command.name : commandId;
      setting.setName("Command on open").setDesc("Run an Obsidian command when opening home base").addText((text) => {
        new CommandSuggest(this.app, text.inputEl);
        text.setPlaceholder("Search for a command...").setValue(displayValue || "").onChange(async (value) => {
          this.plugin.settings.commandOnOpen = value;
          await this.plugin.saveSettings();
        });
      }).addExtraButton((btn) => {
        btn.setIcon("x").setTooltip("Clear command").onClick(async () => {
          this.plugin.settings.commandOnOpen = "";
          await this.plugin.saveSettings();
          const scrollContainer = containerEl.closest(".vertical-tab-content") || containerEl.closest(".settings-content") || containerEl.parentElement;
          const scrollTop = (scrollContainer == null ? void 0 : scrollContainer.scrollTop) || 0;
          this.display();
          requestAnimationFrame(() => {
            if (scrollContainer) {
              scrollContainer.scrollTop = scrollTop;
            }
          });
        });
      });
    });
  }
};

// src/services/home-service.ts
var import_obsidian8 = require("obsidian");
init_file_utils();

// src/utils/homebase-resolver.ts
var import_obsidian7 = require("obsidian");
function randomFile(app, root) {
  let files = app.vault.getFiles();
  if (root) {
    const resolvedRoot = app.vault.getFolderByPath(root);
    if (!resolvedRoot) return null;
    files = getFilesInFolder(resolvedRoot);
  }
  files = files.filter((f) => ["md", "canvas", "base"].includes(f.extension));
  if (files.length) {
    const index = Math.floor(Math.random() * files.length);
    return files[index] || null;
  }
  return null;
}
function getFilesInFolder(folder) {
  let files = [];
  for (const item of folder.children) {
    if (item instanceof import_obsidian7.TFile) {
      files.push(item);
    } else if (item instanceof import_obsidian7.TFolder) {
      files.push(...getFilesInFolder(item));
    }
  }
  return files;
}
function trimFile(file) {
  if (!file) return "";
  return file.extension === "md" ? file.path.slice(0, -3) : file.path;
}
async function getPeriodicNote(kind, plugin) {
  var _a, _b, _c, _d, _e, _f;
  const periodicNotes = (_b = (_a = plugin.app.plugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b["periodic-notes"];
  if (!periodicNotes) {
    if (kind === "Daily Note" /* DailyNote */ && ((_e = (_d = (_c = plugin.app.internalPlugins) == null ? void 0 : _c.plugins) == null ? void 0 : _d["daily-notes"]) == null ? void 0 : _e.enabled)) {
      const dailyNotes = plugin.app.internalPlugins.plugins["daily-notes"].instance;
      if (dailyNotes && window.moment) {
        const today = window.moment();
        const path = (_f = dailyNotes.getDailyNotePath) == null ? void 0 : _f.call(dailyNotes, today);
        return path ? path.replace(/\.md$/, "") : null;
      }
    }
    return null;
  }
  try {
    const dailyNotesModule = await import("obsidian-daily-notes-interface").catch(() => null);
    if (!dailyNotesModule) {
      return null;
    }
    const {
      createDailyNote,
      getDailyNote,
      getAllDailyNotes,
      createWeeklyNote,
      getWeeklyNote,
      getAllWeeklyNotes,
      createMonthlyNote,
      getMonthlyNote,
      getAllMonthlyNotes,
      createYearlyNote,
      getYearlyNote,
      getAllYearlyNotes
    } = dailyNotesModule;
    const info = {
      ["Daily Note" /* DailyNote */]: {
        noun: "day",
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        create: createDailyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        get: getDailyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        getAll: getAllDailyNotes
      },
      ["Weekly Note" /* WeeklyNote */]: {
        noun: "week",
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        create: createWeeklyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        get: getWeeklyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        getAll: getAllWeeklyNotes
      },
      ["Monthly Note" /* MonthlyNote */]: {
        noun: "month",
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        create: createMonthlyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        get: getMonthlyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        getAll: getAllMonthlyNotes
      },
      ["Yearly Note" /* YearlyNote */]: {
        noun: "year",
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        create: createYearlyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        get: getYearlyNote,
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        getAll: getAllYearlyNotes
      }
    };
    const kindInfo = info[kind];
    if (!kindInfo || !window.moment) return null;
    const date = window.moment().startOf(kindInfo.noun);
    const all = kindInfo.getAll();
    let note = null;
    if (!Object.keys(all).length) {
      note = await kindInfo.create(date);
    } else {
      note = kindInfo.get(date, all) || await kindInfo.create(date);
    }
    if (!note) note = kindInfo.get(date, all);
    return note ? trimFile(note) : null;
  } catch (e) {
    return null;
  }
}
async function getJournalNote(journalName, plugin) {
  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k;
  const journals = (_b = (_a = plugin.app.plugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b["journals"];
  if (!journals) return null;
  try {
    const journal = (_c = journals.journals) == null ? void 0 : _c.find((j) => j.name === journalName);
    if (!journal) return null;
    (_d = journals.reprocessNotes) == null ? void 0 : _d.call(journals);
    const origAutoCreate = (_f = (_e = journal.config) == null ? void 0 : _e.value) == null ? void 0 : _f.autoCreate;
    if ((_g = journal.config) == null ? void 0 : _g.value) {
      journal.config.value.autoCreate = true;
    }
    await ((_h = journal.autoCreate) == null ? void 0 : _h.call(journal));
    if ((_i = journal.config) == null ? void 0 : _i.value) {
      journal.config.value.autoCreate = origAutoCreate;
    }
    if (!window.moment) return null;
    const today = window.moment().locale("custom-journal-locale").startOf("day");
    const note = (_j = journal.get) == null ? void 0 : _j.call(journal, today);
    if (!note) return null;
    const path = (_k = journal.getNotePath) == null ? void 0 : _k.call(journal, note);
    return path ? path.replace(/\.md$/, "") : null;
  } catch (e) {
    return null;
  }
}
async function computeHomeBasePath(type, value, plugin) {
  switch (type) {
    case "File" /* File */:
      return value || null;
    case "Random file" /* Random */: {
      const file = randomFile(plugin.app);
      return file ? trimFile(file) : null;
    }
    case "Random in folder" /* RandomFolder */: {
      const file = randomFile(plugin.app, value);
      return file ? trimFile(file) : null;
    }
    case "Daily Note" /* DailyNote */:
    case "Weekly Note" /* WeeklyNote */:
    case "Monthly Note" /* MonthlyNote */:
    case "Yearly Note" /* YearlyNote */:
      return await getPeriodicNote(type, plugin);
    case "Journal" /* Journal */:
      return await getJournalNote(value, plugin);
    case "Workspace" /* Workspace */:
    case "Graph view" /* Graph */:
    case "Nothing" /* None */:
      return null;
    default:
      return value || null;
  }
}

// src/services/home-service.ts
var LEAF_TYPES = ["markdown", "canvas", "bases"];
function equalsCaseless(path1, path2) {
  const normalize = (p) => p.toLowerCase().replace(/\.md$/, "");
  return normalize(path1) === normalize(path2);
}
var HomeBaseService = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.app = plugin.app;
  }
  /**
   * Open home base with a specific mode (for startup/manual opens)
   */
  async openHomeBaseWithMode(mode, runCommand = true) {
    var _a;
    const homeBaseSettings = this.plugin.getHomeBaseSettings();
    if (homeBaseSettings.type === "Workspace" /* Workspace */) {
      return this.openWorkspace(homeBaseSettings.value);
    }
    if (homeBaseSettings.type === "Graph view" /* Graph */) {
      return this.openGraph();
    }
    if (homeBaseSettings.type === "Nothing" /* None */) {
      if (runCommand) {
        this.runCommandOnOpen();
      }
      return true;
    }
    const resolvedPath = await computeHomeBasePath(
      homeBaseSettings.type,
      homeBaseSettings.value,
      this.plugin
    );
    if (!resolvedPath) {
      console.debug(`Home Base: Could not resolve path for type ${homeBaseSettings.type}`);
      return false;
    }
    let file = this.app.metadataCache.getFirstLinkpathDest(resolvedPath, "/");
    if (!file) {
      file = getFileByPath(this.app, resolvedPath);
    }
    if (!file) {
      const untrimmedPath = resolvedPath.endsWith(".md") ? resolvedPath : `${resolvedPath}.md`;
      file = getFileByPath(this.app, untrimmedPath);
      if (!file && homeBaseSettings.type === "File" /* File */) {
        console.debug(`Home Base: File not found: ${resolvedPath}`);
        return false;
      }
    }
    if (!file) {
      console.debug(`Home Base: File not found: ${resolvedPath}`);
      return false;
    }
    if (mode === "replace-all") {
      await this.detachAllLeaves();
    } else if (mode === "replace-last") {
      const activeLeaf = (_a = this.app.workspace.getActiveViewOfType(import_obsidian8.View)) == null ? void 0 : _a.leaf;
      if (activeLeaf) {
        activeLeaf.setPinned(false);
      }
    }
    const existingLeaf = this.findExistingHomeBaseLeaf(file);
    if (existingLeaf && mode !== "replace-all") {
      const viewState = existingLeaf.getViewState();
      if (viewState.pinned === true && this.plugin.settings.showStickyHomeIcon) {
      } else {
        this.app.workspace.setActiveLeaf(existingLeaf);
        await this.configureView(existingLeaf, file);
        if (runCommand) {
          this.runCommandOnOpen();
        }
        return true;
      }
    }
    const newLeaf = mode === "retain" ? this.app.workspace.getLeaf("tab") : this.app.workspace.getLeaf(false);
    if (!newLeaf) {
      return false;
    }
    await newLeaf.openFile(file);
    this.app.workspace.setActiveLeaf(newLeaf);
    await this.configureView(newLeaf, file);
    if (runCommand) {
      this.runCommandOnOpen();
    }
    return true;
  }
  /**
   * Open workspace
   */
  async openWorkspace(workspaceName) {
    var _a, _b, _c;
    const workspacePlugin = (_b = (_a = this.app.internalPlugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b.workspaces;
    if (!(workspacePlugin == null ? void 0 : workspacePlugin.enabled) || !((_c = workspacePlugin.instance) == null ? void 0 : _c.loadWorkspace)) {
      return false;
    }
    workspacePlugin.instance.loadWorkspace(workspaceName);
    await new Promise((resolve) => setTimeout(resolve, 100));
    return true;
  }
  /**
   * Open graph view
   */
  async openGraph() {
    var _a, _b;
    await ((_b = (_a = this.app.commands) == null ? void 0 : _a.executeCommandById) == null ? void 0 : _b.call(_a, "graph:open"));
    return true;
  }
  /**
   * Open the home base file
   * @param options Options for opening
   */
  async openHomeBase(options = {}) {
    const { runCommand = true } = options;
    const mode = this.plugin.settings.manualOpenMode;
    return this.openHomeBaseWithMode(mode, runCommand);
  }
  /**
   * Open home base in an empty leaf (for new tab replacement)
   */
  async openInLeaf(leaf) {
    const homeBaseSettings = this.plugin.getHomeBaseSettings();
    if (homeBaseSettings.type === "Workspace" /* Workspace */) {
      await this.openWorkspace(homeBaseSettings.value);
      return true;
    }
    if (homeBaseSettings.type === "Graph view" /* Graph */) {
      await this.openGraph();
      return true;
    }
    if (homeBaseSettings.type === "Nothing" /* None */) {
      this.runCommandOnOpen();
      return true;
    }
    const resolvedPath = await computeHomeBasePath(
      homeBaseSettings.type,
      homeBaseSettings.value,
      this.plugin
    );
    if (!resolvedPath) {
      return false;
    }
    const file = getFileByPath(this.app, resolvedPath);
    if (!file) {
      return false;
    }
    await leaf.openFile(file);
    await this.configureView(leaf, file);
    this.runCommandOnOpen();
    return true;
  }
  /**
   * Configure the view mode for a leaf
   */
  async configureView(leaf, file) {
    const settings = this.plugin.settings;
    const view = leaf.view;
    if (!isMarkdownLike(file) || !(view instanceof import_obsidian8.MarkdownView)) {
      return;
    }
    const state = view.getState();
    if (settings.revertView) {
      this.lastView = new WeakRef(view);
    }
    if (settings.autoScroll) {
      const count = view.editor.lineCount();
      if (state.mode === "preview") {
        view.previewMode.applyScroll(count - 4);
      } else {
        view.editor.setCursor(count);
        view.editor.focus();
      }
    }
    if (settings.openViewMode !== "default") {
      switch (settings.openViewMode) {
        case "preview":
          state.mode = "preview";
          break;
        case "source":
          state.mode = "source";
          state.source = true;
          break;
        case "live":
          state.mode = "source";
          state.source = false;
          break;
      }
      await leaf.setViewState({
        type: "markdown",
        state
      });
    }
  }
  /**
   * Revert view to default when navigating away from home base
   */
  async revertView() {
    const settings = this.plugin.settings;
    if (!settings.revertView || !this.lastView || settings.openViewMode === "default") {
      return;
    }
    const view = this.lastView.deref();
    if (!view) {
      this.lastView = void 0;
      return;
    }
    const homeBaseSettings = this.plugin.getHomeBaseSettings();
    const resolvedPath = await computeHomeBasePath(
      homeBaseSettings.type,
      homeBaseSettings.value,
      this.plugin
    );
    if (!resolvedPath) {
      this.lastView = void 0;
      return;
    }
    const currentFile = view.file;
    if (currentFile && equalsCaseless(trimFile(currentFile), resolvedPath)) {
      return;
    }
    const state = view.getState();
    const config = this.app.vault.config;
    const mode = (config == null ? void 0 : config.defaultViewMode) || "source";
    const source = (config == null ? void 0 : config.livePreview) !== void 0 ? !config.livePreview : false;
    if (view.leaf.getViewState().type === "markdown" && (mode !== state.mode || source !== state.source)) {
      state.mode = mode;
      state.source = source;
      await view.leaf.setViewState({ type: "markdown", state, active: true });
    }
    this.lastView = void 0;
  }
  /**
   * Run the configured command after opening
   */
  runCommandOnOpen() {
    const commandId = this.plugin.settings.commandOnOpen;
    if (commandId) {
      setTimeout(() => {
        executeCommand(this.app, commandId);
      }, 100);
    }
  }
  /**
   * Find an existing leaf that has the home base file open
   */
  findExistingHomeBaseLeaf(file) {
    if (!file) return null;
    const homeBasePath = file.path;
    const leaves = LEAF_TYPES.flatMap(
      (type) => this.app.workspace.getLeavesOfType(type)
    );
    for (const leaf of leaves) {
      if (leafHasFile(leaf, homeBasePath)) {
        return leaf;
      }
    }
    return null;
  }
  /**
   * Find the ghost tab (the one opened via sticky icon)
   * Ghost tab is identified by being pinned and having the home base file
   * Only searches in the current window (getLeavesOfType is window-scoped)
   * 
   * Note: If the ghost tab is moved to another window, this will return null,
   * and a new ghost tab will be created in the current window when needed.
   * This is the desired behavior - each window can have its own ghost tab.
   * 
   * For random types, we don't look for pinned tabs (they're not pinned).
   */
  findGhostTab(file, isRandom = false) {
    if (!file) return null;
    const homeBasePath = file.path;
    const leaves = LEAF_TYPES.flatMap(
      (type) => this.app.workspace.getLeavesOfType(type)
    );
    for (const leaf of leaves) {
      if (leafHasFile(leaf, homeBasePath)) {
        const viewState = leaf.getViewState();
        if (isRandom || viewState.pinned === true) {
          return leaf;
        }
      }
    }
    return null;
  }
  /**
   * Open home base in ghost tab (for sticky icon)
   * Ghost tab is pinned and hidden (if setting enabled)
   * Only one ghost tab should exist at a time
   * Only works for file-based types (not Workspace, Graph, None)
   * Note: Random types don't pin (since file changes each time)
   */
  async openHomeBaseInGhostTab(options = {}) {
    const { runCommand = true } = options;
    const homeBaseSettings = this.plugin.getHomeBaseSettings();
    if (homeBaseSettings.type === "Workspace" /* Workspace */ || homeBaseSettings.type === "Graph view" /* Graph */ || homeBaseSettings.type === "Nothing" /* None */) {
      return this.openHomeBaseWithMode("retain", runCommand);
    }
    const isRandom = homeBaseSettings.type === "Random file" /* Random */ || homeBaseSettings.type === "Random in folder" /* RandomFolder */;
    if (this.isSettingsModalOpen()) {
      console.debug("Home Base: Settings modal is open, skipping openHomeBaseInGhostTab");
      return false;
    }
    const resolvedPath = await computeHomeBasePath(
      homeBaseSettings.type,
      homeBaseSettings.value,
      this.plugin
    );
    if (!resolvedPath) {
      console.debug(`Home Base: Could not resolve path for type ${homeBaseSettings.type}`);
      return false;
    }
    const file = getFileByPath(this.app, resolvedPath);
    if (!file) {
      console.debug(`Home Base: File not found: ${resolvedPath}`);
      return false;
    }
    const ghostTab = this.findGhostTab(file, isRandom);
    if (ghostTab) {
      const shouldFocus2 = !this.isSettingsModalOpen();
      this.app.workspace.setActiveLeaf(ghostTab, { focus: shouldFocus2 });
      await this.configureView(ghostTab, file);
      if (runCommand) {
        this.runCommandOnOpen();
      }
      return true;
    }
    const allLeaves = LEAF_TYPES.flatMap(
      (type) => this.app.workspace.getLeavesOfType(type)
    );
    for (const leaf of allLeaves) {
      if (leafHasFile(leaf, resolvedPath)) {
        const viewState = leaf.getViewState();
        if (viewState.pinned === true) {
          void leaf.detach();
        }
      }
    }
    const newGhostTab = this.app.workspace.getLeaf("tab");
    await newGhostTab.openFile(file);
    if (!isRandom) {
      newGhostTab.setPinned(true);
    }
    const shouldFocus = !this.isSettingsModalOpen();
    this.app.workspace.setActiveLeaf(newGhostTab, { focus: shouldFocus });
    await this.configureView(newGhostTab, file);
    if (runCommand) {
      this.runCommandOnOpen();
    }
    return true;
  }
  /**
   * Find an empty leaf
   */
  findEmptyLeaf() {
    const leaves = this.app.workspace.getLeavesOfType("empty");
    return leaves[0] || null;
  }
  /**
   * Get the home base file
   */
  getHomeBaseFile() {
    const settings = this.plugin.settings;
    if (!settings.homeBasePath) {
      return null;
    }
    return getFileByPath(this.app, settings.homeBasePath);
  }
  /**
   * Fast detach all leaves using changeLayout (like homepage plugin)
   * This is much faster than iterating and detaching leaves individually
   */
  async detachAllLeaves() {
    var _a, _b;
    const layout = this.app.workspace.getLayout();
    layout.main = {
      "id": "5324373015726ba8",
      "type": "split",
      "children": [{
        "id": "4509724f8bf84da7",
        "type": "tabs",
        "children": [{
          "id": "e7a7b303c61786dc",
          "type": "leaf",
          "state": { "type": "empty", "state": {}, "icon": "lucide-file", "title": "New tab" }
        }]
      }],
      "direction": "vertical"
    };
    layout.active = "e7a7b303c61786dc";
    await this.app.workspace.changeLayout(layout);
    if (import_obsidian8.Platform.isMobile) {
      (_b = (_a = this.app.workspace.rightSplit) == null ? void 0 : _a.updateInfo) == null ? void 0 : _b.call(_a);
    }
  }
  /**
   * Close all leaves in the main workspace except the specified one
   * Simplified approach: iterate all leaves and close those in main workspace
   */
  async closeAllLeavesExcept(exceptLeaf) {
    const leavesToClose = [];
    this.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf === exceptLeaf) {
        return;
      }
      const view = leaf.view;
      let container = null;
      if (view) {
        const viewAny = view;
        container = viewAny.containerEl || null;
      }
      if (!container) {
        const leafAny = leaf;
        container = leafAny.containerEl || null;
      }
      if (container) {
        const rootWorkspace = container.closest(".workspace-split.mod-vertical.mod-root");
        const leftSidebar = container.closest(".workspace-split.mod-left-split");
        const rightSidebar = container.closest(".workspace-split.mod-right-split");
        if (rootWorkspace && !leftSidebar && !rightSidebar) {
          leavesToClose.push(leaf);
        }
      } else {
        if (exceptLeaf === null) {
          try {
            const viewState = leaf.getViewState();
            if (viewState) {
              leavesToClose.push(leaf);
            }
          } catch (e) {
          }
        }
      }
    });
    console.debug(`Home Base: Closing ${leavesToClose.length} tabs`);
    for (const leaf of leavesToClose) {
      void leaf.detach();
    }
    await new Promise((resolve) => setTimeout(resolve, 200));
  }
  /**
   * Check if the focused tab is the home base
   */
  isFocusedOnHomeBase() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return false;
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return false;
    const homeBaseFile = getFileByPath(this.app, homeBasePath);
    if (!homeBaseFile) return false;
    return activeFile.path === homeBaseFile.path;
  }
  /**
   * Check if home base file exists
   */
  homeBaseExists() {
    const path = this.plugin.settings.homeBasePath;
    if (!path) return false;
    return getFileByPath(this.app, path) !== null;
  }
  /**
   * Check if the settings modal is currently open
   */
  isSettingsModalOpen() {
    const settingsModal = document.querySelector(".modal-container.mod-settings") || document.querySelector(".modal.mod-settings") || document.querySelector(".vertical-tab-content");
    if (!settingsModal) {
      const allModals = document.querySelectorAll(".modal-container");
      for (const modal of Array.from(allModals)) {
        if (modal.querySelector(".vertical-tab-content") || modal.querySelector(".settings-content") || modal.classList.contains("mod-settings")) {
          return true;
        }
      }
    }
    return settingsModal !== null;
  }
  /**
   * Set the active file as home base
   */
  async setActiveFileAsHomeBase() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return false;
    if (!isSupportedExtension(activeFile.extension.toLowerCase())) {
      return false;
    }
    this.plugin.settings.homeBasePath = activeFile.path;
    await this.plugin.saveSettings();
    return true;
  }
  /**
   * Check if active file can be set as home base
   */
  canSetActiveFileAsHomeBase() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return false;
    return isSupportedExtension(activeFile.extension.toLowerCase());
  }
};

// src/services/new-tab-service.ts
var import_obsidian9 = require("obsidian");
var NewTabService = class {
  constructor(plugin) {
    this.existingLeaves = /* @__PURE__ */ new WeakSet();
    this.isStartup = true;
    this.startupCompleted = false;
    this.plugin = plugin;
    this.app = plugin.app;
  }
  /**
   * Initialize the service - called when layout is ready
   */
  initialize() {
    this.app.workspace.iterateAllLeaves((leaf) => {
      this.existingLeaves.add(leaf);
    });
    void this.handleStartup();
  }
  /**
   * Handle app startup - open home base if needed
   * Only called on actual app startup, not plugin reloads
   */
  async handleStartup() {
    const settings = this.plugin.settings;
    if (!settings.openOnStartup || !settings.homeBasePath) {
      this.startupCompleted = true;
      this.isStartup = false;
      return;
    }
    if (await this.hasUrlParams()) {
      console.debug("Home Base: URL params detected, skipping startup open");
      this.startupCompleted = true;
      this.isStartup = false;
      return;
    }
    await new Promise((resolve) => setTimeout(resolve, 500));
    if (!settings.keepExistingTabs) {
      console.debug("Home Base: keepExistingTabs is false, closing all tabs");
      let exceptLeaf = null;
      if (!settings.hideReleaseNotes) {
        const allLeaves = this.app.workspace.getLeavesOfType("markdown");
        for (const leaf of allLeaves) {
          const view = leaf.view;
          const markdownView = view;
          if (markdownView.file) {
            const file = markdownView.file;
            const configDir = this.app.vault.configDir;
            if (file.path.includes("release") || file.path.includes(configDir)) {
              const container = markdownView.containerEl;
              if (container && container.querySelector(".release-notes")) {
                exceptLeaf = leaf;
                break;
              }
            }
          }
        }
      }
      await this.plugin.homeService.closeAllLeavesExcept(exceptLeaf);
      await new Promise((resolve) => setTimeout(resolve, 200));
      console.debug("Home Base: All tabs closed, now opening home base");
    }
    if (settings.showStickyHomeIcon) {
      await this.plugin.homeService.openHomeBaseInGhostTab({
        runCommand: true
      });
    } else {
      await this.plugin.homeService.openHomeBase({
        replaceActiveLeaf: false,
        runCommand: true
      });
    }
    this.startupCompleted = true;
    this.isStartup = false;
  }
  /**
   * Check if the settings modal is currently open
   */
  isSettingsModalOpen() {
    const settingsModal = document.querySelector(".modal-container.mod-settings") || document.querySelector(".modal.mod-settings") || document.querySelector(".vertical-tab-content");
    if (!settingsModal) {
      const allModals = document.querySelectorAll(".modal-container");
      for (const modal of Array.from(allModals)) {
        if (modal.querySelector(".vertical-tab-content") || modal.querySelector(".settings-content") || modal.classList.contains("mod-settings")) {
          return true;
        }
      }
    }
    return settingsModal !== null;
  }
  /**
   * Check for URL parameters that indicate Obsidian was opened via a link
   * Based on obsidian-homepage implementation
   */
  async hasUrlParams() {
    var _a;
    const windowAny = window;
    const capacitor = windowAny.Capacitor;
    if ((_a = capacitor == null ? void 0 : capacitor.Plugins) == null ? void 0 : _a.App) {
      try {
        const launchUrl = await capacitor.Plugins.App.getLaunchUrl();
        if (launchUrl == null ? void 0 : launchUrl.url) {
          const url = new URL(launchUrl.url);
          const params = Array.from(url.searchParams.keys());
          const action = url.hostname;
          if (["open", "advanced-uri"].includes(action) && ["file", "filepath", "workspace"].some((e) => params.includes(e))) {
            return true;
          }
        }
      } catch (e) {
      }
    }
    const obsAct = windowAny.OBS_ACT;
    if (obsAct) {
      const params = Object.keys(obsAct);
      const action = obsAct.action;
      if (action && ["open", "advanced-uri"].includes(action) && ["file", "filepath", "workspace"].some((e) => params.includes(e))) {
        return true;
      }
    }
    return false;
  }
  /**
   * Handle layout change event - check for new empty tabs
   * Based on new-tab-default-page implementation
   */
  handleLayoutChange() {
    if (!this.plugin.settings.replaceNewTab) {
      return;
    }
    if (this.isStartup || !this.startupCompleted) {
      return;
    }
    this.app.workspace.iterateAllLeaves((leaf) => {
      if (this.existingLeaves.has(leaf)) {
        return;
      }
      this.existingLeaves.add(leaf);
      if (!this.isEmptyTab(leaf)) {
        return;
      }
      if (this.plugin.settings.newTabMode === "only-when-empty") {
        if (!this.isOnlyTab(leaf)) {
          return;
        }
      }
      void this.replaceEmptyTab(leaf);
    });
  }
  /**
   * Check if a leaf is an empty tab
   */
  isEmptyTab(leaf) {
    if (!leaf.view) return true;
    return leaf.view.getViewType() === "empty";
  }
  /**
   * Check if this is the only tab in the workspace
   */
  isOnlyTab(leaf) {
    const leafAny = leaf;
    const parent = leafAny.parentSplit;
    if (!parent) return true;
    const children = parent.children;
    if (!children) return true;
    return children.length === 1;
  }
  /**
   * Replace an empty tab with the home base
   */
  async replaceEmptyTab(leaf) {
    await new Promise((resolve) => setTimeout(resolve, 50));
    if (!this.isEmptyTab(leaf)) {
      return;
    }
    await this.plugin.homeService.openInLeaf(leaf);
  }
  /**
   * Force check for empty workspace and open home base
   */
  async openIfEmpty() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian9.View);
    const activeLeaf = activeView == null ? void 0 : activeView.leaf;
    if (!activeLeaf) return;
    if (this.isEmptyTab(activeLeaf) && this.isOnlyTab(activeLeaf)) {
      await this.plugin.homeService.openInLeaf(activeLeaf);
    }
  }
};

// src/services/sticky-tab-service.ts
var import_obsidian10 = require("obsidian");
init_file_utils();
var STICKY_ICON_CLASS = "home-base-sticky-icon";
var STICKY_ICON_ACTIVE_CLASS = "home-base-sticky-icon-active";
var StickyTabService = class {
  constructor(plugin) {
    this.stickyIconEl = null;
    this.layoutChangeHandler = null;
    this.tabHeaderUpdateTimeout = null;
    this.sidebarObserver = null;
    this.plugin = plugin;
  }
  /**
   * Update the sticky tab icon based on settings
   */
  update() {
    if (import_obsidian10.Platform.isMobile) {
      this.remove();
      this.updateTabHeaders();
      this.updateWorkspaceClass(false);
      return;
    }
    if (this.plugin.settings.showStickyHomeIcon) {
      if (this.stickyIconEl) {
        const iconName = this.plugin.settings.stickyIconName || "home";
        (0, import_obsidian10.setIcon)(this.stickyIconEl, iconName);
      } else {
        this.create();
      }
      this.updateWorkspaceClass(true);
    } else {
      this.remove();
      this.updateTabHeaders();
      this.updateWorkspaceClass(false);
    }
  }
  /**
   * Add/remove CSS class on workspace to conditionally apply styles
   */
  updateWorkspaceClass(enabled) {
    const mainWorkspace = document.querySelector(".workspace-split.mod-vertical.mod-root");
    if (!mainWorkspace) return;
    if (enabled) {
      mainWorkspace.classList.add("home-base-sticky-icon-enabled");
    } else {
      mainWorkspace.classList.remove("home-base-sticky-icon-enabled");
    }
  }
  /**
   * Create the sticky home icon
   */
  create() {
    this.remove();
    this.stickyIconEl = document.createElement("div");
    this.stickyIconEl.className = `${STICKY_ICON_CLASS} clickable-icon`;
    this.stickyIconEl.setAttribute("aria-label", "Open home base");
    this.stickyIconEl.setAttribute("data-tooltip-position", "bottom");
    const iconName = this.plugin.settings.stickyIconName || "home";
    (0, import_obsidian10.setIcon)(this.stickyIconEl, iconName);
    this.stickyIconEl.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      void this.plugin.homeService.openHomeBaseInGhostTab({
        runCommand: true
      }).then(() => {
        setTimeout(() => {
          this.updateTabHeaders();
        }, 150);
      });
    });
    this.stickyIconEl.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      e.stopPropagation();
      const menu = new import_obsidian10.Menu();
      menu.addItem((item) => {
        item.setTitle("Change icon").setIcon("lucide-image-plus").onClick(() => {
          const picker = new IconPicker(
            this.plugin.app,
            this.plugin.settings.stickyIconName,
            (icon) => {
              void (async () => {
                this.plugin.settings.stickyIconName = icon;
                await this.plugin.saveSettings();
                if (this.stickyIconEl) {
                  (0, import_obsidian10.setIcon)(this.stickyIconEl, icon || "home");
                }
              })();
            }
          );
          picker.open();
        });
      });
      menu.addItem((item) => {
        item.setTitle("Close home base").setIcon("x").onClick(() => {
          void this.closeHomeBase();
        });
      });
      menu.showAtMouseEvent(e);
    });
    const ensureIconInPlace = () => {
      if (!this.stickyIconEl) return;
      const mainWorkspace2 = document.querySelector(".workspace-split.mod-vertical.mod-root");
      if (!mainWorkspace2) return;
      const workspaceTabs = mainWorkspace2.querySelector(".workspace-tabs");
      if (!workspaceTabs) return;
      const existingIcon = workspaceTabs.querySelector(`.${STICKY_ICON_CLASS}`);
      if (existingIcon === this.stickyIconEl) {
        return;
      }
      workspaceTabs.appendChild(this.stickyIconEl);
      this.updateActiveState();
      this.updateTabHeaders();
      this.updateWorkspaceClass(true);
      this.updateIconPositionForSidebar();
      this.watchSidebarState();
    };
    ensureIconInPlace();
    const checkInterval = setInterval(() => {
      if (!this.stickyIconEl || !this.plugin.settings.showStickyHomeIcon) {
        clearInterval(checkInterval);
        return;
      }
      ensureIconInPlace();
    }, 100);
    this.stickyIconEl._checkInterval = checkInterval;
    if (!this.layoutChangeHandler) {
      this.layoutChangeHandler = () => {
        if (this.stickyIconEl && this.plugin.settings.showStickyHomeIcon) {
          ensureIconInPlace();
          this.updateTabHeaders();
        }
      };
      this.plugin.registerEvent(
        this.plugin.app.workspace.on("layout-change", this.layoutChangeHandler)
      );
    }
    const mainWorkspace = document.querySelector(".workspace-split.mod-vertical.mod-root");
    if (mainWorkspace) {
      const containerObserver = new MutationObserver(() => {
        if (!this.stickyIconEl || !this.plugin.settings.showStickyHomeIcon) return;
        const workspaceTabs = mainWorkspace.querySelector(".workspace-tabs");
        if (workspaceTabs) {
          const existingIcon = workspaceTabs.querySelector(`.${STICKY_ICON_CLASS}`);
          if (!existingIcon || existingIcon !== this.stickyIconEl) {
            workspaceTabs.appendChild(this.stickyIconEl);
            this.updateActiveState();
          }
        }
      });
      containerObserver.observe(mainWorkspace, {
        childList: true,
        subtree: false
        // Only watch direct children
      });
      this.stickyIconEl._containerObserver = containerObserver;
    }
  }
  /**
   * Remove the sticky home icon
   */
  remove() {
    if (this.tabHeaderUpdateTimeout) {
      clearTimeout(this.tabHeaderUpdateTimeout);
      this.tabHeaderUpdateTimeout = null;
    }
    if (this.stickyIconEl && this.stickyIconEl._checkInterval) {
      clearInterval(this.stickyIconEl._checkInterval);
    }
    if (this.stickyIconEl && this.stickyIconEl._containerObserver) {
      this.stickyIconEl._containerObserver.disconnect();
    }
    if (this.sidebarObserver) {
      this.sidebarObserver.disconnect();
      this.sidebarObserver = null;
    }
    if (this.stickyIconEl) {
      if (this.stickyIconEl.parentElement) {
        this.stickyIconEl.remove();
      }
      this.stickyIconEl = null;
    }
    document.querySelectorAll(`.${STICKY_ICON_CLASS}`).forEach((el) => {
      const stickyEl = el;
      if (stickyEl._checkInterval) {
        clearInterval(stickyEl._checkInterval);
      }
      if (stickyEl._containerObserver) {
        stickyEl._containerObserver.disconnect();
      }
      el.remove();
    });
  }
  /**
   * Update the active state of the sticky icon
   */
  updateActiveState() {
    if (!this.stickyIconEl) return;
    const isActive = this.plugin.homeService.isFocusedOnHomeBase();
    if (isActive) {
      this.stickyIconEl.classList.add(STICKY_ICON_ACTIVE_CLASS);
    } else {
      this.stickyIconEl.classList.remove(STICKY_ICON_ACTIVE_CLASS);
    }
    this.updateTabHeaders();
  }
  /**
   * Check if the left sidebar is collapsed
   * Based on obsidian-oxygen-settings implementation
   */
  isLeftSidebarCollapsed() {
    const leftSidebar = document.querySelector(".workspace-split.mod-left-split") || document.querySelector(".mod-left-split");
    if (!leftSidebar) return false;
    return leftSidebar.classList.contains("is-sidedock-collapsed");
  }
  /**
   * Update icon position based on sidebar state
   */
  updateIconPositionForSidebar() {
    if (!this.stickyIconEl) return;
    const isCollapsed = this.isLeftSidebarCollapsed();
    const mainWorkspace = document.querySelector(".workspace-split.mod-vertical.mod-root");
    if (isCollapsed) {
      this.stickyIconEl.classList.add("home-base-sticky-icon-sidebar-collapsed");
      if (mainWorkspace) {
        mainWorkspace.classList.add("home-base-sidebar-collapsed");
      }
    } else {
      this.stickyIconEl.classList.remove("home-base-sticky-icon-sidebar-collapsed");
      if (mainWorkspace) {
        mainWorkspace.classList.remove("home-base-sidebar-collapsed");
      }
    }
  }
  /**
   * Watch for sidebar state changes and update icon position
   * Based on obsidian-oxygen-settings implementation
   */
  watchSidebarState() {
    if (this.sidebarObserver) {
      this.sidebarObserver.disconnect();
    }
    const leftSidebar = document.querySelector(".workspace-split.mod-left-split") || document.querySelector(".mod-left-split");
    if (!leftSidebar) return;
    this.sidebarObserver = new MutationObserver((mutations) => {
      let shouldUpdate = false;
      mutations.forEach((mutation) => {
        if (mutation.type === "attributes" && mutation.attributeName === "class") {
          shouldUpdate = true;
        }
      });
      if (shouldUpdate) {
        this.updateIconPositionForSidebar();
      }
    });
    this.sidebarObserver.observe(leftSidebar, {
      attributes: true,
      attributeFilter: ["class"]
    });
  }
  /**
   * Toggle the sticky icon visibility
   */
  async toggle() {
    this.plugin.settings.showStickyHomeIcon = !this.plugin.settings.showStickyHomeIcon;
    await this.plugin.saveSettings();
    this.update();
    this.updateTabHeaders();
  }
  /**
   * Update tab headers to hide/show ghost tab
   * Only works when sticky icon is enabled
   * Debounced to prevent flickering during tab transitions
   */
  updateTabHeaders() {
    if (this.tabHeaderUpdateTimeout) {
      clearTimeout(this.tabHeaderUpdateTimeout);
    }
    this.tabHeaderUpdateTimeout = setTimeout(() => {
      this.tabHeaderUpdateTimeout = null;
      this._doUpdateTabHeaders();
    }, 100);
  }
  /**
   * Internal method that actually updates the tab headers
   */
  _doUpdateTabHeaders() {
    if (!this.plugin.settings.showStickyHomeIcon || !this.plugin.settings.hideHomeTabHeader) {
      document.querySelectorAll(".is-home-base-tab").forEach((el) => {
        el.classList.remove("is-home-base-tab");
      });
      return;
    }
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return;
    requestAnimationFrame(() => {
      this.plugin.app.workspace.iterateAllLeaves((leaf) => {
        const isHomeBase = leafHasFile(leaf, homeBasePath);
        if (!isHomeBase) {
          const tabHeader2 = this.getTabHeaderForLeaf(leaf);
          if (tabHeader2) {
            tabHeader2.classList.remove("is-home-base-tab");
          }
          return;
        }
        const viewState = leaf.getViewState();
        const isGhostTab = viewState.pinned === true;
        const tabHeader = this.getTabHeaderForLeaf(leaf);
        if (tabHeader) {
          if (isGhostTab) {
            tabHeader.classList.add("is-home-base-tab");
          } else {
            tabHeader.classList.remove("is-home-base-tab");
          }
        }
      });
    });
  }
  /**
   * Get the tab header element for a given leaf
   */
  getTabHeaderForLeaf(leaf) {
    var _a;
    const leafAny = leaf;
    if (leafAny.tabHeaderEl) {
      return leafAny.tabHeaderEl;
    }
    const viewType = (_a = leaf.view) == null ? void 0 : _a.getViewType();
    if (!viewType) return null;
    const activeLeaf = this.plugin.app.workspace.getMostRecentLeaf();
    const isActive = leaf === activeLeaf;
    const tabHeaders = document.querySelectorAll(`.workspace-tab-header[data-type="${viewType}"]`);
    if (isActive) {
      const activeHeader = document.querySelector(".workspace-tab-header.is-active");
      if (activeHeader && activeHeader.getAttribute("data-type") === viewType) {
        return activeHeader;
      }
    }
    for (const header of Array.from(tabHeaders)) {
      const headerEl = header;
      const headerElWithLeaf = headerEl;
      const headerLeaf = headerElWithLeaf.leaf;
      if (headerLeaf === leaf) {
        return headerEl;
      }
    }
    if (tabHeaders.length === 1) {
      return tabHeaders[0];
    }
    if (isActive) {
      const activeHeader = document.querySelector(".workspace-tab-header.is-active");
      if (activeHeader) {
        return activeHeader;
      }
    }
    return null;
  }
  /**
   * Close the home base tab
   */
  async closeHomeBase() {
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return;
    const { getFileByPath: getFileByPath2 } = await Promise.resolve().then(() => (init_file_utils(), file_utils_exports));
    const homeBaseFile = getFileByPath2(this.plugin.app, homeBasePath);
    if (!homeBaseFile) return;
    const homeBaseLeaf = this.plugin.homeService.findExistingHomeBaseLeaf(homeBaseFile);
    if (homeBaseLeaf) {
      homeBaseLeaf.detach();
      this.updateTabHeaders();
    }
  }
  /**
   * Pin the home base tab
   */
  pinHomeBaseTab() {
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return;
    const homeBaseFile = getFileByPath(this.plugin.app, homeBasePath);
    if (!homeBaseFile) return;
    const homeBaseLeaf = this.plugin.homeService.findExistingHomeBaseLeaf(homeBaseFile);
    if (homeBaseLeaf) {
      homeBaseLeaf.setPinned(true);
    }
  }
  /**
   * Unpin the home base tab
   */
  unpinHomeBaseTab() {
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return;
    const homeBaseFile = getFileByPath(this.plugin.app, homeBasePath);
    if (!homeBaseFile) return;
    const homeBaseLeaf = this.plugin.homeService.findExistingHomeBaseLeaf(homeBaseFile);
    if (homeBaseLeaf) {
      homeBaseLeaf.setPinned(false);
    }
  }
  /**
   * Check if the home base tab is pinned
   */
  isHomeBaseTabPinned() {
    const homeBasePath = this.plugin.settings.homeBasePath;
    if (!homeBasePath) return false;
    const homeBaseFile = getFileByPath(this.plugin.app, homeBasePath);
    if (!homeBaseFile) return false;
    const homeBaseLeaf = this.plugin.homeService.findExistingHomeBaseLeaf(homeBaseFile);
    if (!homeBaseLeaf) return false;
    const viewState = homeBaseLeaf.getViewState();
    return viewState.pinned === true;
  }
};

// src/services/mobile-button-service.ts
var import_obsidian11 = require("obsidian");
var MOBILE_HOME_CLASS = "home-base-mobile-enabled";
var MobileButtonService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Update the mobile button based on settings
   */
  update() {
    if (!import_obsidian11.Platform.isMobile) {
      this.remove();
      return;
    }
    if (this.plugin.settings.replaceMobileNewTab) {
      this.apply();
    } else {
      this.remove();
    }
  }
  /**
   * Apply the mobile button replacement
   */
  apply() {
    document.body.classList.add(MOBILE_HOME_CLASS);
  }
  /**
   * Remove the mobile button replacement
   */
  remove() {
    document.body.classList.remove(MOBILE_HOME_CLASS);
  }
};

// src/main.ts
var HOME_ICON = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/><path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>`;
var HomeBasePlugin = class extends import_obsidian12.Plugin {
  constructor() {
    super(...arguments);
    // Release notes tracking
    this.newRelease = false;
  }
  async onload() {
    await this.loadSettings();
    await this.migrateLegacySettings();
    this.patchOpeningBehavior();
    (0, import_obsidian12.addIcon)("home-base", HOME_ICON);
    this.homeService = new HomeBaseService(this);
    this.newTabService = new NewTabService(this);
    this.stickyTabService = new StickyTabService(this);
    this.mobileButtonService = new MobileButtonService(this);
    this.addRibbonIcon("home", "Open home base", () => {
      void this.homeService.openHomeBase({
        replaceActiveLeaf: false,
        runCommand: true
      });
    });
    this.registerCommands();
    this.addSettingTab(new HomeBaseSettingTab(this.app, this));
    this.app.workspace.onLayoutReady(() => {
      setTimeout(() => {
        if (this.isSettingsModalOpen()) {
          console.debug("Home Base: Settings modal is open, skipping startup logic");
          this.updateStickyTabIcon();
          this.updateMobileButton();
          this.stickyTabService.updateTabHeaders();
          return;
        }
        this.newTabService.initialize();
        this.updateStickyTabIcon();
        this.updateMobileButton();
        this.stickyTabService.updateTabHeaders();
      }, 100);
    });
    this.registerEvent(
      this.app.workspace.on("layout-change", async () => {
        this.newTabService.handleLayoutChange();
        if (this.settings.revertView) {
          await this.homeService.revertView();
        }
        if (this.settings.openWhenEmpty) {
          this.handleOpenWhenEmpty();
        }
        setTimeout(() => {
          this.stickyTabService.updateActiveState();
          this.stickyTabService.updateTabHeaders();
          this.stickyTabService.updateIconPositionForSidebar();
        }, 150);
      })
    );
    this.registerEvent(
      this.app.workspace.on("file-open", () => {
        setTimeout(() => {
          this.stickyTabService.updateActiveState();
          this.stickyTabService.updateTabHeaders();
        }, 100);
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        setTimeout(() => {
          this.stickyTabService.updateTabHeaders();
        }, 100);
      })
    );
    console.debug("Home Base plugin loaded");
  }
  onunload() {
    this.unpatchReleaseNotes();
    this.unpatchOpeningBehavior();
    this.stickyTabService.remove();
    this.mobileButtonService.remove();
    console.debug("Home Base plugin unloaded");
  }
  /**
   * Register plugin commands
   */
  registerCommands() {
    this.addCommand({
      id: "open",
      name: "Open",
      callback: () => {
        const homeBaseSettings = this.getHomeBaseSettings();
        if (!homeBaseSettings.value && homeBaseSettings.type === "File" /* File */) {
          new import_obsidian12.Notice("No home base configured. Set one in settings.");
          return;
        }
        void this.homeService.openHomeBase({
          replaceActiveLeaf: false,
          runCommand: true
        });
      }
    });
    this.addCommand({
      id: "set-current-file",
      name: "Set current file as home",
      checkCallback: (checking) => {
        if (!this.homeService.canSetActiveFileAsHomeBase()) {
          return false;
        }
        if (!checking) {
          void this.homeService.setActiveFileAsHomeBase().then((success) => {
            if (success) {
              const activeFile = this.app.workspace.getActiveFile();
              new import_obsidian12.Notice(`Home base set to "${activeFile == null ? void 0 : activeFile.name}"`);
            }
          });
        }
        return true;
      }
    });
    this.addCommand({
      id: "toggle-sticky-icon",
      name: "Toggle sticky home icon",
      callback: async () => {
        await this.stickyTabService.toggle();
        const state = this.settings.showStickyHomeIcon ? "enabled" : "disabled";
        new import_obsidian12.Notice(`Sticky home icon ${state}`);
      }
    });
    this.addCommand({
      id: "close",
      name: "Close",
      callback: async () => {
        await this.stickyTabService.closeHomeBase();
      }
    });
  }
  /**
   * Load plugin settings
   */
  async loadSettings() {
    const data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data != null ? data : {});
  }
  /**
   * Migrate legacy settings to new format
   */
  async migrateLegacySettings() {
    let needsSave = false;
    if (this.settings.homeBasePath && !this.settings.homeBaseValue) {
      this.settings.homeBaseType = "File" /* File */;
      this.settings.homeBaseValue = this.settings.homeBasePath;
      needsSave = true;
    }
    if (this.settings.keepExistingTabs !== void 0) {
      if (this.settings.openMode === DEFAULT_SETTINGS.openMode) {
        this.settings.openMode = this.settings.keepExistingTabs ? "retain" : "replace-all";
        needsSave = true;
      }
    }
    if (this.settings.mobileHomeBasePath && !this.settings.mobileHomeBaseValue) {
      this.settings.mobileHomeBaseType = "File" /* File */;
      this.settings.mobileHomeBaseValue = this.settings.mobileHomeBasePath;
      needsSave = true;
    }
    if (needsSave) {
      await this.saveSettings();
    }
  }
  /**
   * Get the active home base settings (mobile or desktop)
   */
  getHomeBaseSettings() {
    if (this.settings.separateMobile && import_obsidian12.Platform.isMobile) {
      return {
        type: this.settings.mobileHomeBaseType || "File" /* File */,
        value: this.settings.mobileHomeBaseValue || this.settings.mobileHomeBasePath || "",
        path: this.settings.mobileHomeBasePath || this.settings.mobileHomeBaseValue || ""
      };
    }
    return {
      type: this.settings.homeBaseType || "File" /* File */,
      value: this.settings.homeBaseValue || this.settings.homeBasePath || "",
      path: this.settings.homeBasePath || this.settings.homeBaseValue || ""
    };
  }
  /**
   * Save plugin settings
   */
  async saveSettings() {
    await this.saveData(this.settings);
  }
  /**
   * Update the sticky tab icon based on current settings
   */
  updateStickyTabIcon() {
    this.stickyTabService.update();
    this.stickyTabService.updateTabHeaders();
  }
  /**
   * Update the mobile button based on current settings
   */
  updateMobileButton() {
    this.mobileButtonService.update();
  }
  /**
   * Check if we should skip startup logic (e.g., plugin reload, settings modal open)
   * This prevents destructive behavior when the plugin is reloaded or settings are open
   */
  shouldSkipStartupLogic() {
    if (this.isSettingsModalOpen()) {
      return true;
    }
    const hasOpenFiles = this.app.workspace.getLeavesOfType("markdown").length > 0 || this.app.workspace.getLeavesOfType("canvas").length > 0 || this.app.workspace.getLeavesOfType("bases").length > 0 || this.app.workspace.getLeavesOfType("empty").length > 0;
    return hasOpenFiles;
  }
  /**
   * Check if the settings modal is currently open
   */
  isSettingsModalOpen() {
    const settingsModal = document.querySelector(".modal-container.mod-settings") || document.querySelector(".modal.mod-settings") || document.querySelector(".vertical-tab-content");
    if (!settingsModal) {
      const allModals = document.querySelectorAll(".modal-container");
      for (const modal of Array.from(allModals)) {
        if (modal.querySelector(".vertical-tab-content") || modal.querySelector(".settings-content") || modal.classList.contains("mod-settings")) {
          return true;
        }
      }
    }
    return settingsModal !== null;
  }
  /**
   * Patch runOpeningBehavior for fast startup (like homepage plugin)
   */
  patchOpeningBehavior() {
    this.app.nvOrig_runOpeningBehavior = this.app.runOpeningBehavior;
    this.app.runOpeningBehavior = async (path) => {
      const openInitially = this.settings.openOnStartup && !await this.hasUrlParams();
      if (openInitially) {
        const mode = this.settings.openMode;
        if (mode === "replace-all") {
          await this.homeService.detachAllLeaves();
        }
        await this.homeService.openHomeBaseWithMode(mode, true);
      } else {
        if (this.app.nvOrig_runOpeningBehavior) {
          await this.app.nvOrig_runOpeningBehavior(path);
        }
      }
      this.unpatchReleaseNotes();
    };
  }
  /**
   * Unpatch runOpeningBehavior
   */
  unpatchOpeningBehavior() {
    if (this.app.nvOrig_runOpeningBehavior) {
      this.app.runOpeningBehavior = this.app.nvOrig_runOpeningBehavior;
    }
  }
  /**
   * Patch showReleaseNotes to track new releases
   */
  patchReleaseNotes() {
    const appAny = this.app;
    appAny.nvOrig_showReleaseNotes = appAny.showReleaseNotes;
    appAny.showReleaseNotes = () => {
      this.newRelease = true;
    };
  }
  /**
   * Unpatch showReleaseNotes
   */
  unpatchReleaseNotes() {
    var _a;
    const appAny = this.app;
    if (this.newRelease && !this.settings.hideReleaseNotes) {
      (_a = appAny.nvOrig_showReleaseNotes) == null ? void 0 : _a.call(appAny);
    }
    if (appAny.nvOrig_showReleaseNotes) {
      appAny.showReleaseNotes = appAny.nvOrig_showReleaseNotes;
    }
  }
  /**
   * Check if a home base type has its required plugin enabled
   */
  hasRequiredPlugin(type) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    switch (type) {
      case "Workspace" /* Workspace */:
        return ((_c = (_b = (_a = this.app.internalPlugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b.workspaces) == null ? void 0 : _c.enabled) === true;
      case "Graph view" /* Graph */:
        return ((_f = (_e = (_d = this.app.internalPlugins) == null ? void 0 : _d.plugins) == null ? void 0 : _e.graph) == null ? void 0 : _f.enabled) === true;
      case "Journal" /* Journal */:
        return !!((_h = (_g = this.app.plugins) == null ? void 0 : _g.plugins) == null ? void 0 : _h["journals"]);
      case "Daily Note" /* DailyNote */:
      case "Weekly Note" /* WeeklyNote */:
      case "Monthly Note" /* MonthlyNote */:
      case "Yearly Note" /* YearlyNote */:
        return this.hasRequiredPeriodicity(type);
      default:
        return true;
    }
  }
  /**
   * Check if periodic notes are available for the given type
   */
  hasRequiredPeriodicity(type) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k;
    if (type === "Daily Note" /* DailyNote */) {
      return ((_c = (_b = (_a = this.app.internalPlugins) == null ? void 0 : _a.plugins) == null ? void 0 : _b["daily-notes"]) == null ? void 0 : _c.enabled) === true;
    }
    const periodicNotes = (_e = (_d = this.app.plugins) == null ? void 0 : _d.plugins) == null ? void 0 : _e["periodic-notes"];
    if (!periodicNotes) return false;
    const version = ((_f = periodicNotes == null ? void 0 : periodicNotes.manifest) == null ? void 0 : _f.version) || "0";
    const isLegacy = version.startsWith("0");
    if (isLegacy) {
      const periodMap = {
        ["Weekly Note" /* WeeklyNote */]: "weekly",
        ["Monthly Note" /* MonthlyNote */]: "monthly",
        ["Yearly Note" /* YearlyNote */]: "yearly"
      };
      const adjective = periodMap[type];
      if (!adjective) return false;
      return ((_h = (_g = periodicNotes == null ? void 0 : periodicNotes.settings) == null ? void 0 : _g[adjective]) == null ? void 0 : _h.enabled) === true;
    } else {
      const nounMap = {
        ["Weekly Note" /* WeeklyNote */]: "week",
        ["Monthly Note" /* MonthlyNote */]: "month",
        ["Yearly Note" /* YearlyNote */]: "year"
      };
      const noun = nounMap[type];
      if (!noun) return false;
      const calendarSet = (_j = (_i = periodicNotes == null ? void 0 : periodicNotes.calendarSetManager) == null ? void 0 : _i.getActiveSet) == null ? void 0 : _j.call(_i);
      return ((_k = calendarSet == null ? void 0 : calendarSet[noun]) == null ? void 0 : _k.enabled) === true;
    }
  }
  /**
   * Check if URL params indicate a file/workspace should be opened (skip homepage)
   */
  async hasUrlParams() {
    if (typeof window !== "undefined" && window.OBS_ACT) {
      const params = Object.keys(window.OBS_ACT);
      const action = window.OBS_ACT.action;
      return action !== void 0 && ["open", "advanced-uri"].includes(action) && ["file", "filepath", "workspace"].some((e) => params.includes(e));
    }
    return false;
  }
  /**
   * Handle "open when empty" feature
   */
  handleOpenWhenEmpty() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian12.View);
    if (!activeView || activeView.getViewType() !== "empty") {
      return;
    }
    const mainLeaves = this.app.workspace.getLeavesOfType("empty").concat(this.app.workspace.getLeavesOfType("markdown")).concat(this.app.workspace.getLeavesOfType("canvas")).concat(this.app.workspace.getLeavesOfType("bases"));
    if (mainLeaves.length === 1) {
      void this.homeService.openHomeBaseWithMode("retain", true);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3V0aWxzL2ZpbGUtdXRpbHMudHMiLCAic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91aS9zZXR0aW5ncy10YWIudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvdWkvZmlsZS1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN1Z2dlc3QudHMiLCAic3JjL3VpL2ljb24tcGlja2VyLnRzIiwgInNyYy9zZXJ2aWNlcy9ob21lLXNlcnZpY2UudHMiLCAic3JjL3V0aWxzL2hvbWViYXNlLXJlc29sdmVyLnRzIiwgInNyYy9zZXJ2aWNlcy9uZXctdGFiLXNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL3N0aWNreS10YWItc2VydmljZS50cyIsICJzcmMvc2VydmljZXMvbW9iaWxlLWJ1dHRvbi1zZXJ2aWNlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcclxuICogRmlsZSBVdGlsaXRpZXNcclxuICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgZmlsZSB0eXBlIGRldGVjdGlvbiBhbmQgaGFuZGxpbmdcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIFN1cHBvcnRlZCBmaWxlIGV4dGVuc2lvbnMgZm9yIGhvbWUgYmFzZVxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFNVUFBPUlRFRF9FWFRFTlNJT05TID0gWydtZCcsICdtZHgnLCAnY2FudmFzJywgJ2Jhc2UnXSBhcyBjb25zdDtcclxuZXhwb3J0IHR5cGUgU3VwcG9ydGVkRXh0ZW5zaW9uID0gdHlwZW9mIFNVUFBPUlRFRF9FWFRFTlNJT05TW251bWJlcl07XHJcblxyXG4vKipcclxuICogVmlldyB0eXBlcyBjb3JyZXNwb25kaW5nIHRvIGZpbGUgZXh0ZW5zaW9uc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9NQVA6IFJlY29yZDxTdXBwb3J0ZWRFeHRlbnNpb24sIHN0cmluZz4gPSB7XHJcblx0J21kJzogJ21hcmtkb3duJyxcclxuXHQnbWR4JzogJ21hcmtkb3duJyxcclxuXHQnY2FudmFzJzogJ2NhbnZhcycsXHJcblx0J2Jhc2UnOiAnYmFzZXMnLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgZmlsZSBleHRlbnNpb24gaXMgc3VwcG9ydGVkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNTdXBwb3J0ZWRFeHRlbnNpb24oZXh0ZW5zaW9uOiBzdHJpbmcpOiBleHRlbnNpb24gaXMgU3VwcG9ydGVkRXh0ZW5zaW9uIHtcclxuXHRyZXR1cm4gU1VQUE9SVEVEX0VYVEVOU0lPTlMuaW5jbHVkZXMoZXh0ZW5zaW9uIGFzIFN1cHBvcnRlZEV4dGVuc2lvbik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgdGhlIGZpbGUgZXh0ZW5zaW9uIGZyb20gYSBwYXRoXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsZUV4dGVuc2lvbihwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLicpO1xyXG5cdHJldHVybiBwYXJ0cy5sZW5ndGggPiAxID8gKHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdID8/ICcnKS50b0xvd2VyQ2FzZSgpIDogJyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgdGhlIHZpZXcgdHlwZSBmb3IgYSBmaWxlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Vmlld1R5cGVGb3JGaWxlKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcclxuXHRjb25zdCBleHQgPSBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xyXG5cdGlmIChpc1N1cHBvcnRlZEV4dGVuc2lvbihleHQpKSB7XHJcblx0XHRyZXR1cm4gVklFV19UWVBFX01BUFtleHRdO1xyXG5cdH1cclxuXHRyZXR1cm4gJ21hcmtkb3duJzsgLy8gRGVmYXVsdCBmYWxsYmFja1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYSBmaWxlIGlzIGEgbWFya2Rvd24tbGlrZSBmaWxlIChtZCBvciBtZHgpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrZG93bkxpa2UoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcclxuXHRjb25zdCBleHQgPSBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xyXG5cdHJldHVybiBleHQgPT09ICdtZCcgfHwgZXh0ID09PSAnbWR4JztcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgZmlsZSBpcyBhbiBNRFggZmlsZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzTWR4RmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSAnbWR4JztcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgZmlsZSBpcyBhIGNhbnZhcyBmaWxlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNDYW52YXNGaWxlKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkgPT09ICdjYW52YXMnO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYSBmaWxlIGlzIGEgYmFzZSBmaWxlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNCYXNlRmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSAnYmFzZSc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBmaWxlIGJ5IHBhdGgsIHRyeWluZyB3aXRoIGFuZCB3aXRob3V0IGV4dGVuc2lvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVCeVBhdGgoYXBwOiBBcHAsIHBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XHJcblx0Ly8gVHJ5IGV4YWN0IHBhdGggZmlyc3RcclxuXHRjb25zdCBleGFjdE1hdGNoID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwYXRoKTtcclxuXHRpZiAoZXhhY3RNYXRjaCBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRyZXR1cm4gZXhhY3RNYXRjaDtcclxuXHR9XHJcblxyXG5cdC8vIFRyeSB1c2luZyBtZXRhZGF0YUNhY2hlIGZvciBmdXp6eSBtYXRjaGluZ1xyXG5cdGNvbnN0IGZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChwYXRoLCAnLycpO1xyXG5cdHJldHVybiBmaWxlO1xyXG59XHJcblxyXG4vKipcclxuICogVHJpbSB0aGUgZmlsZSBleHRlbnNpb24gZnJvbSBhIHBhdGggZm9yIGNvbXBhcmlzb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmltRmlsZUV4dGVuc2lvbihwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdGNvbnN0IGxhc3REb3QgPSBwYXRoLmxhc3RJbmRleE9mKCcuJyk7XHJcblx0aWYgKGxhc3REb3QgPiAwKSB7XHJcblx0XHRjb25zdCBleHQgPSBwYXRoLnNsaWNlKGxhc3REb3QgKyAxKS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0aWYgKFNVUFBPUlRFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dCBhcyBTdXBwb3J0ZWRFeHRlbnNpb24pKSB7XHJcblx0XHRcdHJldHVybiBwYXRoLnNsaWNlKDAsIGxhc3REb3QpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gcGF0aDtcclxufVxyXG5cclxuLyoqXHJcbiAqIENvbXBhcmUgdHdvIHBhdGhzLCBpZ25vcmluZyBjYXNlIGFuZCBleHRlbnNpb24gZGlmZmVyZW5jZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXRoc0VxdWFsKHBhdGgxOiBzdHJpbmcsIHBhdGgyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRjb25zdCBub3JtMSA9IHRyaW1GaWxlRXh0ZW5zaW9uKHBhdGgxKS50b0xvd2VyQ2FzZSgpO1xyXG5cdGNvbnN0IG5vcm0yID0gdHJpbUZpbGVFeHRlbnNpb24ocGF0aDIpLnRvTG93ZXJDYXNlKCk7XHJcblx0cmV0dXJuIG5vcm0xID09PSBub3JtMjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgbGVhZiBpcyBzaG93aW5nIGEgc3BlY2lmaWMgZmlsZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxlYWZIYXNGaWxlKGxlYWY6IFdvcmtzcGFjZUxlYWYsIGZpbGVQYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRjb25zdCBzdGF0ZSA9IGxlYWYudmlldz8uZ2V0U3RhdGU/LigpO1xyXG5cdGNvbnN0IGxlYWZGaWxlID0gc3RhdGU/LmZpbGUgYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cdFxyXG5cdGlmICghbGVhZkZpbGUpIHJldHVybiBmYWxzZTtcclxuXHRcclxuXHRyZXR1cm4gcGF0aHNFcXVhbChsZWFmRmlsZSwgZmlsZVBhdGgpO1xyXG59XHJcbiIsICIvKipcclxuICogSG9tZSBCYXNlIFBsdWdpblxyXG4gKiBZb3VyIGRlZGljYXRlZCBob21lIGluIHlvdXIgdmF1bHRcclxuICovXHJcblxyXG5pbXBvcnQgeyBOb3RpY2UsIFBsYXRmb3JtLCBQbHVnaW4sIFZpZXcsIGFkZEljb24gfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEhvbWVCYXNlU2V0dGluZ3MsIEhvbWVCYXNlVHlwZSB9IGZyb20gJy4vc2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBIb21lQmFzZVNldHRpbmdUYWIgfSBmcm9tICcuL3VpL3NldHRpbmdzLXRhYic7XHJcbmltcG9ydCB7IEhvbWVCYXNlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvaG9tZS1zZXJ2aWNlJztcclxuaW1wb3J0IHsgTmV3VGFiU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvbmV3LXRhYi1zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3RpY2t5VGFiU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvc3RpY2t5LXRhYi1zZXJ2aWNlJztcclxuaW1wb3J0IHsgTW9iaWxlQnV0dG9uU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvbW9iaWxlLWJ1dHRvbi1zZXJ2aWNlJztcclxuXHJcbi8qKlxyXG4gKiBFeHRlbmRlZCBBcHAgaW50ZXJmYWNlIGZvciByZWxlYXNlIG5vdGVzIHBhdGNoaW5nXHJcbiAqL1xyXG5pbnRlcmZhY2UgQXBwV2l0aFJlbGVhc2VOb3RlcyB7XHJcblx0c2hvd1JlbGVhc2VOb3Rlcz86ICgpID0+IHZvaWQ7XHJcblx0bnZPcmlnX3Nob3dSZWxlYXNlTm90ZXM/OiAoKSA9PiB2b2lkO1xyXG59XHJcblxyXG4vKipcclxuICogQ3VzdG9tIGhvbWUgaWNvbiBTVkcgKEx1Y2lkZSBob3VzZSBpY29uKVxyXG4gKi9cclxuY29uc3QgSE9NRV9JQ09OID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBkPVwiTTE1IDIxdi04YTEgMSAwIDAgMC0xLTFoLTRhMSAxIDAgMCAwLTEgMXY4XCIvPjxwYXRoIGQ9XCJNMyAxMGEyIDIgMCAwIDEgLjcwOS0xLjUyOGw3LTZhMiAyIDAgMCAxIDIuNTgyIDBsNyA2QTIgMiAwIDAgMSAyMSAxMHY5YTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0yelwiLz48L3N2Zz5gO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZUJhc2VQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG5cdHNldHRpbmdzITogSG9tZUJhc2VTZXR0aW5ncztcclxuXHRcclxuXHQvLyBTZXJ2aWNlc1xyXG5cdGhvbWVTZXJ2aWNlITogSG9tZUJhc2VTZXJ2aWNlO1xyXG5cdG5ld1RhYlNlcnZpY2UhOiBOZXdUYWJTZXJ2aWNlO1xyXG5cdHN0aWNreVRhYlNlcnZpY2UhOiBTdGlja3lUYWJTZXJ2aWNlO1xyXG5cdG1vYmlsZUJ1dHRvblNlcnZpY2UhOiBNb2JpbGVCdXR0b25TZXJ2aWNlO1xyXG5cdFxyXG5cdC8vIFJlbGVhc2Ugbm90ZXMgdHJhY2tpbmdcclxuXHRwcml2YXRlIG5ld1JlbGVhc2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0YXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHRcdFxyXG5cdFx0Ly8gTWlncmF0ZSBsZWdhY3kgc2V0dGluZ3Mgb24gZmlyc3QgbG9hZFxyXG5cdFx0YXdhaXQgdGhpcy5taWdyYXRlTGVnYWN5U2V0dGluZ3MoKTtcclxuXHJcblx0XHQvLyBQYXRjaCBvcGVuaW5nIGJlaGF2aW9yIGZvciBmYXN0IHN0YXJ0dXAgKGJlZm9yZSBvdGhlciBpbml0aWFsaXphdGlvbilcclxuXHRcdHRoaXMucGF0Y2hPcGVuaW5nQmVoYXZpb3IoKTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciBjdXN0b20gaWNvblxyXG5cdFx0YWRkSWNvbignaG9tZS1iYXNlJywgSE9NRV9JQ09OKTtcclxuXHJcblx0XHQvLyBJbml0aWFsaXplIHNlcnZpY2VzXHJcblx0XHR0aGlzLmhvbWVTZXJ2aWNlID0gbmV3IEhvbWVCYXNlU2VydmljZSh0aGlzKTtcclxuXHRcdHRoaXMubmV3VGFiU2VydmljZSA9IG5ldyBOZXdUYWJTZXJ2aWNlKHRoaXMpO1xyXG5cdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlID0gbmV3IFN0aWNreVRhYlNlcnZpY2UodGhpcyk7XHJcblx0XHR0aGlzLm1vYmlsZUJ1dHRvblNlcnZpY2UgPSBuZXcgTW9iaWxlQnV0dG9uU2VydmljZSh0aGlzKTtcclxuXHJcblx0XHQvLyBBZGQgcmliYm9uIGljb25cclxuXHRcdHRoaXMuYWRkUmliYm9uSWNvbignaG9tZScsICdPcGVuIGhvbWUgYmFzZScsICgpID0+IHtcclxuXHRcdFx0dm9pZCB0aGlzLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZSh7XHJcblx0XHRcdFx0cmVwbGFjZUFjdGl2ZUxlYWY6IGZhbHNlLFxyXG5cdFx0XHRcdHJ1bkNvbW1hbmQ6IHRydWUsXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gUmVnaXN0ZXIgY29tbWFuZHNcclxuXHRcdHRoaXMucmVnaXN0ZXJDb21tYW5kcygpO1xyXG5cclxuXHRcdC8vIEFkZCBzZXR0aW5ncyB0YWJcclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgSG9tZUJhc2VTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gV2FpdCBmb3IgbGF5b3V0IHRvIGJlIHJlYWR5XHJcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XHJcblx0XHRcdC8vIFVzZSBhIHNtYWxsIGRlbGF5IHRvIGVuc3VyZSBET00gaXMgcmVhZHkgKGVzcGVjaWFsbHkgZm9yIHNldHRpbmdzIG1vZGFsIGRldGVjdGlvbilcclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgc2V0dGluZ3MgbW9kYWwgaXMgb3BlbiAtIGlmIHNvLCBza2lwIHN0YXJ0dXAgbG9naWNcclxuXHRcdFx0XHRpZiAodGhpcy5pc1NldHRpbmdzTW9kYWxPcGVuKCkpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUuZGVidWcoJ0hvbWUgQmFzZTogU2V0dGluZ3MgbW9kYWwgaXMgb3Blbiwgc2tpcHBpbmcgc3RhcnR1cCBsb2dpYycpO1xyXG5cdFx0XHRcdFx0Ly8gU3RpbGwgdXBkYXRlIFVJIGZlYXR1cmVzLCBqdXN0IGRvbid0IHJ1biBzdGFydHVwIGxvZ2ljXHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVN0aWNreVRhYkljb24oKTtcclxuXHRcdFx0XHRcdHRoaXMudXBkYXRlTW9iaWxlQnV0dG9uKCk7XHJcblx0XHRcdFx0XHR0aGlzLnN0aWNreVRhYlNlcnZpY2UudXBkYXRlVGFiSGVhZGVycygpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gUnVuIHN0YXJ0dXAgbG9naWMgLSBpdCB3aWxsIGhhbmRsZSBrZWVwRXhpc3RpbmdUYWJzIHNldHRpbmdcclxuXHRcdFx0XHQvLyBOb3RlOiBXZSBkb24ndCBza2lwIGJhc2VkIG9uIG9wZW4gZmlsZXMgYmVjYXVzZSBvbiBhY3R1YWwgc3RhcnR1cCxcclxuXHRcdFx0XHQvLyBPYnNpZGlhbiByZXN0b3JlcyB0aGUgcHJldmlvdXMgc2Vzc2lvbidzIHRhYnMsIHNvIGZpbGVzIHdpbGwgYmUgb3BlblxyXG5cdFx0XHRcdHRoaXMubmV3VGFiU2VydmljZS5pbml0aWFsaXplKCk7XHJcblxyXG5cdFx0XHRcdC8vIFVwZGF0ZSBVSSBmZWF0dXJlc1xyXG5cdFx0XHRcdHRoaXMudXBkYXRlU3RpY2t5VGFiSWNvbigpO1xyXG5cdFx0XHRcdHRoaXMudXBkYXRlTW9iaWxlQnV0dG9uKCk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gVXBkYXRlIHRhYiBoZWFkZXJzIGFmdGVyIGxheW91dCBpcyByZWFkeVxyXG5cdFx0XHRcdHRoaXMuc3RpY2t5VGFiU2VydmljZS51cGRhdGVUYWJIZWFkZXJzKCk7XHJcblx0XHRcdH0sIDEwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBET00gaXMgcmVhZHlcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIGxheW91dCBjaGFuZ2UgaGFuZGxlclxyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5uZXdUYWJTZXJ2aWNlLmhhbmRsZUxheW91dENoYW5nZSgpO1xyXG5cdFx0XHRcdC8vIEhhbmRsZSByZXZlcnQgdmlldyBvbiBjbG9zZVxyXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJldmVydFZpZXcpIHtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaG9tZVNlcnZpY2UucmV2ZXJ0VmlldygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBDaGVjayBmb3IgXCJvcGVuIHdoZW4gZW1wdHlcIiBmZWF0dXJlXHJcblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3Mub3BlbldoZW5FbXB0eSkge1xyXG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVPcGVuV2hlbkVtcHR5KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIERlbGF5IHRhYiBoZWFkZXIgdXBkYXRlcyB0byBhdm9pZCBmbGlja2VyaW5nIGR1cmluZyB0YWIgdHJhbnNpdGlvbnNcclxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRcdHRoaXMuc3RpY2t5VGFiU2VydmljZS51cGRhdGVBY3RpdmVTdGF0ZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHRcdFx0XHRcdC8vIEFsc28gdXBkYXRlIGljb24gcG9zaXRpb24gaW4gY2FzZSBzaWRlYmFyIHN0YXRlIGNoYW5nZWRcclxuXHRcdFx0XHRcdHRoaXMuc3RpY2t5VGFiU2VydmljZS51cGRhdGVJY29uUG9zaXRpb25Gb3JTaWRlYmFyKCk7XHJcblx0XHRcdFx0fSwgMTUwKTtcclxuXHRcdFx0fSlcclxuXHRcdCk7XHJcblxyXG5cdFx0Ly8gUmVnaXN0ZXIgZmlsZSBvcGVuIGhhbmRsZXIgZm9yIGFjdGl2ZSBzdGF0ZSB1cGRhdGVzXHJcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignZmlsZS1vcGVuJywgKCkgPT4ge1xyXG5cdFx0XHRcdC8vIERlbGF5IHVwZGF0ZXMgdG8gbGV0IGZpbGUgb3BlbiBhbmltYXRpb24gY29tcGxldGVcclxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRcdHRoaXMuc3RpY2t5VGFiU2VydmljZS51cGRhdGVBY3RpdmVTdGF0ZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHRcdFx0XHR9LCAxMDApO1xyXG5cdFx0XHR9KVxyXG5cdFx0KTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciBhY3RpdmUgbGVhZiBjaGFuZ2UgaGFuZGxlciBmb3IgdGFiIGhlYWRlciB1cGRhdGVzXHJcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xyXG5cdFx0XHRcdC8vIERlbGF5IHRvIGxldCB0YWIgc3dpdGNoIGFuaW1hdGlvbiBjb21wbGV0ZVxyXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHRcdFx0XHR9LCAxMDApO1xyXG5cdFx0XHR9KVxyXG5cdFx0KTtcclxuXHJcblx0XHRjb25zb2xlLmRlYnVnKCdIb21lIEJhc2UgcGx1Z2luIGxvYWRlZCcpO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKTogdm9pZCB7XHJcblx0XHQvLyBVbnBhdGNoIHJlbGVhc2Ugbm90ZXNcclxuXHRcdHRoaXMudW5wYXRjaFJlbGVhc2VOb3RlcygpO1xyXG5cdFx0XHJcblx0XHQvLyBVbnBhdGNoIG9wZW5pbmcgYmVoYXZpb3JcclxuXHRcdHRoaXMudW5wYXRjaE9wZW5pbmdCZWhhdmlvcigpO1xyXG5cdFx0XHJcblx0XHQvLyBDbGVhbiB1cCBzZXJ2aWNlc1xyXG5cdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlLnJlbW92ZSgpO1xyXG5cdFx0dGhpcy5tb2JpbGVCdXR0b25TZXJ2aWNlLnJlbW92ZSgpO1xyXG5cclxuXHRcdGNvbnNvbGUuZGVidWcoJ0hvbWUgQmFzZSBwbHVnaW4gdW5sb2FkZWQnKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJlZ2lzdGVyIHBsdWdpbiBjb21tYW5kc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgcmVnaXN0ZXJDb21tYW5kcygpOiB2b2lkIHtcclxuXHRcdC8vIE9wZW4gaG9tZSBiYXNlXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ29wZW4nLFxyXG5cdFx0XHRuYW1lOiAnT3BlbicsXHJcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgaG9tZUJhc2VTZXR0aW5ncyA9IHRoaXMuZ2V0SG9tZUJhc2VTZXR0aW5ncygpO1xyXG5cdFx0XHRcdGlmICghaG9tZUJhc2VTZXR0aW5ncy52YWx1ZSAmJiBob21lQmFzZVNldHRpbmdzLnR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdObyBob21lIGJhc2UgY29uZmlndXJlZC4gU2V0IG9uZSBpbiBzZXR0aW5ncy4nKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dm9pZCB0aGlzLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZSh7XHJcblx0XHRcdFx0XHRyZXBsYWNlQWN0aXZlTGVhZjogZmFsc2UsXHJcblx0XHRcdFx0XHRydW5Db21tYW5kOiB0cnVlLFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gU2V0IGN1cnJlbnQgZmlsZSBhcyBob21lIGJhc2VcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnc2V0LWN1cnJlbnQtZmlsZScsXHJcblx0XHRcdG5hbWU6ICdTZXQgY3VycmVudCBmaWxlIGFzIGhvbWUnLFxyXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmcpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuaG9tZVNlcnZpY2UuY2FuU2V0QWN0aXZlRmlsZUFzSG9tZUJhc2UoKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XHJcblx0XHRcdFx0XHR2b2lkIHRoaXMuaG9tZVNlcnZpY2Uuc2V0QWN0aXZlRmlsZUFzSG9tZUJhc2UoKS50aGVuKChzdWNjZXNzKSA9PiB7XHJcblx0XHRcdFx0XHRcdGlmIChzdWNjZXNzKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgSG9tZSBiYXNlIHNldCB0byBcIiR7YWN0aXZlRmlsZT8ubmFtZX1cImApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBUb2dnbGUgc3RpY2t5IGhvbWUgaWNvblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICd0b2dnbGUtc3RpY2t5LWljb24nLFxyXG5cdFx0XHRuYW1lOiAnVG9nZ2xlIHN0aWNreSBob21lIGljb24nLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuc3RpY2t5VGFiU2VydmljZS50b2dnbGUoKTtcclxuXHRcdFx0XHRjb25zdCBzdGF0ZSA9IHRoaXMuc2V0dGluZ3Muc2hvd1N0aWNreUhvbWVJY29uID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJztcclxuXHRcdFx0XHRuZXcgTm90aWNlKGBTdGlja3kgaG9tZSBpY29uICR7c3RhdGV9YCk7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBDbG9zZSBob21lIGJhc2VcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnY2xvc2UnLFxyXG5cdFx0XHRuYW1lOiAnQ2xvc2UnLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuc3RpY2t5VGFiU2VydmljZS5jbG9zZUhvbWVCYXNlKCk7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvYWQgcGx1Z2luIHNldHRpbmdzXHJcblx0ICovXHJcblx0YXN5bmMgbG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Y29uc3QgZGF0YSA9IChhd2FpdCB0aGlzLmxvYWREYXRhKCkpIGFzIFBhcnRpYWw8SG9tZUJhc2VTZXR0aW5ncz4gfCBudWxsO1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGRhdGEgPz8ge30pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTWlncmF0ZSBsZWdhY3kgc2V0dGluZ3MgdG8gbmV3IGZvcm1hdFxyXG5cdCAqL1xyXG5cdGFzeW5jIG1pZ3JhdGVMZWdhY3lTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdGxldCBuZWVkc1NhdmUgPSBmYWxzZTtcclxuXHRcdFxyXG5cdFx0Ly8gTWlncmF0ZSBob21lQmFzZVBhdGggdG8gaG9tZUJhc2VUeXBlL2hvbWVCYXNlVmFsdWVcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmhvbWVCYXNlUGF0aCAmJiAhdGhpcy5zZXR0aW5ncy5ob21lQmFzZVZhbHVlKSB7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MuaG9tZUJhc2VUeXBlID0gSG9tZUJhc2VUeXBlLkZpbGU7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MuaG9tZUJhc2VWYWx1ZSA9IHRoaXMuc2V0dGluZ3MuaG9tZUJhc2VQYXRoO1xyXG5cdFx0XHRuZWVkc1NhdmUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBNaWdyYXRlIGtlZXBFeGlzdGluZ1RhYnMgdG8gb3Blbk1vZGVcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmtlZXBFeGlzdGluZ1RhYnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5vcGVuTW9kZSA9PT0gREVGQVVMVF9TRVRUSU5HUy5vcGVuTW9kZSkge1xyXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3Mub3Blbk1vZGUgPSB0aGlzLnNldHRpbmdzLmtlZXBFeGlzdGluZ1RhYnMgPyAncmV0YWluJyA6ICdyZXBsYWNlLWFsbCc7XHJcblx0XHRcdFx0bmVlZHNTYXZlID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBNaWdyYXRlIG1vYmlsZSBob21lQmFzZVBhdGhcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlUGF0aCAmJiAhdGhpcy5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVZhbHVlKSB7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VUeXBlID0gSG9tZUJhc2VUeXBlLkZpbGU7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VWYWx1ZSA9IHRoaXMuc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VQYXRoO1xyXG5cdFx0XHRuZWVkc1NhdmUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRpZiAobmVlZHNTYXZlKSB7XHJcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZXQgdGhlIGFjdGl2ZSBob21lIGJhc2Ugc2V0dGluZ3MgKG1vYmlsZSBvciBkZXNrdG9wKVxyXG5cdCAqL1xyXG5cdGdldEhvbWVCYXNlU2V0dGluZ3MoKToge1xyXG5cdFx0dHlwZTogSG9tZUJhc2VUeXBlO1xyXG5cdFx0dmFsdWU6IHN0cmluZztcclxuXHRcdHBhdGg6IHN0cmluZzsgLy8gTGVnYWN5IGNvbXBhdGliaWxpdHlcclxuXHR9IHtcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnNlcGFyYXRlTW9iaWxlICYmIFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0dHlwZTogdGhpcy5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVR5cGUgfHwgSG9tZUJhc2VUeXBlLkZpbGUsXHJcblx0XHRcdFx0dmFsdWU6IHRoaXMuc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VWYWx1ZSB8fCB0aGlzLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlUGF0aCB8fCAnJyxcclxuXHRcdFx0XHRwYXRoOiB0aGlzLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlUGF0aCB8fCB0aGlzLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlVmFsdWUgfHwgJycsXHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHR5cGU6IHRoaXMuc2V0dGluZ3MuaG9tZUJhc2VUeXBlIHx8IEhvbWVCYXNlVHlwZS5GaWxlLFxyXG5cdFx0XHR2YWx1ZTogdGhpcy5zZXR0aW5ncy5ob21lQmFzZVZhbHVlIHx8IHRoaXMuc2V0dGluZ3MuaG9tZUJhc2VQYXRoIHx8ICcnLFxyXG5cdFx0XHRwYXRoOiB0aGlzLnNldHRpbmdzLmhvbWVCYXNlUGF0aCB8fCB0aGlzLnNldHRpbmdzLmhvbWVCYXNlVmFsdWUgfHwgJycsXHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2F2ZSBwbHVnaW4gc2V0dGluZ3NcclxuXHQgKi9cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlIHRoZSBzdGlja3kgdGFiIGljb24gYmFzZWQgb24gY3VycmVudCBzZXR0aW5nc1xyXG5cdCAqL1xyXG5cdHVwZGF0ZVN0aWNreVRhYkljb24oKTogdm9pZCB7XHJcblx0XHR0aGlzLnN0aWNreVRhYlNlcnZpY2UudXBkYXRlKCk7XHJcblx0XHQvLyBBbHNvIHVwZGF0ZSB0YWIgaGVhZGVycyB3aGVuIHN0aWNreSBpY29uIHNldHRpbmcgY2hhbmdlc1xyXG5cdFx0dGhpcy5zdGlja3lUYWJTZXJ2aWNlLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVwZGF0ZSB0aGUgbW9iaWxlIGJ1dHRvbiBiYXNlZCBvbiBjdXJyZW50IHNldHRpbmdzXHJcblx0ICovXHJcblx0dXBkYXRlTW9iaWxlQnV0dG9uKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5tb2JpbGVCdXR0b25TZXJ2aWNlLnVwZGF0ZSgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2sgaWYgd2Ugc2hvdWxkIHNraXAgc3RhcnR1cCBsb2dpYyAoZS5nLiwgcGx1Z2luIHJlbG9hZCwgc2V0dGluZ3MgbW9kYWwgb3BlbilcclxuXHQgKiBUaGlzIHByZXZlbnRzIGRlc3RydWN0aXZlIGJlaGF2aW9yIHdoZW4gdGhlIHBsdWdpbiBpcyByZWxvYWRlZCBvciBzZXR0aW5ncyBhcmUgb3BlblxyXG5cdCAqL1xyXG5cdHByaXZhdGUgc2hvdWxkU2tpcFN0YXJ0dXBMb2dpYygpOiBib29sZWFuIHtcclxuXHRcdC8vIENoZWNrIGlmIHNldHRpbmdzIG1vZGFsIGlzIG9wZW4gLSBuZXZlciBydW4gc3RhcnR1cCBsb2dpYyBpZiBpdCBpc1xyXG5cdFx0aWYgKHRoaXMuaXNTZXR0aW5nc01vZGFsT3BlbigpKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYSBwbHVnaW4gcmVsb2FkIHZzIGFjdHVhbCBhcHAgc3RhcnR1cFxyXG5cdFx0Ly8gT24gYWN0dWFsIHN0YXJ0dXAsIE9ic2lkaWFuIGhhc24ndCByZXN0b3JlZCB0aGUgd29ya3NwYWNlIHlldFxyXG5cdFx0Ly8gT24gcGx1Z2luIHJlbG9hZCwgZmlsZXMgYXJlIGFscmVhZHkgb3BlbiBhbmQgd29ya3NwYWNlIGlzIHJlc3RvcmVkXHJcblx0XHRjb25zdCBoYXNPcGVuRmlsZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpLmxlbmd0aCA+IDAgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2NhbnZhcycpLmxlbmd0aCA+IDAgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2Jhc2VzJykubGVuZ3RoID4gMCB8fFxyXG5cdFx0ICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZW1wdHknKS5sZW5ndGggPiAwO1xyXG5cdFx0XHJcblx0XHQvLyBJZiBmaWxlcyBhcmUgb3BlbiwgdGhpcyBpcyBsaWtlbHkgYSBwbHVnaW4gcmVsb2FkLCBub3QgYWN0dWFsIHN0YXJ0dXBcclxuXHRcdHJldHVybiBoYXNPcGVuRmlsZXM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVjayBpZiB0aGUgc2V0dGluZ3MgbW9kYWwgaXMgY3VycmVudGx5IG9wZW5cclxuXHQgKi9cclxuXHRwcml2YXRlIGlzU2V0dGluZ3NNb2RhbE9wZW4oKTogYm9vbGVhbiB7XHJcblx0XHQvLyBDaGVjayBmb3Igc2V0dGluZ3MgbW9kYWwgYnkgbG9va2luZyBmb3IgdGhlIG1vZGFsIGNvbnRhaW5lclxyXG5cdFx0Ly8gVHJ5IG11bHRpcGxlIHNlbGVjdG9ycyB0byBiZSBtb3JlIHJvYnVzdFxyXG5cdFx0Y29uc3Qgc2V0dGluZ3NNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXIubW9kLXNldHRpbmdzJykgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwubW9kLXNldHRpbmdzJykgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmVydGljYWwtdGFiLWNvbnRlbnQnKTtcclxuXHRcdFxyXG5cdFx0Ly8gQWxzbyBjaGVjayBpZiBhbnkgbW9kYWwgaXMgb3BlbiBhbmQgY29udGFpbnMgc2V0dGluZ3MgY29udGVudFxyXG5cdFx0aWYgKCFzZXR0aW5nc01vZGFsKSB7XHJcblx0XHRcdGNvbnN0IGFsbE1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbC1jb250YWluZXInKTtcclxuXHRcdFx0Zm9yIChjb25zdCBtb2RhbCBvZiBBcnJheS5mcm9tKGFsbE1vZGFscykpIHtcclxuXHRcdFx0XHRpZiAobW9kYWwucXVlcnlTZWxlY3RvcignLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0ICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5ncy1jb250ZW50JykgfHxcclxuXHRcdFx0XHQgICAgbW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2Qtc2V0dGluZ3MnKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiBzZXR0aW5nc01vZGFsICE9PSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUGF0Y2ggcnVuT3BlbmluZ0JlaGF2aW9yIGZvciBmYXN0IHN0YXJ0dXAgKGxpa2UgaG9tZXBhZ2UgcGx1Z2luKVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgcGF0Y2hPcGVuaW5nQmVoYXZpb3IoKTogdm9pZCB7XHJcblx0XHQvLyBTdG9yZSBvcmlnaW5hbCBtZXRob2RcclxuXHRcdCBcclxuXHRcdHRoaXMuYXBwLm52T3JpZ19ydW5PcGVuaW5nQmVoYXZpb3IgPSB0aGlzLmFwcC5ydW5PcGVuaW5nQmVoYXZpb3I7XHJcblx0XHRcclxuXHRcdC8vIFBhdGNoIHRoZSBtZXRob2RcclxuXHRcdCBcclxuXHRcdHRoaXMuYXBwLnJ1bk9wZW5pbmdCZWhhdmlvciA9IGFzeW5jIChwYXRoOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0Y29uc3Qgb3BlbkluaXRpYWxseSA9IChcclxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLm9wZW5PblN0YXJ0dXAgJiYgXHJcblx0XHRcdFx0IShhd2FpdCB0aGlzLmhhc1VybFBhcmFtcygpKVxyXG5cdFx0XHQpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKG9wZW5Jbml0aWFsbHkpIHtcclxuXHRcdFx0XHQvLyBVc2UgZmFzdCBzdGFydHVwIC0gZGV0YWNoIGFsbCBsZWF2ZXMgYW5kIG9wZW4gaG9tZSBiYXNlXHJcblx0XHRcdFx0Y29uc3QgbW9kZSA9IHRoaXMuc2V0dGluZ3Mub3Blbk1vZGU7XHJcblx0XHRcdFx0aWYgKG1vZGUgPT09ICdyZXBsYWNlLWFsbCcpIHtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaG9tZVNlcnZpY2UuZGV0YWNoQWxsTGVhdmVzKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGF3YWl0IHRoaXMuaG9tZVNlcnZpY2Uub3BlbkhvbWVCYXNlV2l0aE1vZGUobW9kZSwgdHJ1ZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gQ2FsbCBvcmlnaW5hbCBiZWhhdmlvclxyXG5cdFx0XHRcdCBcclxuXHRcdFx0XHRpZiAodGhpcy5hcHAubnZPcmlnX3J1bk9wZW5pbmdCZWhhdmlvcikge1xyXG5cdFx0XHRcdFx0IFxyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAubnZPcmlnX3J1bk9wZW5pbmdCZWhhdmlvcihwYXRoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdC8vIFVucGF0Y2ggcmVsZWFzZSBub3RlcyBhZnRlciBvcGVuaW5nIGJlaGF2aW9yIGNvbXBsZXRlc1xyXG5cdFx0XHR0aGlzLnVucGF0Y2hSZWxlYXNlTm90ZXMoKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBVbnBhdGNoIHJ1bk9wZW5pbmdCZWhhdmlvclxyXG5cdCAqL1xyXG5cdHByaXZhdGUgdW5wYXRjaE9wZW5pbmdCZWhhdmlvcigpOiB2b2lkIHtcclxuXHRcdCBcclxuXHRcdGlmICh0aGlzLmFwcC5udk9yaWdfcnVuT3BlbmluZ0JlaGF2aW9yKSB7XHJcblx0XHRcdCBcclxuXHRcdFx0dGhpcy5hcHAucnVuT3BlbmluZ0JlaGF2aW9yID0gdGhpcy5hcHAubnZPcmlnX3J1bk9wZW5pbmdCZWhhdmlvcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFBhdGNoIHNob3dSZWxlYXNlTm90ZXMgdG8gdHJhY2sgbmV3IHJlbGVhc2VzXHJcblx0ICovXHJcblx0cHJpdmF0ZSBwYXRjaFJlbGVhc2VOb3RlcygpOiB2b2lkIHtcclxuXHRcdGNvbnN0IGFwcEFueSA9IHRoaXMuYXBwIGFzIHVua25vd24gYXMgQXBwV2l0aFJlbGVhc2VOb3RlcztcclxuXHRcdCBcclxuXHRcdGFwcEFueS5udk9yaWdfc2hvd1JlbGVhc2VOb3RlcyA9IGFwcEFueS5zaG93UmVsZWFzZU5vdGVzO1xyXG5cdFx0IFxyXG5cdFx0YXBwQW55LnNob3dSZWxlYXNlTm90ZXMgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMubmV3UmVsZWFzZSA9IHRydWU7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVW5wYXRjaCBzaG93UmVsZWFzZU5vdGVzXHJcblx0ICovXHJcblx0cHJpdmF0ZSB1bnBhdGNoUmVsZWFzZU5vdGVzKCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgYXBwQW55ID0gdGhpcy5hcHAgYXMgdW5rbm93biBhcyBBcHBXaXRoUmVsZWFzZU5vdGVzO1xyXG5cdFx0IFxyXG5cdFx0aWYgKHRoaXMubmV3UmVsZWFzZSAmJiAhdGhpcy5zZXR0aW5ncy5oaWRlUmVsZWFzZU5vdGVzKSB7XHJcblx0XHRcdCBcclxuXHRcdFx0YXBwQW55Lm52T3JpZ19zaG93UmVsZWFzZU5vdGVzPy4oKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0IFxyXG5cdFx0aWYgKGFwcEFueS5udk9yaWdfc2hvd1JlbGVhc2VOb3Rlcykge1xyXG5cdFx0XHQgXHJcblx0XHRcdGFwcEFueS5zaG93UmVsZWFzZU5vdGVzID0gYXBwQW55Lm52T3JpZ19zaG93UmVsZWFzZU5vdGVzO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2sgaWYgYSBob21lIGJhc2UgdHlwZSBoYXMgaXRzIHJlcXVpcmVkIHBsdWdpbiBlbmFibGVkXHJcblx0ICovXHJcblx0aGFzUmVxdWlyZWRQbHVnaW4odHlwZTogSG9tZUJhc2VUeXBlKTogYm9vbGVhbiB7XHJcblx0XHRzd2l0Y2ggKHR5cGUpIHtcclxuXHRcdFx0Y2FzZSBIb21lQmFzZVR5cGUuV29ya3NwYWNlOlxyXG5cdFx0XHRcdCBcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5hcHAuaW50ZXJuYWxQbHVnaW5zPy5wbHVnaW5zPy53b3Jrc3BhY2VzPy5lbmFibGVkID09PSB0cnVlO1xyXG5cdFx0XHRjYXNlIEhvbWVCYXNlVHlwZS5HcmFwaDpcclxuXHRcdFx0XHQgXHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuYXBwLmludGVybmFsUGx1Z2lucz8ucGx1Z2lucz8uZ3JhcGg/LmVuYWJsZWQgPT09IHRydWU7XHJcblx0XHRcdGNhc2UgSG9tZUJhc2VUeXBlLkpvdXJuYWw6XHJcblx0XHRcdFx0IFxyXG5cdFx0XHRcdHJldHVybiAhIXRoaXMuYXBwLnBsdWdpbnM/LnBsdWdpbnM/Llsnam91cm5hbHMnXTtcclxuXHRcdFx0Y2FzZSBIb21lQmFzZVR5cGUuRGFpbHlOb3RlOlxyXG5cdFx0XHRjYXNlIEhvbWVCYXNlVHlwZS5XZWVrbHlOb3RlOlxyXG5cdFx0XHRjYXNlIEhvbWVCYXNlVHlwZS5Nb250aGx5Tm90ZTpcclxuXHRcdFx0Y2FzZSBIb21lQmFzZVR5cGUuWWVhcmx5Tm90ZTpcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYXNSZXF1aXJlZFBlcmlvZGljaXR5KHR5cGUpO1xyXG5cdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2sgaWYgcGVyaW9kaWMgbm90ZXMgYXJlIGF2YWlsYWJsZSBmb3IgdGhlIGdpdmVuIHR5cGVcclxuXHQgKi9cclxuXHRwcml2YXRlIGhhc1JlcXVpcmVkUGVyaW9kaWNpdHkodHlwZTogSG9tZUJhc2VUeXBlKTogYm9vbGVhbiB7XHJcblx0XHRpZiAodHlwZSA9PT0gSG9tZUJhc2VUeXBlLkRhaWx5Tm90ZSkge1xyXG5cdFx0XHQgXHJcblx0XHRcdHJldHVybiB0aGlzLmFwcC5pbnRlcm5hbFBsdWdpbnM/LnBsdWdpbnM/LlsnZGFpbHktbm90ZXMnXT8uZW5hYmxlZCA9PT0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0IFxyXG5cdFx0Y29uc3QgcGVyaW9kaWNOb3RlcyA9IHRoaXMuYXBwLnBsdWdpbnM/LnBsdWdpbnM/LlsncGVyaW9kaWMtbm90ZXMnXTtcclxuXHRcdGlmICghcGVyaW9kaWNOb3RlcykgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHJcblx0XHQvLyBDaGVjayBpZiBwZXJpb2RpYyBub3RlcyBwbHVnaW4gaGFzIHRoZSByZXF1aXJlZCBwZXJpb2QgZW5hYmxlZFxyXG5cdFx0IFxyXG5cdFx0Y29uc3QgdmVyc2lvbiA9IChwZXJpb2RpY05vdGVzIGFzIHsgbWFuaWZlc3Q/OiB7IHZlcnNpb24/OiBzdHJpbmcgfSB9KT8ubWFuaWZlc3Q/LnZlcnNpb24gfHwgJzAnO1xyXG5cdFx0Y29uc3QgaXNMZWdhY3kgPSB2ZXJzaW9uLnN0YXJ0c1dpdGgoJzAnKTtcclxuXHRcdFxyXG5cdFx0aWYgKGlzTGVnYWN5KSB7XHJcblx0XHRcdC8vIExlZ2FjeSBwZXJpb2RpYyBub3Rlc1xyXG5cdFx0XHRjb25zdCBwZXJpb2RNYXA6IFBhcnRpYWw8UmVjb3JkPEhvbWVCYXNlVHlwZSwgc3RyaW5nPj4gPSB7XHJcblx0XHRcdFx0W0hvbWVCYXNlVHlwZS5XZWVrbHlOb3RlXTogJ3dlZWtseScsXHJcblx0XHRcdFx0W0hvbWVCYXNlVHlwZS5Nb250aGx5Tm90ZV06ICdtb250aGx5JyxcclxuXHRcdFx0XHRbSG9tZUJhc2VUeXBlLlllYXJseU5vdGVdOiAneWVhcmx5JyxcclxuXHRcdFx0fTtcclxuXHRcdFx0IFxyXG5cdFx0XHRjb25zdCBhZGplY3RpdmUgPSBwZXJpb2RNYXBbdHlwZV07XHJcblx0XHRcdGlmICghYWRqZWN0aXZlKSByZXR1cm4gZmFsc2U7XHJcblx0XHRcdCBcclxuXHRcdFx0cmV0dXJuIChwZXJpb2RpY05vdGVzIGFzIHsgc2V0dGluZ3M/OiBSZWNvcmQ8c3RyaW5nLCB7IGVuYWJsZWQ/OiBib29sZWFuIH0+IH0pPy5zZXR0aW5ncz8uW2FkamVjdGl2ZV0/LmVuYWJsZWQgPT09IHRydWU7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBOZXcgcGVyaW9kaWMgbm90ZXNcclxuXHRcdFx0Y29uc3Qgbm91bk1hcDogUGFydGlhbDxSZWNvcmQ8SG9tZUJhc2VUeXBlLCBzdHJpbmc+PiA9IHtcclxuXHRcdFx0XHRbSG9tZUJhc2VUeXBlLldlZWtseU5vdGVdOiAnd2VlaycsXHJcblx0XHRcdFx0W0hvbWVCYXNlVHlwZS5Nb250aGx5Tm90ZV06ICdtb250aCcsXHJcblx0XHRcdFx0W0hvbWVCYXNlVHlwZS5ZZWFybHlOb3RlXTogJ3llYXInLFxyXG5cdFx0XHR9O1xyXG5cdFx0XHQgXHJcblx0XHRcdGNvbnN0IG5vdW4gPSBub3VuTWFwW3R5cGVdO1xyXG5cdFx0XHRpZiAoIW5vdW4pIHJldHVybiBmYWxzZTtcclxuXHRcdFx0IFxyXG5cdFx0XHRjb25zdCBjYWxlbmRhclNldCA9IChwZXJpb2RpY05vdGVzIGFzIHsgY2FsZW5kYXJTZXRNYW5hZ2VyPzogeyBnZXRBY3RpdmVTZXQ/OiAoKSA9PiBSZWNvcmQ8c3RyaW5nLCB7IGVuYWJsZWQ/OiBib29sZWFuIH0+IH0gfSk/LmNhbGVuZGFyU2V0TWFuYWdlcj8uZ2V0QWN0aXZlU2V0Py4oKTtcclxuXHRcdFx0IFxyXG5cdFx0XHRyZXR1cm4gY2FsZW5kYXJTZXQ/Lltub3VuXT8uZW5hYmxlZCA9PT0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIFVSTCBwYXJhbXMgaW5kaWNhdGUgYSBmaWxlL3dvcmtzcGFjZSBzaG91bGQgYmUgb3BlbmVkIChza2lwIGhvbWVwYWdlKVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgYXN5bmMgaGFzVXJsUGFyYW1zKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG5cdFx0Ly8gQ2hlY2sgZm9yIFVSTCBwYXJhbXMgdGhhdCBpbmRpY2F0ZSBhIHNwZWNpZmljIGZpbGUvd29ya3NwYWNlIHNob3VsZCBiZSBvcGVuZWRcclxuXHRcdC8vIFRoaXMgcHJldmVudHMgaG9tZXBhZ2UgZnJvbSBvcGVuaW5nIHdoZW4gT2JzaWRpYW4gaXMgb3BlbmVkIHdpdGggYSBzcGVjaWZpYyBmaWxlXHJcblx0XHRpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk9CU19BQ1QpIHtcclxuXHRcdFx0Y29uc3QgcGFyYW1zID0gT2JqZWN0LmtleXMod2luZG93Lk9CU19BQ1QpO1xyXG5cdFx0XHRjb25zdCBhY3Rpb24gPSB3aW5kb3cuT0JTX0FDVC5hY3Rpb247XHJcblx0XHRcdHJldHVybiAoXHJcblx0XHRcdFx0YWN0aW9uICE9PSB1bmRlZmluZWQgJiZcclxuXHRcdFx0XHRbJ29wZW4nLCAnYWR2YW5jZWQtdXJpJ10uaW5jbHVkZXMoYWN0aW9uKSAmJlxyXG5cdFx0XHRcdFsnZmlsZScsICdmaWxlcGF0aCcsICd3b3Jrc3BhY2UnXS5zb21lKGUgPT4gcGFyYW1zLmluY2x1ZGVzKGUpKVxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSGFuZGxlIFwib3BlbiB3aGVuIGVtcHR5XCIgZmVhdHVyZVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgaGFuZGxlT3BlbldoZW5FbXB0eSgpOiB2b2lkIHtcclxuXHRcdC8vIENoZWNrIGlmIGFjdGl2ZSB2aWV3IGlzIGVtcHR5IGFuZCBvbmx5IG9uZSB0YWIgZXhpc3RzXHJcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoVmlldyk7XHJcblx0XHRpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpICE9PSAnZW1wdHknKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDb3VudCB0YWJzIGluIG1haW4gd29ya3NwYWNlXHJcblx0XHRjb25zdCBtYWluTGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZW1wdHknKVxyXG5cdFx0XHQuY29uY2F0KHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJykpXHJcblx0XHRcdC5jb25jYXQodGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnY2FudmFzJykpXHJcblx0XHRcdC5jb25jYXQodGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnYmFzZXMnKSk7XHJcblxyXG5cdFx0Ly8gT25seSBvcGVuIGlmIHRoZXJlJ3MgZXhhY3RseSBvbmUgdGFiXHJcblx0XHRpZiAobWFpbkxlYXZlcy5sZW5ndGggPT09IDEpIHtcclxuXHRcdFx0dm9pZCB0aGlzLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZVdpdGhNb2RlKCdyZXRhaW4nLCB0cnVlKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBIb21lIEJhc2UgUGx1Z2luIFNldHRpbmdzXHJcbiAqL1xyXG5cclxuZXhwb3J0IHR5cGUgVmlld01vZGUgPSAnZGVmYXVsdCcgfCAncHJldmlldycgfCAnc291cmNlJyB8ICdsaXZlJztcclxuZXhwb3J0IHR5cGUgTmV3VGFiTW9kZSA9ICdvbmx5LXdoZW4tZW1wdHknIHwgJ2Fsd2F5cyc7XHJcbmV4cG9ydCB0eXBlIE9wZW5pbmdNb2RlID0gJ3JlcGxhY2UtYWxsJyB8ICdyZXBsYWNlLWxhc3QnIHwgJ3JldGFpbic7XHJcblxyXG4vKipcclxuICogSG9tZXBhZ2UgdHlwZSBlbnVtIC0gbWF0Y2hlcyBob21lcGFnZSBwbHVnaW4ncyBLaW5kIGVudW1cclxuICovXHJcbmV4cG9ydCBlbnVtIEhvbWVCYXNlVHlwZSB7XHJcblx0RmlsZSA9ICdGaWxlJyxcclxuXHRXb3Jrc3BhY2UgPSAnV29ya3NwYWNlJyxcclxuXHRSYW5kb20gPSAnUmFuZG9tIGZpbGUnLFxyXG5cdFJhbmRvbUZvbGRlciA9ICdSYW5kb20gaW4gZm9sZGVyJyxcclxuXHRHcmFwaCA9ICdHcmFwaCB2aWV3JyxcclxuXHROb25lID0gJ05vdGhpbmcnLFxyXG5cdEpvdXJuYWwgPSAnSm91cm5hbCcsXHJcblx0RGFpbHlOb3RlID0gJ0RhaWx5IE5vdGUnLFxyXG5cdFdlZWtseU5vdGUgPSAnV2Vla2x5IE5vdGUnLFxyXG5cdE1vbnRobHlOb3RlID0gJ01vbnRobHkgTm90ZScsXHJcblx0WWVhcmx5Tm90ZSA9ICdZZWFybHkgTm90ZScsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSG9tZUJhc2VTZXR0aW5ncyB7XHJcblx0Ly8gR2VuZXJhbFxyXG5cdGhvbWVCYXNlUGF0aDogc3RyaW5nOyAvLyBMZWdhY3kgLSBrZXB0IGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcblx0aG9tZUJhc2VUeXBlOiBIb21lQmFzZVR5cGU7XHJcblx0aG9tZUJhc2VWYWx1ZTogc3RyaW5nOyAvLyBUeXBlLXNwZWNpZmljIHZhbHVlIChmaWxlIHBhdGgsIHdvcmtzcGFjZSBuYW1lLCBmb2xkZXIgcGF0aCwgZXRjLilcclxuXHRvcGVuT25TdGFydHVwOiBib29sZWFuO1xyXG5cdG9wZW5XaGVuRW1wdHk6IGJvb2xlYW47XHJcblx0b3BlblZpZXdNb2RlOiBWaWV3TW9kZTtcclxuXHRvcGVuTW9kZTogT3BlbmluZ01vZGU7XHJcblx0bWFudWFsT3Blbk1vZGU6IE9wZW5pbmdNb2RlO1xyXG5cclxuXHQvLyBUYWIgQmVoYXZpb3JcclxuXHRyZXBsYWNlTmV3VGFiOiBib29sZWFuO1xyXG5cdG5ld1RhYk1vZGU6IE5ld1RhYk1vZGU7XHJcblx0a2VlcEV4aXN0aW5nVGFiczogYm9vbGVhbjsgLy8gTGVnYWN5IC0gbWFwcyB0byBvcGVuTW9kZTogJ3JlcGxhY2UtYWxsJyB2cyAncmV0YWluJ1xyXG5cclxuXHQvLyBVSSBGZWF0dXJlcyAob2ZmIGJ5IGRlZmF1bHQpXHJcblx0c2hvd1N0aWNreUhvbWVJY29uOiBib29sZWFuO1xyXG5cdHN0aWNreUljb25OYW1lOiBzdHJpbmcgfCBudWxsO1xyXG5cdGhpZGVIb21lVGFiSGVhZGVyOiBib29sZWFuO1xyXG5cdHJlcGxhY2VNb2JpbGVOZXdUYWI6IGJvb2xlYW47XHJcblx0XHJcblx0Ly8gTW9iaWxlXHJcblx0c2VwYXJhdGVNb2JpbGU6IGJvb2xlYW47XHJcblx0bW9iaWxlSG9tZUJhc2VQYXRoOiBzdHJpbmc7IC8vIExlZ2FjeVxyXG5cdG1vYmlsZUhvbWVCYXNlVHlwZTogSG9tZUJhc2VUeXBlO1xyXG5cdG1vYmlsZUhvbWVCYXNlVmFsdWU6IHN0cmluZztcclxuXHJcblx0Ly8gQXV0b21hdGlvblxyXG5cdGNvbW1hbmRPbk9wZW46IHN0cmluZztcclxuXHRcclxuXHQvLyBWaWV3IGJlaGF2aW9yXHJcblx0cmV2ZXJ0VmlldzogYm9vbGVhbjtcclxuXHRhdXRvU2Nyb2xsOiBib29sZWFuO1xyXG5cdGhpZGVSZWxlYXNlTm90ZXM6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBIb21lQmFzZVNldHRpbmdzID0ge1xyXG5cdC8vIEdlbmVyYWxcclxuXHRob21lQmFzZVBhdGg6ICcnLCAvLyBMZWdhY3lcclxuXHRob21lQmFzZVR5cGU6IEhvbWVCYXNlVHlwZS5GaWxlLFxyXG5cdGhvbWVCYXNlVmFsdWU6ICcnLFxyXG5cdG9wZW5PblN0YXJ0dXA6IHRydWUsXHJcblx0b3BlbldoZW5FbXB0eTogZmFsc2UsXHJcblx0b3BlblZpZXdNb2RlOiAnZGVmYXVsdCcsXHJcblx0b3Blbk1vZGU6ICdyZXBsYWNlLWFsbCcsXHJcblx0bWFudWFsT3Blbk1vZGU6ICdyZXRhaW4nLFxyXG5cclxuXHQvLyBUYWIgQmVoYXZpb3JcclxuXHRyZXBsYWNlTmV3VGFiOiBmYWxzZSxcclxuXHRuZXdUYWJNb2RlOiAnb25seS13aGVuLWVtcHR5JyxcclxuXHRrZWVwRXhpc3RpbmdUYWJzOiB0cnVlLFxyXG5cclxuXHQvLyBVSSBGZWF0dXJlc1xyXG5cdHNob3dTdGlja3lIb21lSWNvbjogZmFsc2UsXHJcblx0c3RpY2t5SWNvbk5hbWU6ICdob21lJyxcclxuXHRoaWRlSG9tZVRhYkhlYWRlcjogZmFsc2UsXHJcblx0cmVwbGFjZU1vYmlsZU5ld1RhYjogZmFsc2UsXHJcblx0XHJcblx0Ly8gTW9iaWxlXHJcblx0c2VwYXJhdGVNb2JpbGU6IGZhbHNlLFxyXG5cdG1vYmlsZUhvbWVCYXNlUGF0aDogJycsIC8vIExlZ2FjeVxyXG5cdG1vYmlsZUhvbWVCYXNlVHlwZTogSG9tZUJhc2VUeXBlLkZpbGUsXHJcblx0bW9iaWxlSG9tZUJhc2VWYWx1ZTogJycsXHJcblxyXG5cdC8vIEF1dG9tYXRpb25cclxuXHRjb21tYW5kT25PcGVuOiAnJyxcclxuXHRcclxuXHQvLyBWaWV3IGJlaGF2aW9yXHJcblx0cmV2ZXJ0VmlldzogZmFsc2UsXHJcblx0YXV0b1Njcm9sbDogZmFsc2UsXHJcblx0aGlkZVJlbGVhc2VOb3RlczogZmFsc2UsIC8vIE9GRiBieSBkZWZhdWx0XHJcbn07XHJcblxyXG4vKipcclxuICogVmlldyBtb2RlIGRpc3BsYXkgbmFtZXMgZm9yIHNldHRpbmdzIGRyb3Bkb3duXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVklFV19NT0RFX09QVElPTlM6IFJlY29yZDxWaWV3TW9kZSwgc3RyaW5nPiA9IHtcclxuXHQnZGVmYXVsdCc6ICdEZWZhdWx0JyxcclxuXHQncHJldmlldyc6ICdSZWFkaW5nIHZpZXcnLFxyXG5cdCdzb3VyY2UnOiAnU291cmNlIG1vZGUnLFxyXG5cdCdsaXZlJzogJ0xpdmUgUHJldmlldycsXHJcbn07XHJcblxyXG4vKipcclxuICogTmV3IHRhYiBtb2RlIGRpc3BsYXkgbmFtZXMgZm9yIHNldHRpbmdzIGRyb3Bkb3duXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgTkVXX1RBQl9NT0RFX09QVElPTlM6IFJlY29yZDxOZXdUYWJNb2RlLCBzdHJpbmc+ID0ge1xyXG5cdCdvbmx5LXdoZW4tZW1wdHknOiAnT25seSB3aGVuIG5vIHRhYnMgYXJlIG9wZW4nLFxyXG5cdCdhbHdheXMnOiAnQWx3YXlzIHJlcGxhY2UgbmV3IHRhYnMnLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9wZW5pbmcgbW9kZSBkaXNwbGF5IG5hbWVzIGZvciBzZXR0aW5ncyBkcm9wZG93blxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IE9QRU5JTkdfTU9ERV9PUFRJT05TOiBSZWNvcmQ8T3BlbmluZ01vZGUsIHN0cmluZz4gPSB7XHJcblx0J3JlcGxhY2UtYWxsJzogJ1JlcGxhY2UgYWxsIG9wZW4gbm90ZXMnLFxyXG5cdCdyZXBsYWNlLWxhc3QnOiAnUmVwbGFjZSBsYXN0IG5vdGUnLFxyXG5cdCdyZXRhaW4nOiAnS2VlcCBvcGVuIG5vdGVzJyxcclxufTtcclxuXHJcbi8qKlxyXG4gKiBIb21lcGFnZSB0eXBlcyB0aGF0IGRvbid0IHJlcXVpcmUgYSB2YWx1ZSBpbnB1dFxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFVOQ0hBTkdFQUJMRV9UWVBFUzogSG9tZUJhc2VUeXBlW10gPSBbXHJcblx0SG9tZUJhc2VUeXBlLlJhbmRvbSxcclxuXHRIb21lQmFzZVR5cGUuR3JhcGgsXHJcblx0SG9tZUJhc2VUeXBlLk5vbmUsXHJcblx0SG9tZUJhc2VUeXBlLkRhaWx5Tm90ZSxcclxuXHRIb21lQmFzZVR5cGUuV2Vla2x5Tm90ZSxcclxuXHRIb21lQmFzZVR5cGUuTW9udGhseU5vdGUsXHJcblx0SG9tZUJhc2VUeXBlLlllYXJseU5vdGUsXHJcbl07XHJcbiIsICIvKipcclxuICogSG9tZSBCYXNlIFNldHRpbmdzIFRhYlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHR5cGUgSG9tZUJhc2VQbHVnaW4gZnJvbSAnLi4vbWFpbic7XHJcbmltcG9ydCB7IFxyXG5cdFZJRVdfTU9ERV9PUFRJT05TLCBcclxuXHRORVdfVEFCX01PREVfT1BUSU9OUywgXHJcblx0T1BFTklOR19NT0RFX09QVElPTlMsXHJcblx0Vmlld01vZGUsIFxyXG5cdE5ld1RhYk1vZGUsXHJcblx0T3BlbmluZ01vZGUsXHJcblx0SG9tZUJhc2VUeXBlLFxyXG5cdFVOQ0hBTkdFQUJMRV9UWVBFUyxcclxufSBmcm9tICcuLi9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IGNyZWF0ZVNldHRpbmdzR3JvdXAgfSBmcm9tICcuLi91dGlscy9zZXR0aW5ncy1jb21wYXQnO1xyXG5pbXBvcnQgeyBGaWxlUGF0aFN1Z2dlc3QsIEZvbGRlclN1Z2dlc3QsIFdvcmtzcGFjZVN1Z2dlc3QgfSBmcm9tICcuL2ZpbGUtc3VnZ2VzdCc7XHJcbmltcG9ydCB7IENvbW1hbmRTdWdnZXN0LCBnZXRDb21tYW5kQnlJZCB9IGZyb20gJy4vY29tbWFuZC1zdWdnZXN0JztcclxuaW1wb3J0IHsgSWNvblBpY2tlciB9IGZyb20gJy4vaWNvbi1waWNrZXInO1xyXG5cclxuZXhwb3J0IGNsYXNzIEhvbWVCYXNlU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogSG9tZUJhc2VQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEhvbWVCYXNlUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcblx0XHQvLyBHZXQgYWN0aXZlIHNldHRpbmdzIChtb2JpbGUgb3IgZGVza3RvcClcclxuXHRcdGNvbnN0IGlzTW9iaWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VwYXJhdGVNb2JpbGU7XHJcblx0XHRjb25zdCBhY3RpdmVUeXBlID0gaXNNb2JpbGUgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVR5cGUgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ob21lQmFzZVR5cGU7XHJcblx0XHRjb25zdCBhY3RpdmVWYWx1ZSA9IGlzTW9iaWxlID8gdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VWYWx1ZSA6IHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlVmFsdWU7XHJcblxyXG5cdFx0Ly8gR2VuZXJhbCBTZXR0aW5ncyAobm8gaGVhZGluZyBmb3IgZmlyc3QgZ3JvdXApXHJcblx0XHRjb25zdCBnZW5lcmFsR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsKTtcclxuXHJcblx0XHQvLyBIb21lcGFnZSB0eXBlIGRyb3Bkb3duXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ0hvbWVwYWdlJylcclxuXHRcdFx0XHQuc2V0RGVzYygnV2hhdCB0byBvcGVuIGFzIHlvdXIgaG9tZSBiYXNlJylcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcblx0XHRcdFx0XHRsZXQgcGx1Z2luRGlzYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCB0eXBlIG9mIE9iamVjdC52YWx1ZXMoSG9tZUJhc2VUeXBlKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMucGx1Z2luLmhhc1JlcXVpcmVkUGx1Z2luKHR5cGUpKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gSWYgY3VycmVudCB0eXBlIGlzIGRpc2FibGVkLCBtYXJrIGl0IGJ1dCBzdGlsbCBhbGxvdyBpdFxyXG5cdFx0XHRcdFx0XHRcdGlmICh0eXBlID09PSBhY3RpdmVUeXBlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRwbHVnaW5EaXNhYmxlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24odHlwZSwgdHlwZSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIEFkZCBkaXNhYmxlZCBvcHRpb25cclxuXHRcdFx0XHRcdFx0XHRcdGRyb3Bkb3duLnNlbGVjdEVsLmNyZWF0ZUVsKCdvcHRpb24nLCB7IFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR0ZXh0OiB0eXBlLCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0YXR0cjogeyBkaXNhYmxlZDogJ3RydWUnIH0gXHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24odHlwZSwgdHlwZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGFjdGl2ZVR5cGUgfHwgSG9tZUJhc2VUeXBlLkZpbGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXNNb2JpbGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlVHlwZSA9IHZhbHVlIGFzIEhvbWVCYXNlVHlwZTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuaG9tZUJhc2VUeXBlID0gdmFsdWUgYXMgSG9tZUJhc2VUeXBlO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdy9oaWRlIHZhbHVlIGlucHV0XHJcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyRWwuY2xvc2VzdCgnLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmVyRWwuY2xvc2VzdCgnLnNldHRpbmdzLWNvbnRlbnQnKSB8fCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250YWluZXJFbC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lcj8uc2Nyb2xsVG9wIHx8IDA7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChzY3JvbGxDb250YWluZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIFNob3cgd2FybmluZyBpZiBjdXJyZW50IHR5cGUgcmVxdWlyZXMgYSBkaXNhYmxlZCBwbHVnaW5cclxuXHRcdFx0XHRcdGlmIChwbHVnaW5EaXNhYmxlZCkge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5nLmRlc2NFbC5jcmVhdGVEaXYoe1xyXG5cdFx0XHRcdFx0XHRcdHRleHQ6ICdUaGUgcGx1Z2luIHJlcXVpcmVkIGZvciB0aGlzIGhvbWVwYWdlIHR5cGUgaXNuXFwndCBhdmFpbGFibGUuJyxcclxuXHRcdFx0XHRcdFx0XHRjbHM6ICdtb2Qtd2FybmluZydcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBWYWx1ZSBpbnB1dCAoY29uZGl0aW9uYWwgb24gdHlwZSlcclxuXHRcdGlmICghVU5DSEFOR0VBQkxFX1RZUEVTLmluY2x1ZGVzKGFjdGl2ZVR5cGUpKSB7XHJcblx0XHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0bGV0IGRlc2MgPSAnJztcclxuXHRcdFx0XHRsZXQgcGxhY2Vob2xkZXIgPSAnJztcclxuXHJcblx0XHRcdFx0aWYgKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlKSB7XHJcblx0XHRcdFx0XHRkZXNjID0gJ1RoZSBmaWxlIHRvIG9wZW4gYXMgeW91ciBob21lIGJhc2UgKHN1cHBvcnRzIC5tZCwgLm1keCwgLmNhbnZhcywgLmJhc2UpJztcclxuXHRcdFx0XHRcdHBsYWNlaG9sZGVyID0gJ1BhdGggdG8gaG9tZSBiYXNlIGZpbGUnO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoYWN0aXZlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLldvcmtzcGFjZSkge1xyXG5cdFx0XHRcdFx0ZGVzYyA9ICdUaGUgd29ya3NwYWNlIHRvIGxvYWQgYXMgeW91ciBob21lIGJhc2UnO1xyXG5cdFx0XHRcdFx0cGxhY2Vob2xkZXIgPSAnV29ya3NwYWNlIG5hbWUnO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoYWN0aXZlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLlJhbmRvbUZvbGRlcikge1xyXG5cdFx0XHRcdFx0ZGVzYyA9ICdUaGUgZm9sZGVyIHRvIHBpY2sgYSByYW5kb20gZmlsZSBmcm9tJztcclxuXHRcdFx0XHRcdHBsYWNlaG9sZGVyID0gJ0ZvbGRlciBwYXRoJztcclxuXHRcdFx0XHR9IGVsc2UgaWYgKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Kb3VybmFsKSB7XHJcblx0XHRcdFx0XHRkZXNjID0gJ1RoZSBqb3VybmFsIG5hbWUnO1xyXG5cdFx0XHRcdFx0cGxhY2Vob2xkZXIgPSAnSm91cm5hbCBuYW1lJztcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlID8gJ0ZpbGUnIDogXHJcblx0XHRcdFx0XHRcdFx0YWN0aXZlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLldvcmtzcGFjZSA/ICdXb3Jrc3BhY2UnIDpcclxuXHRcdFx0XHRcdFx0XHRhY3RpdmVUeXBlID09PSBIb21lQmFzZVR5cGUuUmFuZG9tRm9sZGVyID8gJ0ZvbGRlcicgOlxyXG5cdFx0XHRcdFx0XHRcdGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Kb3VybmFsID8gJ0pvdXJuYWwnIDogJ1ZhbHVlJylcclxuXHRcdFx0XHRcdC5zZXREZXNjKGRlc2MpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0XHQvLyBBZGQgYXBwcm9wcmlhdGUgc3VnZ2VzdGVyXHJcblx0XHRcdFx0XHRcdGlmIChhY3RpdmVUeXBlID09PSBIb21lQmFzZVR5cGUuRmlsZSkge1xyXG5cdFx0XHRcdFx0XHRcdG5ldyBGaWxlUGF0aFN1Z2dlc3QodGhpcy5hcHAsIHRleHQuaW5wdXRFbCk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoYWN0aXZlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLldvcmtzcGFjZSkge1xyXG5cdFx0XHRcdFx0XHRcdG5ldyBXb3Jrc3BhY2VTdWdnZXN0KHRoaXMuYXBwLCB0ZXh0LmlucHV0RWwpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5SYW5kb21Gb2xkZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRuZXcgRm9sZGVyU3VnZ2VzdCh0aGlzLmFwcCwgdGV4dC5pbnB1dEVsKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihwbGFjZWhvbGRlcilcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoYWN0aXZlVmFsdWUgfHwgJycpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzTW9iaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlVmFsdWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gQWxzbyB1cGRhdGUgbGVnYWN5IHBhdGggZm9yIGNvbXBhdGliaWxpdHlcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlVmFsdWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gQWxzbyB1cGRhdGUgbGVnYWN5IHBhdGggZm9yIGNvbXBhdGliaWxpdHlcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGFjdGl2ZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuaG9tZUJhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnT3BlbiBvbiBzdGFydHVwJylcclxuXHRcdFx0XHQuc2V0RGVzYygnT3BlbiB0aGUgaG9tZSBiYXNlIHdoZW4gbGF1bmNoaW5nIE9ic2lkaWFuJylcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk9uU3RhcnR1cClcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5PblN0YXJ0dXAgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ09wZW4gd2hlbiBlbXB0eScpXHJcblx0XHRcdFx0LnNldERlc2MoJ09wZW4gdGhlIGhvbWUgYmFzZSB3aGVuIHRoZXJlXFwncyBvbmx5IG9uZSBlbXB0eSB0YWInKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuV2hlbkVtcHR5KVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbldoZW5FbXB0eSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnT3BlbmluZyBtb2RlIChzdGFydHVwKScpXHJcblx0XHRcdFx0LnNldERlc2MoJ0hvdyB0byBoYW5kbGUgZXhpc3RpbmcgdGFicyB3aGVuIG9wZW5pbmcgb24gc3RhcnR1cCcpXHJcblx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBbdmFsdWUsIGxhYmVsXSBvZiBPYmplY3QuZW50cmllcyhPUEVOSU5HX01PREVfT1BUSU9OUykpIHtcclxuXHRcdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHZhbHVlLCBsYWJlbCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk1vZGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuTW9kZSA9IHZhbHVlIGFzIE9wZW5pbmdNb2RlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnT3BlbmluZyBtb2RlIChtYW51YWwpJylcclxuXHRcdFx0XHQuc2V0RGVzYygnSG93IHRvIGhhbmRsZSBleGlzdGluZyB0YWJzIHdoZW4gb3BlbmluZyBtYW51YWxseScpXHJcblx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBbdmFsdWUsIGxhYmVsXSBvZiBPYmplY3QuZW50cmllcyhPUEVOSU5HX01PREVfT1BUSU9OUykpIHtcclxuXHRcdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHZhbHVlLCBsYWJlbCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWFudWFsT3Blbk1vZGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYW51YWxPcGVuTW9kZSA9IHZhbHVlIGFzIE9wZW5pbmdNb2RlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnVmlldyBtb2RlJylcclxuXHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb2JzaWRpYW5tZC91aS9zZW50ZW5jZS1jYXNlXHJcblx0XHRcdFx0LnNldERlc2MoJ0hvdyB0byBvcGVuIG1hcmtkb3duIGFuZCBNRFggZmlsZXMgKGNhbnZhcy9iYXNlIHVzZSBuYXRpdmUgdmlld3MpJylcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcblx0XHRcdFx0XHRmb3IgKGNvbnN0IFt2YWx1ZSwgbGFiZWxdIG9mIE9iamVjdC5lbnRyaWVzKFZJRVdfTU9ERV9PUFRJT05TKSkge1xyXG5cdFx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24odmFsdWUsIGxhYmVsKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRyb3Bkb3duXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuVmlld01vZGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuVmlld01vZGUgPSB2YWx1ZSBhcyBWaWV3TW9kZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ1JldmVydCB2aWV3IG9uIGNsb3NlJylcclxuXHRcdFx0XHQuc2V0RGVzYygnV2hlbiBuYXZpZ2F0aW5nIGF3YXkgZnJvbSB0aGUgaG9tZSBiYXNlLCByZXN0b3JlIHRoZSBkZWZhdWx0IHZpZXcnKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXZlcnRWaWV3KVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucmV2ZXJ0VmlldyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnQXV0by1zY3JvbGwnKVxyXG5cdFx0XHRcdC5zZXREZXNjKCdXaGVuIG9wZW5pbmcgdGhlIGhvbWUgYmFzZSwgc2Nyb2xsIHRvIHRoZSBib3R0b20gYW5kIGZvY3VzIG9uIHRoZSBsYXN0IGxpbmUnKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvU2Nyb2xsKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1Njcm9sbCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnSGlkZSByZWxlYXNlIG5vdGVzJylcclxuXHRcdFx0XHQuc2V0RGVzYygnTmV2ZXIgZGlzcGxheSByZWxlYXNlIG5vdGVzIHdoZW4gT2JzaWRpYW4gdXBkYXRlcycpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVSZWxlYXNlTm90ZXMpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlUmVsZWFzZU5vdGVzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVGFiIEJlaGF2aW9yIFNldHRpbmdzXHJcblx0XHRjb25zdCB0YWJHcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsICdUYWIgQmVoYXZpb3InKTtcclxuXHJcblx0XHR0YWJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZSgnUmVwbGFjZSBuZXcgdGFicycpXHJcblx0XHRcdFx0LnNldERlc2MoJ09wZW4gaG9tZSBiYXNlIGluc3RlYWQgb2YgbmV3IGVtcHR5IHRhYnMnKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBsYWNlTmV3VGFiKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucmVwbGFjZU5ld1RhYiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdC8vIFByZXNlcnZlIHNjcm9sbCBwb3NpdGlvbiBiZWZvcmUgcmUtcmVuZGVyaW5nXHJcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyRWwuY2xvc2VzdCgnLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmVyRWwuY2xvc2VzdCgnLnNldHRpbmdzLWNvbnRlbnQnKSB8fCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250YWluZXJFbC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lcj8uc2Nyb2xsVG9wIHx8IDA7XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7IC8vIFJlLXJlbmRlciB0byBzaG93L2hpZGUgZGVwZW5kZW50IHNldHRpbmdcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHQvLyBSZXN0b3JlIHNjcm9sbCBwb3NpdGlvbiBhZnRlciByZW5kZXJpbmdcclxuXHRcdFx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHNjcm9sbENvbnRhaW5lcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIE9ubHkgc2hvdyBuZXcgdGFiIG1vZGUgaWYgcmVwbGFjZSBuZXcgdGFiIGlzIGVuYWJsZWRcclxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBsYWNlTmV3VGFiKSB7XHJcblx0XHRcdHRhYkdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZSgnTmV3IHRhYiByZXBsYWNlbWVudCBtb2RlJylcclxuXHRcdFx0XHRcdC5zZXREZXNjKCdXaGVuIHRvIHJlcGxhY2UgbmV3IHRhYnMgd2l0aCBob21lIGJhc2UnKVxyXG5cdFx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG5cdFx0XHRcdFx0XHRmb3IgKGNvbnN0IFt2YWx1ZSwgbGFiZWxdIG9mIE9iamVjdC5lbnRyaWVzKE5FV19UQUJfTU9ERV9PUFRJT05TKSkge1xyXG5cdFx0XHRcdFx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbih2YWx1ZSwgbGFiZWwpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGRyb3Bkb3duXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld1RhYk1vZGUpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3VGFiTW9kZSA9IHZhbHVlIGFzIE5ld1RhYk1vZGU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBMZWdhY3kgXCJLZWVwIGV4aXN0aW5nIHRhYnNcIiAtIGtlcHQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgYnV0IGhpZGRlblxyXG5cdFx0Ly8gKGZ1bmN0aW9uYWxpdHkgbm93IGhhbmRsZWQgYnkgXCJPcGVuaW5nIG1vZGUgKHN0YXJ0dXApXCIpXHJcblxyXG5cdFx0Ly8gVUkgRmVhdHVyZXMgU2V0dGluZ3NcclxuXHRcdGNvbnN0IHVpR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCAnVUkgRmVhdHVyZXMnKTtcclxuXHJcblx0XHR1aUdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKCdTdGlja3kgaG9tZSBpY29uJylcclxuXHRcdFx0XHQuc2V0RGVzYygnU2hvdyBhIGhvbWUgaWNvbiBpbiB0aGUgdGFiIGJhciB0aGF0IHN0YXlzIHBpbm5lZCB0byB0aGUgbGVmdCAoZGVza3RvcCBvbmx5KScpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdGlja3lIb21lSWNvbilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdGlja3lIb21lSWNvbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnVwZGF0ZVN0aWNreVRhYkljb24oKTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHQvLyBQcmVzZXJ2ZSBzY3JvbGwgcG9zaXRpb24gYmVmb3JlIHJlLXJlbmRlcmluZ1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNsb3Nlc3QoJy52ZXJ0aWNhbC10YWItY29udGVudCcpIHx8IFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnRhaW5lckVsLmNsb3Nlc3QoJy5zZXR0aW5ncy1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmVyRWwucGFyZW50RWxlbWVudDtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxDb250YWluZXI/LnNjcm9sbFRvcCB8fCAwO1xyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXIgdG8gc2hvdy9oaWRlIGRlcGVuZGVudCBzZXR0aW5nXHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmVzdG9yZSBzY3JvbGwgcG9zaXRpb24gYWZ0ZXIgcmVuZGVyaW5nXHJcblx0XHRcdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChzY3JvbGxDb250YWluZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBPbmx5IHNob3cgc3RpY2t5IGljb24gc2V0dGluZ3MgaWYgc3RpY2t5IGljb24gaXMgZW5hYmxlZFxyXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdGlja3lIb21lSWNvbikge1xyXG5cdFx0XHR1aUdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZSgnSWNvbicpXHJcblx0XHRcdFx0XHQuc2V0RGVzYygnVGhlIGljb24gdG8gZGlzcGxheSBpbiB0aGUgc3RpY2t5IGhvbWUgaWNvbicpXHJcblx0XHRcdFx0XHQuYWRkQnV0dG9uKChidXR0b24pID0+IHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgaWNvbk5hbWUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdGlja3lJY29uTmFtZSB8fCAnaG9tZSc7XHJcblx0XHRcdFx0XHRcdGJ1dHRvblxyXG5cdFx0XHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdDaGFuZ2UgaWNvbicpXHJcblx0XHRcdFx0XHRcdFx0LnNldEljb24oaWNvbk5hbWUpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcGlja2VyID0gbmV3IEljb25QaWNrZXIoXHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdGlja3lJY29uTmFtZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0KGljb246IHN0cmluZyB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdGlja3lJY29uTmFtZSA9IGljb247XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSB0aGUgaWNvbiBkaXNwbGF5XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zdGlja3lUYWJTZXJ2aWNlLnVwZGF0ZSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHNldHRpbmdzIHRvIHVwZGF0ZSBidXR0b24gaWNvblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0KTtcclxuXHRcdFx0XHRcdFx0XHRcdHBpY2tlci5vcGVuKCk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR1aUdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZSgnSGlkZSB0YWIgaGVhZGVyJylcclxuXHRcdFx0XHRcdC5zZXREZXNjKCdIaWRlIHRoZSBnaG9zdCB0YWIgaGVhZGVyIHdoZW4gaXRcXCdzIG9wZW4sIHVzaW5nIHRoZSBzdGlja3kgaWNvbiBhcyB0aGUgdGFiIGluZGljYXRvcicpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVIb21lVGFiSGVhZGVyKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVIb21lVGFiSGVhZGVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnN0aWNreVRhYlNlcnZpY2UudXBkYXRlVGFiSGVhZGVycygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHVpR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ1JlcGxhY2UgbW9iaWxlIG5ldyB0YWIgYnV0dG9uJylcclxuXHRcdFx0XHQuc2V0RGVzYygnQ2hhbmdlIHRoZSBtb2JpbGUgbmV3IHRhYiBidXR0b24gdG8gYSBob21lIGljb24nKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBsYWNlTW9iaWxlTmV3VGFiKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucmVwbGFjZU1vYmlsZU5ld1RhYiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnVwZGF0ZU1vYmlsZUJ1dHRvbigpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIE1vYmlsZSBTZXR0aW5nc1xyXG5cdFx0Y29uc3QgbW9iaWxlR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCAnTW9iaWxlJyk7XHJcblxyXG5cdFx0bW9iaWxlR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ1NlcGFyYXRlIG1vYmlsZSBob21lcGFnZScpXHJcblx0XHRcdFx0LnNldERlc2MoJ1VzZSBhIGRpZmZlcmVudCBob21lcGFnZSBvbiBtb2JpbGUgZGV2aWNlcycpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlcGFyYXRlTW9iaWxlKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VwYXJhdGVNb2JpbGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdyBtb2JpbGUgc2V0dGluZ3NcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBzY3JvbGxDb250YWluZXIgPSBjb250YWluZXJFbC5jbG9zZXN0KCcudmVydGljYWwtdGFiLWNvbnRlbnQnKSB8fCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250YWluZXJFbC5jbG9zZXN0KCcuc2V0dGluZ3MtY29udGVudCcpIHx8IFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnRhaW5lckVsLnBhcmVudEVsZW1lbnQ7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyPy5zY3JvbGxUb3AgfHwgMDtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHNjcm9sbENvbnRhaW5lcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFNob3cgbW9iaWxlLXNwZWNpZmljIHNldHRpbmdzIGlmIHNlcGFyYXRlIG1vYmlsZSBpcyBlbmFibGVkXHJcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VwYXJhdGVNb2JpbGUpIHtcclxuXHRcdFx0bW9iaWxlR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKCdNb2JpbGUgaG9tZXBhZ2UnKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoJ1doYXQgdG8gb3BlbiBhcyB5b3VyIGhvbWUgYmFzZSBvbiBtb2JpbGUnKVxyXG5cdFx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG5cdFx0XHRcdFx0XHRmb3IgKGNvbnN0IHR5cGUgb2YgT2JqZWN0LnZhbHVlcyhIb21lQmFzZVR5cGUpKSB7XHJcblx0XHRcdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHR5cGUsIHR5cGUpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGRyb3Bkb3duXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlVHlwZSB8fCBIb21lQmFzZVR5cGUuRmlsZSlcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVR5cGUgPSB2YWx1ZSBhcyBIb21lQmFzZVR5cGU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyRWwuY2xvc2VzdCgnLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250YWluZXJFbC5jbG9zZXN0KCcuc2V0dGluZ3MtY29udGVudCcpIHx8IFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmVyRWwucGFyZW50RWxlbWVudDtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lcj8uc2Nyb2xsVG9wIHx8IDA7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChzY3JvbGxDb250YWluZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmICghVU5DSEFOR0VBQkxFX1RZUEVTLmluY2x1ZGVzKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlVHlwZSkpIHtcclxuXHRcdFx0XHRtb2JpbGVHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCBtb2JpbGVUeXBlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlSG9tZUJhc2VUeXBlO1xyXG5cdFx0XHRcdFx0bGV0IGRlc2MgPSAnJztcclxuXHRcdFx0XHRcdGxldCBwbGFjZWhvbGRlciA9ICcnO1xyXG5cclxuXHRcdFx0XHRcdGlmIChtb2JpbGVUeXBlID09PSBIb21lQmFzZVR5cGUuRmlsZSkge1xyXG5cdFx0XHRcdFx0XHRkZXNjID0gJ1RoZSBmaWxlIHRvIG9wZW4gYXMgeW91ciBob21lIGJhc2Ugb24gbW9iaWxlJztcclxuXHRcdFx0XHRcdFx0cGxhY2Vob2xkZXIgPSAnUGF0aCB0byBob21lIGJhc2UgZmlsZSc7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG1vYmlsZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Xb3Jrc3BhY2UpIHtcclxuXHRcdFx0XHRcdFx0ZGVzYyA9ICdUaGUgd29ya3NwYWNlIHRvIGxvYWQgYXMgeW91ciBob21lIGJhc2Ugb24gbW9iaWxlJztcclxuXHRcdFx0XHRcdFx0cGxhY2Vob2xkZXIgPSAnV29ya3NwYWNlIG5hbWUnO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChtb2JpbGVUeXBlID09PSBIb21lQmFzZVR5cGUuUmFuZG9tRm9sZGVyKSB7XHJcblx0XHRcdFx0XHRcdGRlc2MgPSAnVGhlIGZvbGRlciB0byBwaWNrIGEgcmFuZG9tIGZpbGUgZnJvbSBvbiBtb2JpbGUnO1xyXG5cdFx0XHRcdFx0XHRwbGFjZWhvbGRlciA9ICdGb2xkZXIgcGF0aCc7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG1vYmlsZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Kb3VybmFsKSB7XHJcblx0XHRcdFx0XHRcdGRlc2MgPSAnVGhlIGpvdXJuYWwgbmFtZSBmb3IgbW9iaWxlJztcclxuXHRcdFx0XHRcdFx0cGxhY2Vob2xkZXIgPSAnSm91cm5hbCBuYW1lJztcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHRcdC5zZXROYW1lKG1vYmlsZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5GaWxlID8gJ01vYmlsZSBmaWxlJyA6IFxyXG5cdFx0XHRcdFx0XHRcdFx0bW9iaWxlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLldvcmtzcGFjZSA/ICdNb2JpbGUgd29ya3NwYWNlJyA6XHJcblx0XHRcdFx0XHRcdFx0XHRtb2JpbGVUeXBlID09PSBIb21lQmFzZVR5cGUuUmFuZG9tRm9sZGVyID8gJ01vYmlsZSBmb2xkZXInIDpcclxuXHRcdFx0XHRcdFx0XHRcdG1vYmlsZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Kb3VybmFsID8gJ01vYmlsZSBqb3VybmFsJyA6ICdNb2JpbGUgdmFsdWUnKVxyXG5cdFx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjKVxyXG5cdFx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChtb2JpbGVUeXBlID09PSBIb21lQmFzZVR5cGUuRmlsZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IEZpbGVQYXRoU3VnZ2VzdCh0aGlzLmFwcCwgdGV4dC5pbnB1dEVsKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG1vYmlsZVR5cGUgPT09IEhvbWVCYXNlVHlwZS5Xb3Jrc3BhY2UpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBXb3Jrc3BhY2VTdWdnZXN0KHRoaXMuYXBwLCB0ZXh0LmlucHV0RWwpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobW9iaWxlVHlwZSA9PT0gSG9tZUJhc2VUeXBlLlJhbmRvbUZvbGRlcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IEZvbGRlclN1Z2dlc3QodGhpcy5hcHAsIHRleHQuaW5wdXRFbCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihwbGFjZWhvbGRlcilcclxuXHRcdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVZhbHVlIHx8ICcnKVxyXG5cdFx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVIb21lQmFzZVZhbHVlID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChtb2JpbGVUeXBlID09PSBIb21lQmFzZVR5cGUuRmlsZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUhvbWVCYXNlUGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQXV0b21hdGlvbiBTZXR0aW5nc1xyXG5cdFx0Y29uc3QgYXV0b21hdGlvbkdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgJ0F1dG9tYXRpb24nKTtcclxuXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRjb25zdCBjb21tYW5kSWQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21tYW5kT25PcGVuO1xyXG5cdFx0XHRjb25zdCBjb21tYW5kID0gY29tbWFuZElkID8gZ2V0Q29tbWFuZEJ5SWQodGhpcy5hcHAsIGNvbW1hbmRJZCkgOiB1bmRlZmluZWQ7XHJcblx0XHRcdGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNvbW1hbmQgPyBjb21tYW5kLm5hbWUgOiBjb21tYW5kSWQ7XHJcblxyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoJ0NvbW1hbmQgb24gb3BlbicpXHJcblx0XHRcdFx0LnNldERlc2MoJ1J1biBhbiBPYnNpZGlhbiBjb21tYW5kIHdoZW4gb3BlbmluZyBob21lIGJhc2UnKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHQvLyBBZGQgY29tbWFuZCBzdWdnZXN0ZXJcclxuXHRcdFx0XHRcdG5ldyBDb21tYW5kU3VnZ2VzdCh0aGlzLmFwcCwgdGV4dC5pbnB1dEVsKTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ1NlYXJjaCBmb3IgYSBjb21tYW5kLi4uJylcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGRpc3BsYXlWYWx1ZSB8fCAnJylcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbW1hbmRPbk9wZW4gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuYWRkRXh0cmFCdXR0b24oKGJ0bikgPT4ge1xyXG5cdFx0XHRcdFx0YnRuXHJcblx0XHRcdFx0XHRcdC5zZXRJY29uKCd4JylcclxuXHRcdFx0XHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGNvbW1hbmQnKVxyXG5cdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY29tbWFuZE9uT3BlbiA9ICcnO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdC8vIFByZXNlcnZlIHNjcm9sbCBwb3NpdGlvbiBiZWZvcmUgcmUtcmVuZGVyaW5nXHJcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyRWwuY2xvc2VzdCgnLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmVyRWwuY2xvc2VzdCgnLnNldHRpbmdzLWNvbnRlbnQnKSB8fCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250YWluZXJFbC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lcj8uc2Nyb2xsVG9wIHx8IDA7XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmVzdG9yZSBzY3JvbGwgcG9zaXRpb24gYWZ0ZXIgcmVuZGVyaW5nXHJcblx0XHRcdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChzY3JvbGxDb250YWluZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBDb21wYXRpYmlsaXR5IHV0aWxpdGllcyBmb3Igc2V0dGluZ3NcclxuICogUHJvdmlkZXMgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBmb3IgU2V0dGluZ0dyb3VwIChyZXF1aXJlcyBBUEkgMS4xMS4wKylcclxuICovXHJcblxyXG5pbXBvcnQgeyBTZXR0aW5nLCByZXF1aXJlQXBpVmVyc2lvbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgT2JzaWRpYW5Nb2R1bGUgZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0aGF0IHdvcmtzIHdpdGggYm90aCBTZXR0aW5nR3JvdXAgYW5kIGZhbGxiYWNrIGNvbnRhaW5lclxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nc0NvbnRhaW5lciB7XHJcblx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHNldHRpbmdzIGNvbnRhaW5lciB0aGF0IHVzZXMgU2V0dGluZ0dyb3VwIGlmIGF2YWlsYWJsZSAoQVBJIDEuMTEuMCspLFxyXG4gKiBvdGhlcndpc2UgZmFsbHMgYmFjayB0byBjcmVhdGluZyBhIGhlYWRpbmcgYW5kIHVzaW5nIHRoZSBjb250YWluZXIgZGlyZWN0bHkuXHJcbiAqIFxyXG4gKiBVc2VzIHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSB0byBjaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlLlxyXG4gKiBUaGlzIGlzIHRoZSBvZmZpY2lhbCBPYnNpZGlhbiBBUEkgbWV0aG9kIGZvciB2ZXJzaW9uIGNoZWNraW5nLlxyXG4gKiBcclxuICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIGNvbnRhaW5lciBlbGVtZW50IGZvciBzZXR0aW5nc1xyXG4gKiBAcGFyYW0gaGVhZGluZyAtIFRoZSBoZWFkaW5nIHRleHQgZm9yIHRoZSBzZXR0aW5ncyBncm91cCAob3B0aW9uYWwpXHJcbiAqIEByZXR1cm5zIEEgY29udGFpbmVyIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWRkIHNldHRpbmdzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2V0dGluZ3NHcm91cChcclxuXHRjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXHJcblx0aGVhZGluZz86IHN0cmluZ1xyXG4pOiBTZXR0aW5nc0NvbnRhaW5lciB7XHJcblx0Ly8gQ2hlY2sgaWYgU2V0dGluZ0dyb3VwIGlzIGF2YWlsYWJsZSAoQVBJIDEuMTEuMCspXHJcblx0aWYgKHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSkge1xyXG5cdFx0Ly8gQWNjZXNzIFNldHRpbmdHcm91cCB2aWEgdHlwZSBhc3NlcnRpb24gc2luY2UgaXQgbWF5IG5vdCBiZSBpbiB0eXBlIGRlZmluaXRpb25zXHJcblx0XHRjb25zdCBTZXR0aW5nR3JvdXBDbGFzcyA9IChPYnNpZGlhbk1vZHVsZSBhcyB1bmtub3duIGFzIHsgU2V0dGluZ0dyb3VwPzogbmV3IChjb250YWluZXJFbDogSFRNTEVsZW1lbnQpID0+IHtcclxuXHRcdFx0c2V0SGVhZGluZyhoZWFkaW5nOiBzdHJpbmcpOiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcblx0XHR9IH0pLlNldHRpbmdHcm91cDtcclxuXHRcdFxyXG5cdFx0aWYgKFNldHRpbmdHcm91cENsYXNzKSB7XHJcblx0XHRcdGNvbnN0IGdyb3VwID0gaGVhZGluZyBcclxuXHRcdFx0XHQ/IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCkuc2V0SGVhZGluZyhoZWFkaW5nKVxyXG5cdFx0XHRcdDogbmV3IFNldHRpbmdHcm91cENsYXNzKGNvbnRhaW5lckVsKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCkge1xyXG5cdFx0XHRcdFx0Z3JvdXAuYWRkU2V0dGluZyhjYik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHQvLyBGYWxsYmFjayBwYXRoIChlaXRoZXIgQVBJIDwgMS4xMS4wIG9yIFNldHRpbmdHcm91cCBub3QgZm91bmQpXHJcblx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdGNvbnN0IGhlYWRpbmdFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignc2V0dGluZy1ncm91cC1oZWFkaW5nJyk7XHJcblx0XHRoZWFkaW5nRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiBoZWFkaW5nIH0pO1xyXG5cdH1cclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKTtcclxuXHRcdFx0Y2Ioc2V0dGluZyk7XHJcblx0XHR9XHJcblx0fTtcclxufVxyXG4iLCAiLyoqXHJcbiAqIEZpbGUgUGF0aCBTdWdnZXN0ZXIgQ29tcG9uZW50XHJcbiAqIFByb3ZpZGVzIGF1dG9jb21wbGV0ZSBmb3IgZmlsZSBwYXRocyBpbiBzZXR0aW5nc1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFic3RyYWN0SW5wdXRTdWdnZXN0LCBBcHAsIFRGaWxlLCBURm9sZGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIFN1cHBvcnRlZCBmaWxlIGV4dGVuc2lvbnMgZm9yIGhvbWUgYmFzZVxyXG4gKi9cclxuY29uc3QgU1VQUE9SVEVEX0VYVEVOU0lPTlMgPSBbJ21kJywgJ21keCcsICdjYW52YXMnLCAnYmFzZSddO1xyXG5cclxuLyoqXHJcbiAqIEZpbGUgcGF0aCBzdWdnZXN0ZXIgdGhhdCBwcm92aWRlcyBhdXRvY29tcGxldGUgZm9yIHZhdWx0IGZpbGVzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRmlsZVBhdGhTdWdnZXN0IGV4dGVuZHMgQWJzdHJhY3RJbnB1dFN1Z2dlc3Q8VEZpbGU+IHtcclxuXHRwcml2YXRlIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50KSB7XHJcblx0XHRzdXBlcihhcHAsIGlucHV0RWwpO1xyXG5cdFx0dGhpcy5pbnB1dEVsID0gaW5wdXRFbDtcclxuXHR9XHJcblxyXG5cdGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBURmlsZVtdIHtcclxuXHRcdGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0Y29uc3QgZmlsZXM6IFRGaWxlW10gPSBbXTtcclxuXHJcblx0XHQvLyBHZXQgYWxsIGZpbGVzIGZyb20gdmF1bHRcclxuXHRcdHRoaXMuYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCkuZm9yRWFjaCgoZmlsZSkgPT4ge1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0Ly8gT25seSBpbmNsdWRlIHN1cHBvcnRlZCBmaWxlIHR5cGVzXHJcblx0XHRcdFx0aWYgKFNVUFBPUlRFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGZpbGUuZXh0ZW5zaW9uKSkge1xyXG5cdFx0XHRcdFx0Ly8gTWF0Y2ggYWdhaW5zdCBwYXRoIG9yIG5hbWVcclxuXHRcdFx0XHRcdGlmIChcclxuXHRcdFx0XHRcdFx0ZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkgfHxcclxuXHRcdFx0XHRcdFx0ZmlsZS5iYXNlbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpXHJcblx0XHRcdFx0XHQpIHtcclxuXHRcdFx0XHRcdFx0ZmlsZXMucHVzaChmaWxlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFNvcnQgYnkgcmVsZXZhbmNlIChleGFjdCBtYXRjaGVzIGZpcnN0LCB0aGVuIGFscGhhYmV0aWNhbGx5KVxyXG5cdFx0ZmlsZXMuc29ydCgoYSwgYikgPT4ge1xyXG5cdFx0XHRjb25zdCBhU3RhcnRzV2l0aCA9IGEucGF0aC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobG93ZXJRdWVyeSk7XHJcblx0XHRcdGNvbnN0IGJTdGFydHNXaXRoID0gYi5wYXRoLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChsb3dlclF1ZXJ5KTtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChhU3RhcnRzV2l0aCAmJiAhYlN0YXJ0c1dpdGgpIHJldHVybiAtMTtcclxuXHRcdFx0aWYgKCFhU3RhcnRzV2l0aCAmJiBiU3RhcnRzV2l0aCkgcmV0dXJuIDE7XHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gYS5wYXRoLmxvY2FsZUNvbXBhcmUoYi5wYXRoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIExpbWl0IHJlc3VsdHNcclxuXHRcdHJldHVybiBmaWxlcy5zbGljZSgwLCAyMCk7XHJcblx0fVxyXG5cclxuXHRyZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdC8vIFNob3cgZmlsZSBuYW1lIHByb21pbmVudGx5XHJcblx0XHRlbC5jcmVhdGVFbCgnZGl2JywgeyBcclxuXHRcdFx0dGV4dDogZmlsZS5iYXNlbmFtZSxcclxuXHRcdFx0Y2xzOiAnc3VnZ2VzdGlvbi10aXRsZSdcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHQvLyBTaG93IHBhdGggaW4gc21hbGxlciB0ZXh0IGlmIGRpZmZlcmVudCBmcm9tIGJhc2VuYW1lXHJcblx0XHRpZiAoZmlsZS5wYXJlbnQgJiYgZmlsZS5wYXJlbnQucGF0aCAhPT0gJy8nKSB7XHJcblx0XHRcdGVsLmNyZWF0ZUVsKCdzbWFsbCcsIHsgXHJcblx0XHRcdFx0dGV4dDogZmlsZS5wYXJlbnQucGF0aCxcclxuXHRcdFx0XHRjbHM6ICdzdWdnZXN0aW9uLXBhdGgnXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNob3cgZmlsZSB0eXBlIGluZGljYXRvclxyXG5cdFx0aWYgKGZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSB7XHJcblx0XHRcdGVsLmNyZWF0ZUVsKCdzcGFuJywge1xyXG5cdFx0XHRcdHRleHQ6IGZpbGUuZXh0ZW5zaW9uLnRvVXBwZXJDYXNlKCksXHJcblx0XHRcdFx0Y2xzOiAnc3VnZ2VzdGlvbi1mbGFpcidcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRzZWxlY3RTdWdnZXN0aW9uKGZpbGU6IFRGaWxlKTogdm9pZCB7XHJcblx0XHR0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGg7XHJcblx0XHR0aGlzLmlucHV0RWwudHJpZ2dlcignaW5wdXQnKTtcclxuXHRcdHRoaXMuY2xvc2UoKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb2xkZXIgcGF0aCBzdWdnZXN0ZXIgZm9yIHNlbGVjdGluZyBmb2xkZXJzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRm9sZGVyU3VnZ2VzdCBleHRlbmRzIEFic3RyYWN0SW5wdXRTdWdnZXN0PFRGb2xkZXI+IHtcclxuXHRwcml2YXRlIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50KSB7XHJcblx0XHRzdXBlcihhcHAsIGlucHV0RWwpO1xyXG5cdFx0dGhpcy5pbnB1dEVsID0gaW5wdXRFbDtcclxuXHR9XHJcblxyXG5cdGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBURm9sZGVyW10ge1xyXG5cdFx0Y29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcblx0XHRjb25zdCBmb2xkZXJzOiBURm9sZGVyW10gPSBbXTtcclxuXHJcblx0XHR0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpLmZvckVhY2goKGZpbGUpID0+IHtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKSB7XHJcblx0XHRcdFx0aWYgKGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpKSB7XHJcblx0XHRcdFx0XHRmb2xkZXJzLnB1c2goZmlsZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRmb2xkZXJzLnNvcnQoKGEsIGIpID0+IGEucGF0aC5sb2NhbGVDb21wYXJlKGIucGF0aCkpO1xyXG5cdFx0cmV0dXJuIGZvbGRlcnMuc2xpY2UoMCwgMjApO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyU3VnZ2VzdGlvbihmb2xkZXI6IFRGb2xkZXIsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG5cdFx0ZWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogZm9sZGVyLnBhdGggfHwgJy8nIH0pO1xyXG5cdH1cclxuXHJcblx0c2VsZWN0U3VnZ2VzdGlvbihmb2xkZXI6IFRGb2xkZXIpOiB2b2lkIHtcclxuXHRcdHRoaXMuaW5wdXRFbC52YWx1ZSA9IGZvbGRlci5wYXRoO1xyXG5cdFx0dGhpcy5pbnB1dEVsLnRyaWdnZXIoJ2lucHV0Jyk7XHJcblx0XHR0aGlzLmNsb3NlKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogV29ya3NwYWNlIHN1Z2dlc3RlciBmb3Igc2VsZWN0aW5nIE9ic2lkaWFuIHdvcmtzcGFjZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBXb3Jrc3BhY2VTdWdnZXN0IGV4dGVuZHMgQWJzdHJhY3RJbnB1dFN1Z2dlc3Q8c3RyaW5nPiB7XHJcblx0cHJpdmF0ZSBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCkge1xyXG5cdFx0c3VwZXIoYXBwLCBpbnB1dEVsKTtcclxuXHRcdHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XHJcblx0fVxyXG5cclxuXHRnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG5cdFx0IFxyXG5cdFx0Y29uc3Qgd29ya3NwYWNlc1BsdWdpbiA9IHRoaXMuYXBwLmludGVybmFsUGx1Z2lucz8ucGx1Z2lucz8ud29ya3NwYWNlcztcclxuXHRcdCBcclxuXHRcdGlmICghd29ya3NwYWNlc1BsdWdpbj8uZW5hYmxlZCB8fCAhd29ya3NwYWNlc1BsdWdpbi5pbnN0YW5jZT8ud29ya3NwYWNlcykge1xyXG5cdFx0XHRyZXR1cm4gW107XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdCBcclxuXHRcdGNvbnN0IHdvcmtzcGFjZXMgPSBPYmplY3Qua2V5cyh3b3Jrc3BhY2VzUGx1Z2luLmluc3RhbmNlLndvcmtzcGFjZXMpO1xyXG5cdFx0Y29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcblx0XHRcclxuXHRcdHJldHVybiB3b3Jrc3BhY2VzLmZpbHRlcigod29ya3NwYWNlOiBzdHJpbmcpID0+IFxyXG5cdFx0XHR3b3Jrc3BhY2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KVxyXG5cdFx0KTtcclxuXHR9XHJcblxyXG5cdHJlbmRlclN1Z2dlc3Rpb24od29ya3NwYWNlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG5cdFx0ZWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogd29ya3NwYWNlIH0pO1xyXG5cdH1cclxuXHJcblx0c2VsZWN0U3VnZ2VzdGlvbih3b3Jrc3BhY2U6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0dGhpcy5pbnB1dEVsLnZhbHVlID0gd29ya3NwYWNlO1xyXG5cdFx0dGhpcy5pbnB1dEVsLnRyaWdnZXIoJ2lucHV0Jyk7XHJcblx0XHR0aGlzLmNsb3NlKCk7XHJcblx0fVxyXG59IiwgIi8qKlxyXG4gKiBDb21tYW5kIFN1Z2dlc3RlciBDb21wb25lbnRcclxuICogUHJvdmlkZXMgYXV0b2NvbXBsZXRlIGZvciBPYnNpZGlhbiBjb21tYW5kcyBpbiBzZXR0aW5nc1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFic3RyYWN0SW5wdXRTdWdnZXN0LCBBcHAsIENvbW1hbmQgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogQ29tbWFuZCBzdWdnZXN0ZXIgdGhhdCBwcm92aWRlcyBhdXRvY29tcGxldGUgZm9yIE9ic2lkaWFuIGNvbW1hbmRzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ29tbWFuZFN1Z2dlc3QgZXh0ZW5kcyBBYnN0cmFjdElucHV0U3VnZ2VzdDxDb21tYW5kPiB7XHJcblx0cHJpdmF0ZSBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCkge1xyXG5cdFx0c3VwZXIoYXBwLCBpbnB1dEVsKTtcclxuXHRcdHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XHJcblx0fVxyXG5cclxuXHRnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogQ29tbWFuZFtdIHtcclxuXHRcdGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0Y29uc3QgY29tbWFuZHM6IENvbW1hbmRbXSA9IFtdO1xyXG5cclxuXHRcdC8vIEdldCBhbGwgY29tbWFuZHMgZnJvbSB0aGUgYXBwXHJcblx0XHRjb25zdCBhcHBXaXRoQ29tbWFuZHMgPSB0aGlzLmFwcCBhcyBBcHAgJiB7IFxyXG5cdFx0XHRjb21tYW5kcz86IHsgY29tbWFuZHM/OiBSZWNvcmQ8c3RyaW5nLCBDb21tYW5kPiB9IFxyXG5cdFx0fTtcclxuXHRcdGNvbnN0IGFsbENvbW1hbmRzID0gYXBwV2l0aENvbW1hbmRzLmNvbW1hbmRzPy5jb21tYW5kcztcclxuXHRcdFxyXG5cdFx0aWYgKGFsbENvbW1hbmRzKSB7XHJcblx0XHRcdGZvciAoY29uc3QgY29tbWFuZCBvZiBPYmplY3QudmFsdWVzKGFsbENvbW1hbmRzKSkge1xyXG5cdFx0XHRcdGlmIChjb21tYW5kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KSB8fFxyXG5cdFx0XHRcdFx0Y29tbWFuZC5pZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpKSB7XHJcblx0XHRcdFx0XHRjb21tYW5kcy5wdXNoKGNvbW1hbmQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNvcnQgYWxwaGFiZXRpY2FsbHkgYnkgbmFtZVxyXG5cdFx0Y29tbWFuZHMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcblxyXG5cdFx0Ly8gTGltaXQgcmVzdWx0c1xyXG5cdFx0cmV0dXJuIGNvbW1hbmRzLnNsaWNlKDAsIDMwKTtcclxuXHR9XHJcblxyXG5cdHJlbmRlclN1Z2dlc3Rpb24oY29tbWFuZDogQ29tbWFuZCwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRlbC5jcmVhdGVFbCgnZGl2JywgeyBcclxuXHRcdFx0dGV4dDogY29tbWFuZC5uYW1lLFxyXG5cdFx0XHRjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJ1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdGVsLmNyZWF0ZUVsKCdzbWFsbCcsIHsgXHJcblx0XHRcdHRleHQ6IGNvbW1hbmQuaWQsXHJcblx0XHRcdGNsczogJ3N1Z2dlc3Rpb24tbm90ZSdcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0c2VsZWN0U3VnZ2VzdGlvbihjb21tYW5kOiBDb21tYW5kKTogdm9pZCB7XHJcblx0XHR0aGlzLmlucHV0RWwudmFsdWUgPSBjb21tYW5kLmlkO1xyXG5cdFx0dGhpcy5pbnB1dEVsLnRyaWdnZXIoJ2lucHV0Jyk7XHJcblx0XHR0aGlzLmNsb3NlKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogRXh0ZW5kZWQgQXBwIGludGVyZmFjZSB3aXRoIGNvbW1hbmRzXHJcbiAqL1xyXG5pbnRlcmZhY2UgQXBwV2l0aENvbW1hbmRzIGV4dGVuZHMgQXBwIHtcclxuXHRjb21tYW5kcz86IHtcclxuXHRcdGNvbW1hbmRzPzogUmVjb3JkPHN0cmluZywgQ29tbWFuZD47XHJcblx0XHRleGVjdXRlQ29tbWFuZEJ5SWQ/OiAoY29tbWFuZElkOiBzdHJpbmcpID0+IGJvb2xlYW4gfCBQcm9taXNlPHZvaWQ+O1xyXG5cdH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBjb21tYW5kIGJ5IGl0cyBJRFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbW1hbmRCeUlkKGFwcDogQXBwLCBjb21tYW5kSWQ6IHN0cmluZyk6IENvbW1hbmQgfCB1bmRlZmluZWQge1xyXG5cdGNvbnN0IGFwcFdpdGhDb21tYW5kcyA9IGFwcCBhcyBBcHBXaXRoQ29tbWFuZHM7XHJcblx0Y29uc3QgY29tbWFuZHMgPSBhcHBXaXRoQ29tbWFuZHMuY29tbWFuZHM/LmNvbW1hbmRzO1xyXG5cdHJldHVybiBjb21tYW5kcz8uW2NvbW1hbmRJZF07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeGVjdXRlIGEgY29tbWFuZCBieSBpdHMgSURcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleGVjdXRlQ29tbWFuZChhcHA6IEFwcCwgY29tbWFuZElkOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRpZiAoIWNvbW1hbmRJZCkgcmV0dXJuIGZhbHNlO1xyXG5cdFxyXG5cdGNvbnN0IGFwcFdpdGhDb21tYW5kcyA9IGFwcCBhcyBBcHBXaXRoQ29tbWFuZHM7XHJcblx0Y29uc3QgcmVzdWx0ID0gYXBwV2l0aENvbW1hbmRzLmNvbW1hbmRzPy5leGVjdXRlQ29tbWFuZEJ5SWQ/Lihjb21tYW5kSWQpO1xyXG5cdHJldHVybiByZXN1bHQgIT09IGZhbHNlO1xyXG59XHJcbiIsICIvKipcclxuICogSWNvbiBQaWNrZXIgTW9kYWxcclxuICogU2ltcGxpZmllZCBpY29uIHBpY2tlciBmb3Igc2VsZWN0aW5nIHN0aWNreSBpY29uXHJcbiAqIEJhc2VkIG9uIGljb25pYyBwbHVnaW4ncyBpY29uIHBpY2tlclxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBNb2RhbCwgUGxhdGZvcm0sIFNldHRpbmcsIFRleHRDb21wb25lbnQsIHByZXBhcmVGdXp6eVNlYXJjaCwgc2V0SWNvbiwgZ2V0SWNvbklkcyB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSWNvblBpY2tlckNhbGxiYWNrIHtcclxuXHQoaWNvbjogc3RyaW5nIHwgbnVsbCk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaW1wbGlmaWVkIGljb24gcGlja2VyIG1vZGFsXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSWNvblBpY2tlciBleHRlbmRzIE1vZGFsIHtcclxuXHRwcml2YXRlIHNlbGVjdGVkSWNvbjogc3RyaW5nIHwgbnVsbDtcclxuXHRwcml2YXRlIGNhbGxiYWNrOiBJY29uUGlja2VyQ2FsbGJhY2s7XHJcblx0cHJpdmF0ZSBzZWFyY2hGaWVsZDogVGV4dENvbXBvbmVudDtcclxuXHRwcml2YXRlIHNlYXJjaFJlc3VsdHM6IFtpY29uOiBzdHJpbmcsIGljb25OYW1lOiBzdHJpbmddW10gPSBbXTtcclxuXHRwcml2YXRlIHNlYXJjaFJlc3VsdHNTZXR0aW5nOiBTZXR0aW5nO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgY3VycmVudEljb246IHN0cmluZyB8IG51bGwsIGNhbGxiYWNrOiBJY29uUGlja2VyQ2FsbGJhY2spIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLnNlbGVjdGVkSWNvbiA9IGN1cnJlbnRJY29uO1xyXG5cdFx0dGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG5cdH1cclxuXHJcblx0b25PcGVuKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRDbGFzcygnbW9kLWNvbmZpcm1hdGlvbicpO1xyXG5cdFx0dGhpcy5tb2RhbEVsLmFkZENsYXNzKCdpY29uaWMtaWNvbi1waWNrZXInKTtcclxuXHRcdHRoaXMuc2V0VGl0bGUoJ0NoYW5nZSBpY29uJyk7XHJcblxyXG5cdFx0Ly8gU2VhcmNoIGZpZWxkXHJcblx0XHRjb25zdCBzZWFyY2hTZXR0aW5nID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpO1xyXG5cdFx0aWYgKCFQbGF0Zm9ybS5pc1Bob25lKSB7XHJcblx0XHRcdHNlYXJjaFNldHRpbmcuc2V0TmFtZSgnU2VhcmNoJyk7XHJcblx0XHR9XHJcblx0XHRzZWFyY2hTZXR0aW5nLmFkZFNlYXJjaCgoc2VhcmNoRmllbGQpID0+IHtcclxuXHRcdFx0c2VhcmNoRmllbGRcclxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ1NlYXJjaCBpY29ucy4uLicpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKCgpID0+IHRoaXMudXBkYXRlU2VhcmNoUmVzdWx0cygpKTtcclxuXHRcdFx0c2VhcmNoRmllbGQuaW5wdXRFbC5lbnRlcktleUhpbnQgPSAnZ28nO1xyXG5cdFx0XHR0aGlzLnNlYXJjaEZpZWxkID0gc2VhcmNoRmllbGQ7XHJcblx0XHR9KTtcclxuXHRcdGlmICh0aGlzLnNlbGVjdGVkSWNvbikge1xyXG5cdFx0XHR0aGlzLnNlYXJjaEZpZWxkLnNldFZhbHVlKHRoaXMuc2VsZWN0ZWRJY29uKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBTZWFyY2ggcmVzdWx0c1xyXG5cdFx0dGhpcy5zZWFyY2hSZXN1bHRzU2V0dGluZyA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKTtcclxuXHRcdHRoaXMuc2VhcmNoUmVzdWx0c1NldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKCdpY29uaWMtc2VhcmNoLXJlc3VsdHMnKTtcclxuXHRcdHRoaXMuc2VhcmNoUmVzdWx0c1NldHRpbmcuc2V0dGluZ0VsLnRhYkluZGV4ID0gMDtcclxuXHRcdFxyXG5cdFx0Ly8gQWxsb3cgdmVydGljYWwgc2Nyb2xsaW5nIHRvIHdvcmsgaG9yaXpvbnRhbGx5XHJcblx0XHR0aGlzLnNlYXJjaFJlc3VsdHNTZXR0aW5nLnNldHRpbmdFbC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudCkgPT4ge1xyXG5cdFx0XHRpZiAoZG9jdW1lbnQuYm9keS5oYXNDbGFzcygnbW9kLXJ0bCcpKSB7XHJcblx0XHRcdFx0dGhpcy5zZWFyY2hSZXN1bHRzU2V0dGluZy5zZXR0aW5nRWwuc2Nyb2xsTGVmdCAtPSBldmVudC5kZWx0YVk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zZWFyY2hSZXN1bHRzU2V0dGluZy5zZXR0aW5nRWwuc2Nyb2xsTGVmdCArPSBldmVudC5kZWx0YVk7XHJcblx0XHRcdH1cclxuXHRcdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcclxuXHJcblx0XHQvLyBCdXR0b25zIC0gbWF0Y2ggaWNvbmljJ3MgYnV0dG9uIGxheW91dFxyXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5tb2RhbEVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWJ1dHRvbi1jb250YWluZXInIH0pO1xyXG5cclxuXHRcdC8vIENhbmNlbFxyXG5cdFx0bmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXHJcblx0XHRcdC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxyXG5cdFx0XHQub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpXHJcblx0XHRcdC5idXR0b25FbC5hZGRDbGFzcygnbW9kLWNhbmNlbCcpO1xyXG5cclxuXHRcdC8vIFNhdmVcclxuXHRcdG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0QnV0dG9uVGV4dCgnU2F2ZScpXHJcblx0XHRcdC5zZXRDdGEoKVxyXG5cdFx0XHQub25DbGljaygoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5jYWxsYmFjayh0aGlzLnNlbGVjdGVkSWNvbik7XHJcblx0XHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHQvLyBBdXRvLWZvY3VzIHNlYXJjaCBmaWVsZFxyXG5cdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuXHRcdFx0dGhpcy5zZWFyY2hGaWVsZC5pbnB1dEVsLnNlbGVjdCgpO1xyXG5cdFx0XHR0aGlzLnVwZGF0ZVNlYXJjaFJlc3VsdHMoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlIHNlYXJjaCByZXN1bHRzIGJhc2VkIG9uIGN1cnJlbnQgcXVlcnlcclxuXHQgKi9cclxuXHRwcml2YXRlIHVwZGF0ZVNlYXJjaFJlc3VsdHMoKTogdm9pZCB7XHJcblx0XHRjb25zdCBxdWVyeSA9IHRoaXMuc2VhcmNoRmllbGQuZ2V0VmFsdWUoKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuXHRcdGNvbnN0IGZ1enp5U2VhcmNoID0gcHJlcGFyZUZ1enp5U2VhcmNoKHF1ZXJ5KTtcclxuXHRcdGNvbnN0IG1hdGNoZXM6IFtzY29yZTogbnVtYmVyLCBpY29uRW50cnk6IFtzdHJpbmcsIHN0cmluZ11dW10gPSBbXTtcclxuXHJcblx0XHQvLyBHZXQgYWxsIGF2YWlsYWJsZSBpY29uc1xyXG5cdFx0Y29uc3QgaWNvbklkcyA9IGdldEljb25JZHMoKTtcclxuXHJcblx0XHQvLyBTZWFyY2ggaWNvbnNcclxuXHRcdGlmIChxdWVyeSkge1xyXG5cdFx0XHRmb3IgKGNvbnN0IGljb25JZCBvZiBpY29uSWRzKSB7XHJcblx0XHRcdFx0Ly8gQ3JlYXRlIGEgcmVhZGFibGUgbmFtZSBmcm9tIGljb24gSURcclxuXHRcdFx0XHRjb25zdCBpY29uTmFtZSA9IHRoaXMuZm9ybWF0SWNvbk5hbWUoaWNvbklkKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAoaWNvbklkID09PSBxdWVyeSB8fCBpY29uSWQudG9Mb3dlckNhc2UoKSA9PT0gcXVlcnkpIHtcclxuXHRcdFx0XHRcdG1hdGNoZXMucHVzaChbMCwgW2ljb25JZCwgaWNvbk5hbWVdXSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGNvbnN0IGZ1enp5TWF0Y2ggPSBmdXp6eVNlYXJjaChpY29uTmFtZSk7XHJcblx0XHRcdFx0XHRpZiAoZnV6enlNYXRjaCkge1xyXG5cdFx0XHRcdFx0XHRtYXRjaGVzLnB1c2goW2Z1enp5TWF0Y2guc2NvcmUsIFtpY29uSWQsIGljb25OYW1lXV0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gU2hvdyBhbGwgaWNvbnMgaWYgbm8gcXVlcnlcclxuXHRcdFx0Zm9yIChjb25zdCBpY29uSWQgb2YgaWNvbklkcykge1xyXG5cdFx0XHRcdGNvbnN0IGljb25OYW1lID0gdGhpcy5mb3JtYXRJY29uTmFtZShpY29uSWQpO1xyXG5cdFx0XHRcdG1hdGNoZXMucHVzaChbMCwgW2ljb25JZCwgaWNvbk5hbWVdXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBTb3J0IGJ5IHNjb3JlXHJcblx0XHRtYXRjaGVzLnNvcnQoKFtzY29yZUFdLCBbc2NvcmVCXSkgPT4gc2NvcmVBID4gc2NvcmVCID8gLTEgOiArMSk7XHJcblxyXG5cdFx0Ly8gTGltaXQgcmVzdWx0c1xyXG5cdFx0dGhpcy5zZWFyY2hSZXN1bHRzLmxlbmd0aCA9IDA7XHJcblx0XHRjb25zdCBtYXhSZXN1bHRzID0gMTAwO1xyXG5cdFx0Zm9yIChjb25zdCBbLCBpY29uRW50cnldIG9mIG1hdGNoZXMpIHtcclxuXHRcdFx0dGhpcy5zZWFyY2hSZXN1bHRzLnB1c2goaWNvbkVudHJ5KTtcclxuXHRcdFx0aWYgKHRoaXMuc2VhcmNoUmVzdWx0cy5sZW5ndGggPj0gbWF4UmVzdWx0cykgYnJlYWs7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXBkYXRlIFVJIC0gdXNlIEV4dHJhQnV0dG9uQ29tcG9uZW50IGxpa2UgaWNvbmljXHJcblx0XHR0aGlzLnNlYXJjaFJlc3VsdHNTZXR0aW5nLmNsZWFyKCk7XHJcblx0XHRmb3IgKGNvbnN0IFtpY29uSWQsIGljb25OYW1lXSBvZiB0aGlzLnNlYXJjaFJlc3VsdHMpIHtcclxuXHRcdFx0dGhpcy5zZWFyY2hSZXN1bHRzU2V0dGluZy5hZGRFeHRyYUJ1dHRvbigoaWNvbkJ1dHRvbikgPT4ge1xyXG5cdFx0XHRcdGljb25CdXR0b24uc2V0VG9vbHRpcChpY29uTmFtZSwge1xyXG5cdFx0XHRcdFx0ZGVsYXk6IDMwMCxcclxuXHRcdFx0XHRcdHBsYWNlbWVudDogUGxhdGZvcm0uaXNQaG9uZSA/ICd0b3AnIDogJ2JvdHRvbScsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Y29uc3QgaWNvbkVsID0gaWNvbkJ1dHRvbi5leHRyYVNldHRpbmdzRWw7XHJcblx0XHRcdFx0aWNvbkVsLmFkZENsYXNzKCdpY29uaWMtc2VhcmNoLXJlc3VsdCcpO1xyXG5cdFx0XHRcdGljb25FbC50YWJJbmRleCA9IC0xO1xyXG5cclxuXHRcdFx0XHRzZXRJY29uKGljb25FbCwgaWNvbklkKTtcclxuXHJcblx0XHRcdFx0Ly8gSGlnaGxpZ2h0IHNlbGVjdGVkIGljb25cclxuXHRcdFx0XHRpZiAoaWNvbklkID09PSB0aGlzLnNlbGVjdGVkSWNvbikge1xyXG5cdFx0XHRcdFx0aWNvbkVsLmFkZENsYXNzKCdpcy1zZWxlY3RlZCcpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWNvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5zZWxlY3RlZEljb24gPSBpY29uSWQ7XHJcblx0XHRcdFx0XHR0aGlzLmNhbGxiYWNrKGljb25JZCk7XHJcblx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdC8vIE1vYmlsZTogc2hvdyB0b29sdGlwIG9uIGxvbmcgcHJlc3NcclxuXHRcdFx0XHRpZiAoUGxhdGZvcm0uaXNQaG9uZSkge1xyXG5cdFx0XHRcdFx0aWNvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRuYXZpZ2F0b3IudmlicmF0ZT8uKDEwMCk7XHJcblx0XHRcdFx0XHRcdC8vIFRvb2x0aXAgaXMgYWxyZWFkeSBzZXQgYWJvdmVcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXNlIGFuIGludmlzaWJsZSBidXR0b24gdG8gcHJlc2VydmUgaGVpZ2h0IGlmIG5vIHJlc3VsdHNcclxuXHRcdGlmICh0aGlzLnNlYXJjaFJlc3VsdHMubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdHRoaXMuc2VhcmNoUmVzdWx0c1NldHRpbmcuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbikgPT4ge1xyXG5cdFx0XHRcdGJ1dHRvbi5leHRyYVNldHRpbmdzRWwuYWRkQ2xhc3NlcyhbJ2ljb25pYy1pbnZpc2libGUnLCAnaWNvbmljLXNlYXJjaC1yZXN1bHQnXSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRm9ybWF0IGljb24gSUQgaW50byByZWFkYWJsZSBuYW1lXHJcblx0ICovXHJcblx0cHJpdmF0ZSBmb3JtYXRJY29uTmFtZShpY29uSWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0XHQvLyBSZW1vdmUgbHVjaWRlLSBwcmVmaXggaWYgcHJlc2VudFxyXG5cdFx0bGV0IG5hbWUgPSBpY29uSWQucmVwbGFjZSgvXmx1Y2lkZS0vLCAnJyk7XHJcblx0XHQvLyBSZXBsYWNlIGRhc2hlcyB3aXRoIHNwYWNlc1xyXG5cdFx0bmFtZSA9IG5hbWUucmVwbGFjZSgvLS9nLCAnICcpO1xyXG5cdFx0Ly8gQ2FwaXRhbGl6ZSBmaXJzdCBsZXR0ZXIgb2YgZWFjaCB3b3JkXHJcblx0XHRyZXR1cm4gbmFtZS5zcGxpdCgnICcpLm1hcCh3b3JkID0+IFxyXG5cdFx0XHR3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKVxyXG5cdFx0KS5qb2luKCcgJyk7XHJcblx0fVxyXG5cclxuXHRvbkNsb3NlKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5jb250ZW50RWwuZW1wdHkoKTtcclxuXHR9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBIb21lIEJhc2UgU2VydmljZVxyXG4gKiBDb3JlIGxvZ2ljIGZvciBvcGVuaW5nIGFuZCBtYW5hZ2luZyB0aGUgaG9tZSBiYXNlIGZpbGVcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmLCBNYXJrZG93blZpZXcsIFBsYXRmb3JtLCBWaWV3IGFzIE9WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgdHlwZSBIb21lQmFzZVBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuaW1wb3J0IHsgSG9tZUJhc2VUeXBlLCBPcGVuaW5nTW9kZSB9IGZyb20gJy4uL3NldHRpbmdzJztcclxuaW1wb3J0IHsgZ2V0RmlsZUJ5UGF0aCwgaXNNYXJrZG93bkxpa2UsIGxlYWZIYXNGaWxlLCBpc1N1cHBvcnRlZEV4dGVuc2lvbiB9IGZyb20gJy4uL3V0aWxzL2ZpbGUtdXRpbHMnO1xyXG5pbXBvcnQgeyBleGVjdXRlQ29tbWFuZCB9IGZyb20gJy4uL3VpL2NvbW1hbmQtc3VnZ2VzdCc7XHJcbmltcG9ydCB7IGNvbXB1dGVIb21lQmFzZVBhdGgsIHRyaW1GaWxlIH0gZnJvbSAnLi4vdXRpbHMvaG9tZWJhc2UtcmVzb2x2ZXInO1xyXG5cclxuLyoqXHJcbiAqIFZpZXcgdHlwZXMgdGhhdCBjYW4gYmUgaG9tZSBiYXNlIGZpbGVzXHJcbiAqL1xyXG5jb25zdCBMRUFGX1RZUEVTID0gWydtYXJrZG93bicsICdjYW52YXMnLCAnYmFzZXMnXTtcclxuXHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gY2hlY2sgaWYgdHdvIGZpbGUgcGF0aHMgYXJlIGVxdWFsIChjYXNlLWluc2Vuc2l0aXZlLCBpZ25vcmluZyBleHRlbnNpb24pXHJcbiAqL1xyXG5mdW5jdGlvbiBlcXVhbHNDYXNlbGVzcyhwYXRoMTogc3RyaW5nLCBwYXRoMjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0Y29uc3Qgbm9ybWFsaXplID0gKHA6IHN0cmluZykgPT4gcC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xcLm1kJC8sICcnKTtcclxuXHRyZXR1cm4gbm9ybWFsaXplKHBhdGgxKSA9PT0gbm9ybWFsaXplKHBhdGgyKTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEhvbWVCYXNlU2VydmljZSB7XHJcblx0cHJpdmF0ZSBhcHA6IEFwcDtcclxuXHRwcml2YXRlIHBsdWdpbjogSG9tZUJhc2VQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogSG9tZUJhc2VQbHVnaW4pIHtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdFx0dGhpcy5hcHAgPSBwbHVnaW4uYXBwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogT3BlbiBob21lIGJhc2Ugd2l0aCBhIHNwZWNpZmljIG1vZGUgKGZvciBzdGFydHVwL21hbnVhbCBvcGVucylcclxuXHQgKi9cclxuXHRhc3luYyBvcGVuSG9tZUJhc2VXaXRoTW9kZShtb2RlOiBPcGVuaW5nTW9kZSwgcnVuQ29tbWFuZDogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdGNvbnN0IGhvbWVCYXNlU2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5nZXRIb21lQmFzZVNldHRpbmdzKCk7XHJcblx0XHRcclxuXHRcdC8vIEhhbmRsZSBub24tZmlsZSB0eXBlcyAoV29ya3NwYWNlLCBHcmFwaCwgTm9uZSlcclxuXHRcdGlmIChob21lQmFzZVNldHRpbmdzLnR5cGUgPT09IEhvbWVCYXNlVHlwZS5Xb3Jrc3BhY2UpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMub3BlbldvcmtzcGFjZShob21lQmFzZVNldHRpbmdzLnZhbHVlKTtcclxuXHRcdH1cclxuXHRcdGlmIChob21lQmFzZVNldHRpbmdzLnR5cGUgPT09IEhvbWVCYXNlVHlwZS5HcmFwaCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5vcGVuR3JhcGgoKTtcclxuXHRcdH1cclxuXHRcdGlmIChob21lQmFzZVNldHRpbmdzLnR5cGUgPT09IEhvbWVCYXNlVHlwZS5Ob25lKSB7XHJcblx0XHRcdC8vIEp1c3QgcnVuIGNvbW1hbmQsIGRvbid0IG9wZW4gYW55dGhpbmdcclxuXHRcdFx0aWYgKHJ1bkNvbW1hbmQpIHtcclxuXHRcdFx0XHR0aGlzLnJ1bkNvbW1hbmRPbk9wZW4oKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZXNvbHZlIHRoZSBhY3R1YWwgZmlsZSBwYXRoIGJhc2VkIG9uIHR5cGVcclxuXHRcdGNvbnN0IHJlc29sdmVkUGF0aCA9IGF3YWl0IGNvbXB1dGVIb21lQmFzZVBhdGgoXHJcblx0XHRcdGhvbWVCYXNlU2V0dGluZ3MudHlwZSxcclxuXHRcdFx0aG9tZUJhc2VTZXR0aW5ncy52YWx1ZSxcclxuXHRcdFx0dGhpcy5wbHVnaW5cclxuXHRcdCk7XHJcblx0XHRcclxuXHRcdGlmICghcmVzb2x2ZWRQYXRoKSB7XHJcblx0XHRcdGNvbnNvbGUuZGVidWcoYEhvbWUgQmFzZTogQ291bGQgbm90IHJlc29sdmUgcGF0aCBmb3IgdHlwZSAke2hvbWVCYXNlU2V0dGluZ3MudHlwZX1gKTtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdldCB0aGUgZmlsZSAtIHVzZSBtZXRhZGF0YUNhY2hlIGZvciBiZXR0ZXIgcGF0aCByZXNvbHV0aW9uIChsaWtlIGhvbWVwYWdlIHBsdWdpbilcclxuXHRcdGxldCBmaWxlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChyZXNvbHZlZFBhdGgsICcvJyk7XHJcblx0XHRcclxuXHRcdC8vIElmIG5vdCBmb3VuZCBhbmQgYXV0by1jcmVhdGUgaXMgbm90IHN1cHBvcnRlZCBmb3IgdGhpcyB0eXBlLCByZXR1cm5cclxuXHRcdC8vIEZvciBub3csIHdlJ2xsIHRyeSBnZXRGaWxlQnlQYXRoIGFzIGZhbGxiYWNrXHJcblx0XHRpZiAoIWZpbGUpIHtcclxuXHRcdFx0ZmlsZSA9IGdldEZpbGVCeVBhdGgodGhpcy5hcHAsIHJlc29sdmVkUGF0aCk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmICghZmlsZSkge1xyXG5cdFx0XHQvLyBUcnkgdG8gY3JlYXRlIGlmIGl0J3MgYSBtYXJrZG93biBmaWxlIGFuZCBwYXRoIGRvZXNuJ3QgaGF2ZSBleHRlbnNpb25cclxuXHRcdFx0Y29uc3QgdW50cmltbWVkUGF0aCA9IHJlc29sdmVkUGF0aC5lbmRzV2l0aCgnLm1kJykgPyByZXNvbHZlZFBhdGggOiBgJHtyZXNvbHZlZFBhdGh9Lm1kYDtcclxuXHRcdFx0ZmlsZSA9IGdldEZpbGVCeVBhdGgodGhpcy5hcHAsIHVudHJpbW1lZFBhdGgpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKCFmaWxlICYmIGhvbWVCYXNlU2V0dGluZ3MudHlwZSA9PT0gSG9tZUJhc2VUeXBlLkZpbGUpIHtcclxuXHRcdFx0XHQvLyBDb3VsZCBjcmVhdGUgZmlsZSBoZXJlIGlmIGF1dG9DcmVhdGUgc2V0dGluZyBleGlzdHMsIGJ1dCBmb3Igbm93IGp1c3QgcmV0dXJuXHJcblx0XHRcdFx0Y29uc29sZS5kZWJ1ZyhgSG9tZSBCYXNlOiBGaWxlIG5vdCBmb3VuZDogJHtyZXNvbHZlZFBhdGh9YCk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmICghZmlsZSkge1xyXG5cdFx0XHRjb25zb2xlLmRlYnVnKGBIb21lIEJhc2U6IEZpbGUgbm90IGZvdW5kOiAke3Jlc29sdmVkUGF0aH1gKTtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEhhbmRsZSBvcGVuaW5nIG1vZGVcclxuXHRcdGlmIChtb2RlID09PSAncmVwbGFjZS1hbGwnKSB7XHJcblx0XHRcdGF3YWl0IHRoaXMuZGV0YWNoQWxsTGVhdmVzKCk7XHJcblx0XHR9IGVsc2UgaWYgKG1vZGUgPT09ICdyZXBsYWNlLWxhc3QnKSB7XHJcblx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShPVmlldyk/LmxlYWY7XHJcblx0XHRcdGlmIChhY3RpdmVMZWFmKSB7XHJcblx0XHRcdFx0YWN0aXZlTGVhZi5zZXRQaW5uZWQoZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2hlY2sgZm9yIGV4aXN0aW5nIGxlYWYgKGJ1dCBleGNsdWRlIGdob3N0IHRhYiBmb3IgbWFudWFsIG9wZW5zKVxyXG5cdFx0Y29uc3QgZXhpc3RpbmdMZWFmID0gdGhpcy5maW5kRXhpc3RpbmdIb21lQmFzZUxlYWYoZmlsZSk7XHJcblx0XHRpZiAoZXhpc3RpbmdMZWFmICYmIG1vZGUgIT09ICdyZXBsYWNlLWFsbCcpIHtcclxuXHRcdFx0Y29uc3Qgdmlld1N0YXRlID0gZXhpc3RpbmdMZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG5cdFx0XHRpZiAodmlld1N0YXRlLnBpbm5lZCA9PT0gdHJ1ZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3RpY2t5SG9tZUljb24pIHtcclxuXHRcdFx0XHQvLyBEb24ndCB1c2UgZ2hvc3QgdGFiIGZvciBtYW51YWwgb3BlbnMgLSB3aWxsIGNyZWF0ZSBuZXcgdGFiIGJlbG93XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoZXhpc3RpbmdMZWFmKTtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLmNvbmZpZ3VyZVZpZXcoZXhpc3RpbmdMZWFmLCBmaWxlKTtcclxuXHRcdFx0XHRpZiAocnVuQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0dGhpcy5ydW5Db21tYW5kT25PcGVuKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gT3BlbiBpbiBuZXcgbGVhZlxyXG5cdFx0Y29uc3QgbmV3TGVhZiA9IG1vZGUgPT09ICdyZXRhaW4nIFxyXG5cdFx0XHQ/IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKVxyXG5cdFx0XHQ6IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcclxuXHRcdFxyXG5cdFx0aWYgKCFuZXdMZWFmKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0YXdhaXQgbmV3TGVhZi5vcGVuRmlsZShmaWxlKTtcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG5ld0xlYWYpO1xyXG5cdFx0YXdhaXQgdGhpcy5jb25maWd1cmVWaWV3KG5ld0xlYWYsIGZpbGUpO1xyXG5cclxuXHRcdGlmIChydW5Db21tYW5kKSB7XHJcblx0XHRcdHRoaXMucnVuQ29tbWFuZE9uT3BlbigpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogT3BlbiB3b3Jrc3BhY2VcclxuXHQgKi9cclxuXHRwcml2YXRlIGFzeW5jIG9wZW5Xb3Jrc3BhY2Uod29ya3NwYWNlTmFtZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHQgXHJcblx0XHRjb25zdCB3b3Jrc3BhY2VQbHVnaW4gPSB0aGlzLmFwcC5pbnRlcm5hbFBsdWdpbnM/LnBsdWdpbnM/LndvcmtzcGFjZXM7XHJcblx0XHQgXHJcblx0XHRpZiAoIXdvcmtzcGFjZVBsdWdpbj8uZW5hYmxlZCB8fCAhd29ya3NwYWNlUGx1Z2luLmluc3RhbmNlPy5sb2FkV29ya3NwYWNlKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdCBcclxuXHRcdHdvcmtzcGFjZVBsdWdpbi5pbnN0YW5jZS5sb2FkV29ya3NwYWNlKHdvcmtzcGFjZU5hbWUpO1xyXG5cdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpO1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBPcGVuIGdyYXBoIHZpZXdcclxuXHQgKi9cclxuXHRwcml2YXRlIGFzeW5jIG9wZW5HcmFwaCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdCBcclxuXHRcdGF3YWl0IHRoaXMuYXBwLmNvbW1hbmRzPy5leGVjdXRlQ29tbWFuZEJ5SWQ/LignZ3JhcGg6b3BlbicpO1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBPcGVuIHRoZSBob21lIGJhc2UgZmlsZVxyXG5cdCAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgZm9yIG9wZW5pbmdcclxuXHQgKi9cclxuXHRhc3luYyBvcGVuSG9tZUJhc2Uob3B0aW9uczoge1xyXG5cdFx0cmVwbGFjZUFjdGl2ZUxlYWY/OiBib29sZWFuO1xyXG5cdFx0cnVuQ29tbWFuZD86IGJvb2xlYW47XHJcblx0fSA9IHt9KTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHRjb25zdCB7IHJ1bkNvbW1hbmQgPSB0cnVlIH0gPSBvcHRpb25zO1xyXG5cdFx0Y29uc3QgbW9kZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm1hbnVhbE9wZW5Nb2RlO1xyXG5cdFx0XHJcblx0XHQvLyBVc2UgdGhlIG5ldyBtZXRob2Qgd2l0aCBtYW51YWwgbW9kZVxyXG5cdFx0cmV0dXJuIHRoaXMub3BlbkhvbWVCYXNlV2l0aE1vZGUobW9kZSwgcnVuQ29tbWFuZCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBPcGVuIGhvbWUgYmFzZSBpbiBhbiBlbXB0eSBsZWFmIChmb3IgbmV3IHRhYiByZXBsYWNlbWVudClcclxuXHQgKi9cclxuXHRhc3luYyBvcGVuSW5MZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdGNvbnN0IGhvbWVCYXNlU2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5nZXRIb21lQmFzZVNldHRpbmdzKCk7XHJcblxyXG5cdFx0Ly8gSGFuZGxlIG5vbi1maWxlIHR5cGVzXHJcblx0XHRpZiAoaG9tZUJhc2VTZXR0aW5ncy50eXBlID09PSBIb21lQmFzZVR5cGUuV29ya3NwYWNlKSB7XHJcblx0XHRcdGF3YWl0IHRoaXMub3BlbldvcmtzcGFjZShob21lQmFzZVNldHRpbmdzLnZhbHVlKTtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0XHRpZiAoaG9tZUJhc2VTZXR0aW5ncy50eXBlID09PSBIb21lQmFzZVR5cGUuR3JhcGgpIHtcclxuXHRcdFx0YXdhaXQgdGhpcy5vcGVuR3JhcGgoKTtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0XHRpZiAoaG9tZUJhc2VTZXR0aW5ncy50eXBlID09PSBIb21lQmFzZVR5cGUuTm9uZSkge1xyXG5cdFx0XHR0aGlzLnJ1bkNvbW1hbmRPbk9wZW4oKTtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gUmVzb2x2ZSB0aGUgYWN0dWFsIGZpbGUgcGF0aCBiYXNlZCBvbiB0eXBlXHJcblx0XHRjb25zdCByZXNvbHZlZFBhdGggPSBhd2FpdCBjb21wdXRlSG9tZUJhc2VQYXRoKFxyXG5cdFx0XHRob21lQmFzZVNldHRpbmdzLnR5cGUsXHJcblx0XHRcdGhvbWVCYXNlU2V0dGluZ3MudmFsdWUsXHJcblx0XHRcdHRoaXMucGx1Z2luXHJcblx0XHQpO1xyXG5cdFx0XHJcblx0XHRpZiAoIXJlc29sdmVkUGF0aCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgZmlsZSA9IGdldEZpbGVCeVBhdGgodGhpcy5hcHAsIHJlc29sdmVkUGF0aCk7XHJcblx0XHRpZiAoIWZpbGUpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcblx0XHRhd2FpdCB0aGlzLmNvbmZpZ3VyZVZpZXcobGVhZiwgZmlsZSk7XHJcblx0XHRcclxuXHRcdC8vIFJ1biBjb21tYW5kIGlmIGNvbmZpZ3VyZWRcclxuXHRcdHRoaXMucnVuQ29tbWFuZE9uT3BlbigpO1xyXG5cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTGFzdCB2aWV3IHJlZmVyZW5jZSBmb3IgcmV2ZXJ0VmlldyBmdW5jdGlvbmFsaXR5XHJcblx0ICovXHJcblx0cHJpdmF0ZSBsYXN0VmlldzogV2Vha1JlZjxNYXJrZG93blZpZXc+IHwgdW5kZWZpbmVkO1xyXG5cclxuXHQvKipcclxuXHQgKiBDb25maWd1cmUgdGhlIHZpZXcgbW9kZSBmb3IgYSBsZWFmXHJcblx0ICovXHJcblx0cHJpdmF0ZSBhc3luYyBjb25maWd1cmVWaWV3KGxlYWY6IFdvcmtzcGFjZUxlYWYsIGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcclxuXHJcblx0XHQvLyBPbmx5IGNvbmZpZ3VyZSB2aWV3IG1vZGUgZm9yIG1hcmtkb3duLWxpa2UgZmlsZXNcclxuXHRcdGlmICghaXNNYXJrZG93bkxpa2UoZmlsZSkgfHwgISh2aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgc3RhdGUgPSB2aWV3LmdldFN0YXRlKCk7XHJcblxyXG5cdFx0Ly8gVHJhY2sgdmlldyBmb3IgcmV2ZXJ0VmlldyBpZiBlbmFibGVkXHJcblx0XHRpZiAoc2V0dGluZ3MucmV2ZXJ0Vmlldykge1xyXG5cdFx0XHR0aGlzLmxhc3RWaWV3ID0gbmV3IFdlYWtSZWYodmlldyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tIGlmIGVuYWJsZWRcclxuXHRcdGlmIChzZXR0aW5ncy5hdXRvU2Nyb2xsKSB7XHJcblx0XHRcdGNvbnN0IGNvdW50ID0gdmlldy5lZGl0b3IubGluZUNvdW50KCk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoc3RhdGUubW9kZSA9PT0gJ3ByZXZpZXcnKSB7XHJcblx0XHRcdFx0dmlldy5wcmV2aWV3TW9kZS5hcHBseVNjcm9sbChjb3VudCAtIDQpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHZpZXcuZWRpdG9yLnNldEN1cnNvcihjb3VudCk7XHJcblx0XHRcdFx0dmlldy5lZGl0b3IuZm9jdXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNldCB2aWV3IG1vZGVcclxuXHRcdGlmIChzZXR0aW5ncy5vcGVuVmlld01vZGUgIT09ICdkZWZhdWx0Jykge1xyXG5cdFx0XHRzd2l0Y2ggKHNldHRpbmdzLm9wZW5WaWV3TW9kZSkge1xyXG5cdFx0XHRcdGNhc2UgJ3ByZXZpZXcnOlxyXG5cdFx0XHRcdFx0c3RhdGUubW9kZSA9ICdwcmV2aWV3JztcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgJ3NvdXJjZSc6XHJcblx0XHRcdFx0XHRzdGF0ZS5tb2RlID0gJ3NvdXJjZSc7XHJcblx0XHRcdFx0XHRzdGF0ZS5zb3VyY2UgPSB0cnVlO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnbGl2ZSc6XHJcblx0XHRcdFx0XHRzdGF0ZS5tb2RlID0gJ3NvdXJjZSc7XHJcblx0XHRcdFx0XHRzdGF0ZS5zb3VyY2UgPSBmYWxzZTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcblx0XHRcdFx0dHlwZTogJ21hcmtkb3duJyxcclxuXHRcdFx0XHRzdGF0ZTogc3RhdGUsXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmV2ZXJ0IHZpZXcgdG8gZGVmYXVsdCB3aGVuIG5hdmlnYXRpbmcgYXdheSBmcm9tIGhvbWUgYmFzZVxyXG5cdCAqL1xyXG5cdGFzeW5jIHJldmVydFZpZXcoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0aWYgKCFzZXR0aW5ncy5yZXZlcnRWaWV3IHx8ICF0aGlzLmxhc3RWaWV3IHx8IHNldHRpbmdzLm9wZW5WaWV3TW9kZSA9PT0gJ2RlZmF1bHQnKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCB2aWV3ID0gdGhpcy5sYXN0Vmlldy5kZXJlZigpO1xyXG5cdFx0aWYgKCF2aWV3KSB7XHJcblx0XHRcdHRoaXMubGFzdFZpZXcgPSB1bmRlZmluZWQ7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBob21lQmFzZVNldHRpbmdzID0gdGhpcy5wbHVnaW4uZ2V0SG9tZUJhc2VTZXR0aW5ncygpO1xyXG5cdFx0Y29uc3QgcmVzb2x2ZWRQYXRoID0gYXdhaXQgY29tcHV0ZUhvbWVCYXNlUGF0aChcclxuXHRcdFx0aG9tZUJhc2VTZXR0aW5ncy50eXBlLFxyXG5cdFx0XHRob21lQmFzZVNldHRpbmdzLnZhbHVlLFxyXG5cdFx0XHR0aGlzLnBsdWdpblxyXG5cdFx0KTtcclxuXHJcblx0XHRpZiAoIXJlc29sdmVkUGF0aCkge1xyXG5cdFx0XHR0aGlzLmxhc3RWaWV3ID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgd2UncmUgc3RpbGwgb24gdGhlIGhvbWUgYmFzZSBmaWxlXHJcblx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHZpZXcuZmlsZTtcclxuXHRcdGlmIChjdXJyZW50RmlsZSAmJiBlcXVhbHNDYXNlbGVzcyh0cmltRmlsZShjdXJyZW50RmlsZSksIHJlc29sdmVkUGF0aCkpIHtcclxuXHRcdFx0cmV0dXJuOyAvLyBTdGlsbCBvbiBob21lIGJhc2UsIGRvbid0IHJldmVydFxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFJldmVydCB0byBkZWZhdWx0IHZpZXdcclxuXHRcdGNvbnN0IHN0YXRlID0gdmlldy5nZXRTdGF0ZSgpO1xyXG5cdFx0IFxyXG5cdFx0Y29uc3QgY29uZmlnID0gKHRoaXMuYXBwLnZhdWx0IGFzIHVua25vd24gYXMgeyBjb25maWc/OiB7IGRlZmF1bHRWaWV3TW9kZT86IHN0cmluZzsgbGl2ZVByZXZpZXc/OiBib29sZWFuIH0gfSkuY29uZmlnO1xyXG5cdFx0Y29uc3QgbW9kZSA9IGNvbmZpZz8uZGVmYXVsdFZpZXdNb2RlIHx8ICdzb3VyY2UnO1xyXG5cdFx0Y29uc3Qgc291cmNlID0gY29uZmlnPy5saXZlUHJldmlldyAhPT0gdW5kZWZpbmVkID8gIWNvbmZpZy5saXZlUHJldmlldyA6IGZhbHNlO1xyXG5cclxuXHRcdGlmIChcclxuXHRcdFx0dmlldy5sZWFmLmdldFZpZXdTdGF0ZSgpLnR5cGUgPT09ICdtYXJrZG93bicgJiZcclxuXHRcdFx0KG1vZGUgIT09IHN0YXRlLm1vZGUgfHwgc291cmNlICE9PSBzdGF0ZS5zb3VyY2UpXHJcblx0XHQpIHtcclxuXHRcdFx0c3RhdGUubW9kZSA9IG1vZGU7XHJcblx0XHRcdHN0YXRlLnNvdXJjZSA9IHNvdXJjZTtcclxuXHRcdFx0YXdhaXQgdmlldy5sZWFmLnNldFZpZXdTdGF0ZSh7IHR5cGU6ICdtYXJrZG93bicsIHN0YXRlLCBhY3RpdmU6IHRydWUgfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5sYXN0VmlldyA9IHVuZGVmaW5lZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJ1biB0aGUgY29uZmlndXJlZCBjb21tYW5kIGFmdGVyIG9wZW5pbmdcclxuXHQgKi9cclxuXHRwcml2YXRlIHJ1bkNvbW1hbmRPbk9wZW4oKTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21tYW5kSWQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21tYW5kT25PcGVuO1xyXG5cdFx0aWYgKGNvbW1hbmRJZCkge1xyXG5cdFx0XHQvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgdGhlIHZpZXcgaXMgcmVhZHlcclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0ZXhlY3V0ZUNvbW1hbmQodGhpcy5hcHAsIGNvbW1hbmRJZCk7XHJcblx0XHRcdH0sIDEwMCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGaW5kIGFuIGV4aXN0aW5nIGxlYWYgdGhhdCBoYXMgdGhlIGhvbWUgYmFzZSBmaWxlIG9wZW5cclxuXHQgKi9cclxuXHRmaW5kRXhpc3RpbmdIb21lQmFzZUxlYWYoZmlsZT86IFRGaWxlKTogV29ya3NwYWNlTGVhZiB8IG51bGwge1xyXG5cdFx0aWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcclxuXHRcdGNvbnN0IGhvbWVCYXNlUGF0aCA9IGZpbGUucGF0aDtcclxuXHJcblx0XHRjb25zdCBsZWF2ZXMgPSBMRUFGX1RZUEVTLmZsYXRNYXAodHlwZSA9PiBcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh0eXBlKVxyXG5cdFx0KTtcclxuXHJcblx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcblx0XHRcdGlmIChsZWFmSGFzRmlsZShsZWFmLCBob21lQmFzZVBhdGgpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGxlYWY7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEZpbmQgdGhlIGdob3N0IHRhYiAodGhlIG9uZSBvcGVuZWQgdmlhIHN0aWNreSBpY29uKVxyXG5cdCAqIEdob3N0IHRhYiBpcyBpZGVudGlmaWVkIGJ5IGJlaW5nIHBpbm5lZCBhbmQgaGF2aW5nIHRoZSBob21lIGJhc2UgZmlsZVxyXG5cdCAqIE9ubHkgc2VhcmNoZXMgaW4gdGhlIGN1cnJlbnQgd2luZG93IChnZXRMZWF2ZXNPZlR5cGUgaXMgd2luZG93LXNjb3BlZClcclxuXHQgKiBcclxuXHQgKiBOb3RlOiBJZiB0aGUgZ2hvc3QgdGFiIGlzIG1vdmVkIHRvIGFub3RoZXIgd2luZG93LCB0aGlzIHdpbGwgcmV0dXJuIG51bGwsXHJcblx0ICogYW5kIGEgbmV3IGdob3N0IHRhYiB3aWxsIGJlIGNyZWF0ZWQgaW4gdGhlIGN1cnJlbnQgd2luZG93IHdoZW4gbmVlZGVkLlxyXG5cdCAqIFRoaXMgaXMgdGhlIGRlc2lyZWQgYmVoYXZpb3IgLSBlYWNoIHdpbmRvdyBjYW4gaGF2ZSBpdHMgb3duIGdob3N0IHRhYi5cclxuXHQgKiBcclxuXHQgKiBGb3IgcmFuZG9tIHR5cGVzLCB3ZSBkb24ndCBsb29rIGZvciBwaW5uZWQgdGFicyAodGhleSdyZSBub3QgcGlubmVkKS5cclxuXHQgKi9cclxuXHRmaW5kR2hvc3RUYWIoZmlsZT86IFRGaWxlLCBpc1JhbmRvbTogYm9vbGVhbiA9IGZhbHNlKTogV29ya3NwYWNlTGVhZiB8IG51bGwge1xyXG5cdFx0aWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcclxuXHRcdGNvbnN0IGhvbWVCYXNlUGF0aCA9IGZpbGUucGF0aDtcclxuXHJcblx0XHQvLyBnZXRMZWF2ZXNPZlR5cGUgb25seSByZXR1cm5zIGxlYXZlcyBpbiB0aGUgY3VycmVudCB3aW5kb3dcclxuXHRcdGNvbnN0IGxlYXZlcyA9IExFQUZfVFlQRVMuZmxhdE1hcCh0eXBlID0+IFxyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKHR5cGUpXHJcblx0XHQpO1xyXG5cclxuXHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcclxuXHRcdFx0aWYgKGxlYWZIYXNGaWxlKGxlYWYsIGhvbWVCYXNlUGF0aCkpIHtcclxuXHRcdFx0XHRjb25zdCB2aWV3U3RhdGUgPSBsZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG5cdFx0XHRcdC8vIEdob3N0IHRhYiBpcyBwaW5uZWQgKHVubGVzcyBpdCdzIHJhbmRvbSlcclxuXHRcdFx0XHRpZiAoaXNSYW5kb20gfHwgdmlld1N0YXRlLnBpbm5lZCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGxlYWY7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBPcGVuIGhvbWUgYmFzZSBpbiBnaG9zdCB0YWIgKGZvciBzdGlja3kgaWNvbilcclxuXHQgKiBHaG9zdCB0YWIgaXMgcGlubmVkIGFuZCBoaWRkZW4gKGlmIHNldHRpbmcgZW5hYmxlZClcclxuXHQgKiBPbmx5IG9uZSBnaG9zdCB0YWIgc2hvdWxkIGV4aXN0IGF0IGEgdGltZVxyXG5cdCAqIE9ubHkgd29ya3MgZm9yIGZpbGUtYmFzZWQgdHlwZXMgKG5vdCBXb3Jrc3BhY2UsIEdyYXBoLCBOb25lKVxyXG5cdCAqIE5vdGU6IFJhbmRvbSB0eXBlcyBkb24ndCBwaW4gKHNpbmNlIGZpbGUgY2hhbmdlcyBlYWNoIHRpbWUpXHJcblx0ICovXHJcblx0YXN5bmMgb3BlbkhvbWVCYXNlSW5HaG9zdFRhYihvcHRpb25zOiB7XHJcblx0XHRydW5Db21tYW5kPzogYm9vbGVhbjtcclxuXHR9ID0ge30pOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdGNvbnN0IHsgcnVuQ29tbWFuZCA9IHRydWUgfSA9IG9wdGlvbnM7XHJcblx0XHRjb25zdCBob21lQmFzZVNldHRpbmdzID0gdGhpcy5wbHVnaW4uZ2V0SG9tZUJhc2VTZXR0aW5ncygpO1xyXG5cclxuXHRcdC8vIEdob3N0IHRhYiBvbmx5IHdvcmtzIGZvciBmaWxlLWJhc2VkIHR5cGVzXHJcblx0XHRpZiAoaG9tZUJhc2VTZXR0aW5ncy50eXBlID09PSBIb21lQmFzZVR5cGUuV29ya3NwYWNlIHx8IFxyXG5cdFx0ICAgIGhvbWVCYXNlU2V0dGluZ3MudHlwZSA9PT0gSG9tZUJhc2VUeXBlLkdyYXBoIHx8IFxyXG5cdFx0ICAgIGhvbWVCYXNlU2V0dGluZ3MudHlwZSA9PT0gSG9tZUJhc2VUeXBlLk5vbmUpIHtcclxuXHRcdFx0Ly8gRm9yIG5vbi1maWxlIHR5cGVzLCBqdXN0IHVzZSBub3JtYWwgb3BlblxyXG5cdFx0XHRyZXR1cm4gdGhpcy5vcGVuSG9tZUJhc2VXaXRoTW9kZSgncmV0YWluJywgcnVuQ29tbWFuZCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gUmFuZG9tIHR5cGVzOiBkb24ndCB1c2UgZ2hvc3QgdGFiIChmaWxlIGNoYW5nZXMgZWFjaCB0aW1lKVxyXG5cdFx0Y29uc3QgaXNSYW5kb20gPSBob21lQmFzZVNldHRpbmdzLnR5cGUgPT09IEhvbWVCYXNlVHlwZS5SYW5kb20gfHwgXHJcblx0XHQgICAgICAgICAgICAgICAgIGhvbWVCYXNlU2V0dGluZ3MudHlwZSA9PT0gSG9tZUJhc2VUeXBlLlJhbmRvbUZvbGRlcjtcclxuXHJcblx0XHQvLyBDaGVjayBpZiBzZXR0aW5ncyBtb2RhbCBpcyBvcGVuXHJcblx0XHRpZiAodGhpcy5pc1NldHRpbmdzTW9kYWxPcGVuKCkpIHtcclxuXHRcdFx0Y29uc29sZS5kZWJ1ZygnSG9tZSBCYXNlOiBTZXR0aW5ncyBtb2RhbCBpcyBvcGVuLCBza2lwcGluZyBvcGVuSG9tZUJhc2VJbkdob3N0VGFiJyk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZXNvbHZlIHRoZSBhY3R1YWwgZmlsZSBwYXRoIGJhc2VkIG9uIHR5cGVcclxuXHRcdGNvbnN0IHJlc29sdmVkUGF0aCA9IGF3YWl0IGNvbXB1dGVIb21lQmFzZVBhdGgoXHJcblx0XHRcdGhvbWVCYXNlU2V0dGluZ3MudHlwZSxcclxuXHRcdFx0aG9tZUJhc2VTZXR0aW5ncy52YWx1ZSxcclxuXHRcdFx0dGhpcy5wbHVnaW5cclxuXHRcdCk7XHJcblx0XHRcclxuXHRcdGlmICghcmVzb2x2ZWRQYXRoKSB7XHJcblx0XHRcdGNvbnNvbGUuZGVidWcoYEhvbWUgQmFzZTogQ291bGQgbm90IHJlc29sdmUgcGF0aCBmb3IgdHlwZSAke2hvbWVCYXNlU2V0dGluZ3MudHlwZX1gKTtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdldCB0aGUgaG9tZSBiYXNlIGZpbGVcclxuXHRcdGNvbnN0IGZpbGUgPSBnZXRGaWxlQnlQYXRoKHRoaXMuYXBwLCByZXNvbHZlZFBhdGgpO1xyXG5cdFx0aWYgKCFmaWxlKSB7XHJcblx0XHRcdGNvbnNvbGUuZGVidWcoYEhvbWUgQmFzZTogRmlsZSBub3QgZm91bmQ6ICR7cmVzb2x2ZWRQYXRofWApO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgZ2hvc3QgdGFiIGFscmVhZHkgZXhpc3RzXHJcblx0XHRjb25zdCBnaG9zdFRhYiA9IHRoaXMuZmluZEdob3N0VGFiKGZpbGUsIGlzUmFuZG9tKTtcclxuXHRcdFxyXG5cdFx0aWYgKGdob3N0VGFiKSB7XHJcblx0XHRcdC8vIEdob3N0IHRhYiBleGlzdHMgLSBqdXN0IGZvY3VzIGl0XHJcblx0XHRcdGNvbnN0IHNob3VsZEZvY3VzID0gIXRoaXMuaXNTZXR0aW5nc01vZGFsT3BlbigpO1xyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihnaG9zdFRhYiwgeyBmb2N1czogc2hvdWxkRm9jdXMgfSk7XHJcblx0XHRcdGF3YWl0IHRoaXMuY29uZmlndXJlVmlldyhnaG9zdFRhYiwgZmlsZSk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAocnVuQ29tbWFuZCkge1xyXG5cdFx0XHRcdHRoaXMucnVuQ29tbWFuZE9uT3BlbigpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdob3N0IHRhYiBkb2Vzbid0IGV4aXN0IC0gY3JlYXRlIGl0XHJcblx0XHQvLyBDbG9zZSBhbnkgb3RoZXIgZ2hvc3QgdGFicyBmaXJzdCAoc2hvdWxkbid0IGhhcHBlbiwgYnV0IGp1c3QgaW4gY2FzZSlcclxuXHRcdGNvbnN0IGFsbExlYXZlcyA9IExFQUZfVFlQRVMuZmxhdE1hcCh0eXBlID0+IFxyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKHR5cGUpXHJcblx0XHQpO1xyXG5cdFx0Zm9yIChjb25zdCBsZWFmIG9mIGFsbExlYXZlcykge1xyXG5cdFx0XHRpZiAobGVhZkhhc0ZpbGUobGVhZiwgcmVzb2x2ZWRQYXRoKSkge1xyXG5cdFx0XHRcdGNvbnN0IHZpZXdTdGF0ZSA9IGxlYWYuZ2V0Vmlld1N0YXRlKCk7XHJcblx0XHRcdFx0aWYgKHZpZXdTdGF0ZS5waW5uZWQgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdC8vIFRoaXMgaXMgYW4gb2xkIGdob3N0IHRhYiwgY2xvc2UgaXRcclxuXHRcdFx0XHRcdHZvaWQgbGVhZi5kZXRhY2goKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBDcmVhdGUgbmV3IGdob3N0IHRhYlxyXG5cdFx0Y29uc3QgbmV3R2hvc3RUYWIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcblx0XHRhd2FpdCBuZXdHaG9zdFRhYi5vcGVuRmlsZShmaWxlKTtcclxuXHRcdFxyXG5cdFx0Ly8gUGluIHRoZSBnaG9zdCB0YWIgKHVubGVzcyBpdCdzIHJhbmRvbSAtIGZpbGUgY2hhbmdlcyBlYWNoIHRpbWUpXHJcblx0XHRpZiAoIWlzUmFuZG9tKSB7XHJcblx0XHRcdG5ld0dob3N0VGFiLnNldFBpbm5lZCh0cnVlKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gRm9jdXMgaXRcclxuXHRcdGNvbnN0IHNob3VsZEZvY3VzID0gIXRoaXMuaXNTZXR0aW5nc01vZGFsT3BlbigpO1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobmV3R2hvc3RUYWIsIHsgZm9jdXM6IHNob3VsZEZvY3VzIH0pO1xyXG5cdFx0XHJcblx0XHQvLyBDb25maWd1cmUgdGhlIHZpZXdcclxuXHRcdGF3YWl0IHRoaXMuY29uZmlndXJlVmlldyhuZXdHaG9zdFRhYiwgZmlsZSk7XHJcblxyXG5cdFx0Ly8gUnVuIGNvbW1hbmQgaWYgY29uZmlndXJlZFxyXG5cdFx0aWYgKHJ1bkNvbW1hbmQpIHtcclxuXHRcdFx0dGhpcy5ydW5Db21tYW5kT25PcGVuKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGaW5kIGFuIGVtcHR5IGxlYWZcclxuXHQgKi9cclxuXHRwcml2YXRlIGZpbmRFbXB0eUxlYWYoKTogV29ya3NwYWNlTGVhZiB8IG51bGwge1xyXG5cdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZW1wdHknKTtcclxuXHRcdHJldHVybiBsZWF2ZXNbMF0gfHwgbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldCB0aGUgaG9tZSBiYXNlIGZpbGVcclxuXHQgKi9cclxuXHRnZXRIb21lQmFzZUZpbGUoKTogVEZpbGUgfCBudWxsIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRpZiAoIXNldHRpbmdzLmhvbWVCYXNlUGF0aCkge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdHJldHVybiBnZXRGaWxlQnlQYXRoKHRoaXMuYXBwLCBzZXR0aW5ncy5ob21lQmFzZVBhdGgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRmFzdCBkZXRhY2ggYWxsIGxlYXZlcyB1c2luZyBjaGFuZ2VMYXlvdXQgKGxpa2UgaG9tZXBhZ2UgcGx1Z2luKVxyXG5cdCAqIFRoaXMgaXMgbXVjaCBmYXN0ZXIgdGhhbiBpdGVyYXRpbmcgYW5kIGRldGFjaGluZyBsZWF2ZXMgaW5kaXZpZHVhbGx5XHJcblx0ICovXHJcblx0YXN5bmMgZGV0YWNoQWxsTGVhdmVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Y29uc3QgbGF5b3V0ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExheW91dCgpO1xyXG5cdFx0bGF5b3V0Lm1haW4gPSB7XHJcblx0XHRcdFwiaWRcIjogXCI1MzI0MzczMDE1NzI2YmE4XCIsXHJcblx0XHRcdFwidHlwZVwiOiBcInNwbGl0XCIsXHJcblx0XHRcdFwiY2hpbGRyZW5cIjogW3sgXHJcblx0XHRcdFx0XCJpZFwiOiBcIjQ1MDk3MjRmOGJmODRkYTdcIixcclxuXHRcdFx0XHRcInR5cGVcIjogXCJ0YWJzXCIsXHJcblx0XHRcdFx0XCJjaGlsZHJlblwiOiBbe1xyXG5cdFx0XHRcdFx0XCJpZFwiOiBcImU3YTdiMzAzYzYxNzg2ZGNcIixcclxuXHRcdFx0XHRcdFwidHlwZVwiOiBcImxlYWZcIixcclxuXHRcdFx0XHRcdFwic3RhdGVcIjoge1widHlwZVwiOiBcImVtcHR5XCIsIFwic3RhdGVcIjoge30sIFwiaWNvblwiOiBcImx1Y2lkZS1maWxlXCIsIFwidGl0bGVcIjogXCJOZXcgdGFiXCJ9XHJcblx0XHRcdFx0fV1cclxuXHRcdFx0fV0sXHJcblx0XHRcdFwiZGlyZWN0aW9uXCI6IFwidmVydGljYWxcIlxyXG5cdFx0fTtcclxuXHRcdGxheW91dC5hY3RpdmUgPSBcImU3YTdiMzAzYzYxNzg2ZGNcIjtcclxuXHRcdGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5jaGFuZ2VMYXlvdXQobGF5b3V0KTtcclxuXHRcdFxyXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdCBcclxuXHRcdFx0KHRoaXMuYXBwLndvcmtzcGFjZS5yaWdodFNwbGl0IGFzIHsgdXBkYXRlSW5mbz86ICgpID0+IHZvaWQgfSk/LnVwZGF0ZUluZm8/LigpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2xvc2UgYWxsIGxlYXZlcyBpbiB0aGUgbWFpbiB3b3Jrc3BhY2UgZXhjZXB0IHRoZSBzcGVjaWZpZWQgb25lXHJcblx0ICogU2ltcGxpZmllZCBhcHByb2FjaDogaXRlcmF0ZSBhbGwgbGVhdmVzIGFuZCBjbG9zZSB0aG9zZSBpbiBtYWluIHdvcmtzcGFjZVxyXG5cdCAqL1xyXG5cdGFzeW5jIGNsb3NlQWxsTGVhdmVzRXhjZXB0KGV4Y2VwdExlYWY6IFdvcmtzcGFjZUxlYWYgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHQvLyBVc2UgaXRlcmF0ZUFsbExlYXZlcyB0byBnZXQgQUxMIGxlYXZlc1xyXG5cdFx0Y29uc3QgbGVhdmVzVG9DbG9zZTogV29ya3NwYWNlTGVhZltdID0gW107XHJcblx0XHRcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKChsZWFmKSA9PiB7XHJcblx0XHRcdC8vIFNraXAgdGhlIGV4Y2VwdGlvbiBsZWFmXHJcblx0XHRcdGlmIChsZWFmID09PSBleGNlcHRMZWFmKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBUcnkgdG8gZGV0ZXJtaW5lIGlmIHRoaXMgaXMgYSBtYWluIHdvcmtzcGFjZSBsZWFmXHJcblx0XHRcdC8vIEdldCB0aGUgdmlldydzIGNvbnRhaW5lciBlbGVtZW50XHJcblx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XHJcblx0XHRcdGxldCBjb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAodmlldykge1xyXG5cdFx0XHRcdGNvbnN0IHZpZXdBbnkgPSB2aWV3IGFzIHVua25vd24gYXMgeyBjb250YWluZXJFbD86IEhUTUxFbGVtZW50IH07XHJcblx0XHRcdFx0Y29udGFpbmVyID0gdmlld0FueS5jb250YWluZXJFbCB8fCBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBJZiBubyBjb250YWluZXIgZnJvbSB2aWV3LCB0cnkgbGVhZidzIGNvbnRhaW5lckVsXHJcblx0XHRcdGlmICghY29udGFpbmVyKSB7XHJcblx0XHRcdFx0Y29uc3QgbGVhZkFueSA9IGxlYWYgYXMgdW5rbm93biBhcyB7IGNvbnRhaW5lckVsPzogSFRNTEVsZW1lbnQgfTtcclxuXHRcdFx0XHRjb250YWluZXIgPSBsZWFmQW55LmNvbnRhaW5lckVsIHx8IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmIChjb250YWluZXIpIHtcclxuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGluIHRoZSBtYWluIHdvcmtzcGFjZSAocm9vdCwgbm90IHNpZGViYXIpXHJcblx0XHRcdFx0Y29uc3Qgcm9vdFdvcmtzcGFjZSA9IGNvbnRhaW5lci5jbG9zZXN0KCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCcpO1xyXG5cdFx0XHRcdGNvbnN0IGxlZnRTaWRlYmFyID0gY29udGFpbmVyLmNsb3Nlc3QoJy53b3Jrc3BhY2Utc3BsaXQubW9kLWxlZnQtc3BsaXQnKTtcclxuXHRcdFx0XHRjb25zdCByaWdodFNpZGViYXIgPSBjb250YWluZXIuY2xvc2VzdCgnLndvcmtzcGFjZS1zcGxpdC5tb2QtcmlnaHQtc3BsaXQnKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAocm9vdFdvcmtzcGFjZSAmJiAhbGVmdFNpZGViYXIgJiYgIXJpZ2h0U2lkZWJhcikge1xyXG5cdFx0XHRcdFx0bGVhdmVzVG9DbG9zZS5wdXNoKGxlYWYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBJZiB3ZSBjYW4ndCBmaW5kIGNvbnRhaW5lciwgc3RpbGwgdHJ5IHRvIGNsb3NlIGl0IGlmIGl0J3MgaW4gbWFpbiB3b3Jrc3BhY2VcclxuXHRcdFx0XHQvLyBUaGlzIGhhbmRsZXMgZWRnZSBjYXNlcyB3aGVyZSBjb250YWluZXIgZGV0ZWN0aW9uIGZhaWxzXHJcblx0XHRcdFx0Ly8gT25seSBjbG9zZSBpZiB3ZSdyZSBjbG9zaW5nIGV2ZXJ5dGhpbmcgKGV4Y2VwdExlYWYgaXMgbnVsbClcclxuXHRcdFx0XHRpZiAoZXhjZXB0TGVhZiA9PT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0Ly8gVHJ5IHRvIGdldCBsZWFmJ3MgdmlldyBzdGF0ZSB0byBjaGVjayBpZiBpdCdzIGEgbWFpbiB3b3Jrc3BhY2UgdGFiXHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCB2aWV3U3RhdGUgPSBsZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG5cdFx0XHRcdFx0XHQvLyBJZiBpdCBoYXMgYSB2aWV3IHN0YXRlLCBpdCdzIGxpa2VseSBhIG1haW4gd29ya3NwYWNlIHRhYlxyXG5cdFx0XHRcdFx0XHRpZiAodmlld1N0YXRlKSB7XHJcblx0XHRcdFx0XHRcdFx0bGVhdmVzVG9DbG9zZS5wdXNoKGxlYWYpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGNhdGNoIHtcclxuXHRcdFx0XHRcdFx0Ly8gSWYgd2UgY2FuJ3QgZ2V0IHZpZXcgc3RhdGUsIHNraXAgaXRcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHRjb25zb2xlLmRlYnVnKGBIb21lIEJhc2U6IENsb3NpbmcgJHtsZWF2ZXNUb0Nsb3NlLmxlbmd0aH0gdGFic2ApO1xyXG5cdFx0XHJcblx0XHQvLyBDbG9zZSBhbGwgaWRlbnRpZmllZCBsZWF2ZXNcclxuXHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXNUb0Nsb3NlKSB7XHJcblx0XHRcdHZvaWQgbGVhZi5kZXRhY2goKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gV2FpdCBmb3IgZGV0YWNobWVudHMgdG8gY29tcGxldGVcclxuXHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIHRoZSBmb2N1c2VkIHRhYiBpcyB0aGUgaG9tZSBiYXNlXHJcblx0ICovXHJcblx0aXNGb2N1c2VkT25Ib21lQmFzZSgpOiBib29sZWFuIHtcclxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cdFx0aWYgKCFhY3RpdmVGaWxlKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0Y29uc3QgaG9tZUJhc2VQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaG9tZUJhc2VQYXRoO1xyXG5cdFx0aWYgKCFob21lQmFzZVBhdGgpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHQvLyBHZXQgdGhlIGhvbWUgYmFzZSBmaWxlIGZvciBhY2N1cmF0ZSBjb21wYXJpc29uXHJcblx0XHRjb25zdCBob21lQmFzZUZpbGUgPSBnZXRGaWxlQnlQYXRoKHRoaXMuYXBwLCBob21lQmFzZVBhdGgpO1xyXG5cdFx0aWYgKCFob21lQmFzZUZpbGUpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4gYWN0aXZlRmlsZS5wYXRoID09PSBob21lQmFzZUZpbGUucGF0aDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIGhvbWUgYmFzZSBmaWxlIGV4aXN0c1xyXG5cdCAqL1xyXG5cdGhvbWVCYXNlRXhpc3RzKCk6IGJvb2xlYW4ge1xyXG5cdFx0Y29uc3QgcGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlUGF0aDtcclxuXHRcdGlmICghcGF0aCkgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gZ2V0RmlsZUJ5UGF0aCh0aGlzLmFwcCwgcGF0aCkgIT09IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVjayBpZiB0aGUgc2V0dGluZ3MgbW9kYWwgaXMgY3VycmVudGx5IG9wZW5cclxuXHQgKi9cclxuXHRwcml2YXRlIGlzU2V0dGluZ3NNb2RhbE9wZW4oKTogYm9vbGVhbiB7XHJcblx0XHQvLyBDaGVjayBmb3Igc2V0dGluZ3MgbW9kYWwgYnkgbG9va2luZyBmb3IgdGhlIG1vZGFsIGNvbnRhaW5lclxyXG5cdFx0Ly8gVHJ5IG11bHRpcGxlIHNlbGVjdG9ycyB0byBiZSBtb3JlIHJvYnVzdFxyXG5cdFx0Y29uc3Qgc2V0dGluZ3NNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXIubW9kLXNldHRpbmdzJykgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwubW9kLXNldHRpbmdzJykgfHxcclxuXHRcdCAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmVydGljYWwtdGFiLWNvbnRlbnQnKTtcclxuXHRcdFxyXG5cdFx0Ly8gQWxzbyBjaGVjayBpZiBhbnkgbW9kYWwgaXMgb3BlbiBhbmQgY29udGFpbnMgc2V0dGluZ3MgY29udGVudFxyXG5cdFx0aWYgKCFzZXR0aW5nc01vZGFsKSB7XHJcblx0XHRcdGNvbnN0IGFsbE1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbC1jb250YWluZXInKTtcclxuXHRcdFx0Zm9yIChjb25zdCBtb2RhbCBvZiBBcnJheS5mcm9tKGFsbE1vZGFscykpIHtcclxuXHRcdFx0XHRpZiAobW9kYWwucXVlcnlTZWxlY3RvcignLnZlcnRpY2FsLXRhYi1jb250ZW50JykgfHwgXHJcblx0XHRcdFx0ICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5ncy1jb250ZW50JykgfHxcclxuXHRcdFx0XHQgICAgbW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2Qtc2V0dGluZ3MnKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiBzZXR0aW5nc01vZGFsICE9PSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2V0IHRoZSBhY3RpdmUgZmlsZSBhcyBob21lIGJhc2VcclxuXHQgKi9cclxuXHRhc3luYyBzZXRBY3RpdmVGaWxlQXNIb21lQmFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cdFx0aWYgKCFhY3RpdmVGaWxlKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGZpbGUgdHlwZSBpcyBzdXBwb3J0ZWRcclxuXHRcdGlmICghaXNTdXBwb3J0ZWRFeHRlbnNpb24oYWN0aXZlRmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKSkpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlUGF0aCA9IGFjdGl2ZUZpbGUucGF0aDtcclxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVjayBpZiBhY3RpdmUgZmlsZSBjYW4gYmUgc2V0IGFzIGhvbWUgYmFzZVxyXG5cdCAqL1xyXG5cdGNhblNldEFjdGl2ZUZpbGVBc0hvbWVCYXNlKCk6IGJvb2xlYW4ge1xyXG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRpZiAoIWFjdGl2ZUZpbGUpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4gaXNTdXBwb3J0ZWRFeHRlbnNpb24oYWN0aXZlRmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKSk7XHJcblx0fVxyXG59XHJcbiIsICIvKipcclxuICogSG9tZSBCYXNlIFR5cGUgUmVzb2x1dGlvbiBVdGlsaXRpZXNcclxuICogUmVzb2x2ZXMgaG9tZSBiYXNlIHBhdGhzIGJhc2VkIG9uIHR5cGUgKEZpbGUsIFdvcmtzcGFjZSwgUmFuZG9tLCBldGMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEhvbWVCYXNlVHlwZSB9IGZyb20gJy4uL3NldHRpbmdzJztcclxuaW1wb3J0IHR5cGUgSG9tZUJhc2VQbHVnaW4gZnJvbSAnLi4vbWFpbic7XHJcblxyXG4vKipcclxuICogR2V0IGEgcmFuZG9tIGZpbGUgZnJvbSB0aGUgdmF1bHRcclxuICovXHJcbmZ1bmN0aW9uIHJhbmRvbUZpbGUoYXBwOiBBcHAsIHJvb3Q/OiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xyXG5cdGxldCBmaWxlcyA9IGFwcC52YXVsdC5nZXRGaWxlcygpO1xyXG5cdFxyXG5cdGlmIChyb290KSB7XHJcblx0XHRjb25zdCByZXNvbHZlZFJvb3QgPSBhcHAudmF1bHQuZ2V0Rm9sZGVyQnlQYXRoKHJvb3QpO1xyXG5cdFx0aWYgKCFyZXNvbHZlZFJvb3QpIHJldHVybiBudWxsO1xyXG5cdFx0ZmlsZXMgPSBnZXRGaWxlc0luRm9sZGVyKHJlc29sdmVkUm9vdCk7XHJcblx0fVxyXG5cclxuXHRmaWxlcyA9IGZpbGVzLmZpbHRlcigoZjogVEZpbGUpID0+IFsnbWQnLCAnY2FudmFzJywgJ2Jhc2UnXS5pbmNsdWRlcyhmLmV4dGVuc2lvbikpO1xyXG5cdFxyXG5cdGlmIChmaWxlcy5sZW5ndGgpIHtcclxuXHRcdGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZmlsZXMubGVuZ3RoKTtcclxuXHRcdHJldHVybiBmaWxlc1tpbmRleF0gfHwgbnVsbDtcclxuXHR9XHJcblxyXG5cdHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGFsbCBmaWxlcyBpbiBhIGZvbGRlciByZWN1cnNpdmVseVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0RmlsZXNJbkZvbGRlcihmb2xkZXI6IFRGb2xkZXIpOiBURmlsZVtdIHtcclxuXHRsZXQgZmlsZXM6IFRGaWxlW10gPSBbXTtcclxuXHRcclxuXHRmb3IgKGNvbnN0IGl0ZW0gb2YgZm9sZGVyLmNoaWxkcmVuKSB7XHJcblx0XHRpZiAoaXRlbSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdGZpbGVzLnB1c2goaXRlbSk7XHJcblx0XHR9IGVsc2UgaWYgKGl0ZW0gaW5zdGFuY2VvZiBURm9sZGVyKSB7XHJcblx0XHRcdGZpbGVzLnB1c2goLi4uZ2V0RmlsZXNJbkZvbGRlcihpdGVtKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHJldHVybiBmaWxlcztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRyaW0gZmlsZSBleHRlbnNpb24gZm9yIC5tZCBmaWxlcyAobGlrZSBob21lcGFnZSBwbHVnaW4pXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdHJpbUZpbGUoZmlsZTogVEZpbGUpOiBzdHJpbmcge1xyXG5cdGlmICghZmlsZSkgcmV0dXJuICcnO1xyXG5cdHJldHVybiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyA/IGZpbGUucGF0aC5zbGljZSgwLCAtMykgOiBmaWxlLnBhdGg7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogR2V0IHBlcmlvZGljIG5vdGUgcGF0aCAoRGFpbHksIFdlZWtseSwgTW9udGhseSwgWWVhcmx5KVxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UGVyaW9kaWNOb3RlKGtpbmQ6IEhvbWVCYXNlVHlwZSwgcGx1Z2luOiBIb21lQmFzZVBsdWdpbik6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG5cdCBcclxuXHRjb25zdCBwZXJpb2RpY05vdGVzID0gcGx1Z2luLmFwcC5wbHVnaW5zPy5wbHVnaW5zPy5bJ3BlcmlvZGljLW5vdGVzJ107XHJcblx0aWYgKCFwZXJpb2RpY05vdGVzKSB7XHJcblx0XHQvLyBUcnkgZGFpbHkgbm90ZXMgcGx1Z2luXHJcblx0XHQgXHJcblx0XHRpZiAoa2luZCA9PT0gSG9tZUJhc2VUeXBlLkRhaWx5Tm90ZSAmJiBwbHVnaW4uYXBwLmludGVybmFsUGx1Z2lucz8ucGx1Z2lucz8uWydkYWlseS1ub3RlcyddPy5lbmFibGVkKSB7XHJcblx0XHRcdCBcclxuXHRcdFx0Y29uc3QgZGFpbHlOb3RlcyA9IHBsdWdpbi5hcHAuaW50ZXJuYWxQbHVnaW5zLnBsdWdpbnNbJ2RhaWx5LW5vdGVzJ10uaW5zdGFuY2U7XHJcblx0XHRcdGlmIChkYWlseU5vdGVzICYmIHdpbmRvdy5tb21lbnQpIHtcclxuXHRcdFx0XHRjb25zdCB0b2RheSA9IHdpbmRvdy5tb21lbnQoKTtcclxuXHRcdFx0XHQgXHJcblx0XHRcdFx0Y29uc3QgcGF0aCA9IGRhaWx5Tm90ZXMuZ2V0RGFpbHlOb3RlUGF0aD8uKHRvZGF5KTtcclxuXHRcdFx0XHQgXHJcblx0XHRcdFx0cmV0dXJuIHBhdGggPyBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sICcnKSA6IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0Ly8gVXNlIGRhaWx5LW5vdGVzLWludGVyZmFjZSBpZiBhdmFpbGFibGVcclxuXHR0cnkge1xyXG5cdFx0Ly8gRHluYW1pYyBpbXBvcnQgd2l0aCBlcnJvciBoYW5kbGluZyAtIHRoaXMgbW9kdWxlIG1heSBub3QgZXhpc3RcclxuXHRcdC8vIEB0cy1leHBlY3QtZXJyb3IgLSBvcHRpb25hbCBkZXBlbmRlbmN5IHRoYXQgbWF5IG5vdCBiZSBpbnN0YWxsZWRcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdGNvbnN0IGRhaWx5Tm90ZXNNb2R1bGUgPSBhd2FpdCBpbXBvcnQoJ29ic2lkaWFuLWRhaWx5LW5vdGVzLWludGVyZmFjZScpLmNhdGNoKCgpID0+IG51bGwpO1xyXG5cdFx0aWYgKCFkYWlseU5vdGVzTW9kdWxlKSB7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XHJcblx0XHRjb25zdCB7IFxyXG5cdFx0XHRjcmVhdGVEYWlseU5vdGUsIGdldERhaWx5Tm90ZSwgZ2V0QWxsRGFpbHlOb3RlcyxcclxuXHRcdFx0Y3JlYXRlV2Vla2x5Tm90ZSwgZ2V0V2Vla2x5Tm90ZSwgZ2V0QWxsV2Vla2x5Tm90ZXMsXHJcblx0XHRcdGNyZWF0ZU1vbnRobHlOb3RlLCBnZXRNb250aGx5Tm90ZSwgZ2V0QWxsTW9udGhseU5vdGVzLFxyXG5cdFx0XHRjcmVhdGVZZWFybHlOb3RlLCBnZXRZZWFybHlOb3RlLCBnZXRBbGxZZWFybHlOb3Rlc1xyXG5cdFx0fSA9IGRhaWx5Tm90ZXNNb2R1bGU7XHJcblx0XHRcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxyXG5cdFx0Y29uc3QgaW5mbzogUmVjb3JkPHN0cmluZywgeyBub3VuOiBzdHJpbmc7IGNyZWF0ZTogKGRhdGU6IG1vbWVudC5Nb21lbnQpID0+IFByb21pc2U8VEZpbGU+OyBnZXQ6IChkYXRlOiBtb21lbnQuTW9tZW50LCBhbGw6IFJlY29yZDxzdHJpbmcsIFRGaWxlPikgPT4gVEZpbGUgfCBudWxsOyBnZXRBbGw6ICgpID0+IFJlY29yZDxzdHJpbmcsIFRGaWxlPiB9PiA9IHtcclxuXHRcdFx0W0hvbWVCYXNlVHlwZS5EYWlseU5vdGVdOiB7XHJcblx0XHRcdFx0bm91bjogJ2RheScsXHJcblx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxyXG5cdFx0XHRcdGNyZWF0ZTogY3JlYXRlRGFpbHlOb3RlLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRnZXQ6IGdldERhaWx5Tm90ZSxcclxuXHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XHJcblx0XHRcdFx0Z2V0QWxsOiBnZXRBbGxEYWlseU5vdGVzLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHRbSG9tZUJhc2VUeXBlLldlZWtseU5vdGVdOiB7XHJcblx0XHRcdFx0bm91bjogJ3dlZWsnLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRjcmVhdGU6IGNyZWF0ZVdlZWtseU5vdGUsXHJcblx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxyXG5cdFx0XHRcdGdldDogZ2V0V2Vla2x5Tm90ZSxcclxuXHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XHJcblx0XHRcdFx0Z2V0QWxsOiBnZXRBbGxXZWVrbHlOb3RlcyxcclxuXHRcdFx0fSxcclxuXHRcdFx0W0hvbWVCYXNlVHlwZS5Nb250aGx5Tm90ZV06IHtcclxuXHRcdFx0XHRub3VuOiAnbW9udGgnLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRjcmVhdGU6IGNyZWF0ZU1vbnRobHlOb3RlLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRnZXQ6IGdldE1vbnRobHlOb3RlLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRnZXRBbGw6IGdldEFsbE1vbnRobHlOb3RlcyxcclxuXHRcdFx0fSxcclxuXHRcdFx0W0hvbWVCYXNlVHlwZS5ZZWFybHlOb3RlXToge1xyXG5cdFx0XHRcdG5vdW46ICd5ZWFyJyxcclxuXHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XHJcblx0XHRcdFx0Y3JlYXRlOiBjcmVhdGVZZWFybHlOb3RlLFxyXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcclxuXHRcdFx0XHRnZXQ6IGdldFllYXJseU5vdGUsXHJcblx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxyXG5cdFx0XHRcdGdldEFsbDogZ2V0QWxsWWVhcmx5Tm90ZXMsXHJcblx0XHRcdH0sXHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHQgXHJcblx0XHRjb25zdCBraW5kSW5mbyA9IGluZm9ba2luZF07XHJcblx0XHRpZiAoIWtpbmRJbmZvIHx8ICF3aW5kb3cubW9tZW50KSByZXR1cm4gbnVsbDtcclxuXHRcdFxyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXHJcblx0XHRjb25zdCBkYXRlID0gd2luZG93Lm1vbWVudCgpLnN0YXJ0T2Yoa2luZEluZm8ubm91biBhcyBtb21lbnQudW5pdE9mVGltZS5TdGFydE9mKTtcclxuXHRcdCBcclxuXHRcdGNvbnN0IGFsbCA9IGtpbmRJbmZvLmdldEFsbCgpO1xyXG5cdFx0XHJcblx0XHQgXHJcblx0XHRsZXQgbm90ZTogVEZpbGUgfCBudWxsID0gbnVsbDtcclxuXHRcdGlmICghT2JqZWN0LmtleXMoYWxsKS5sZW5ndGgpIHtcclxuXHRcdFx0IFxyXG5cdFx0XHRub3RlID0gYXdhaXQga2luZEluZm8uY3JlYXRlKGRhdGUpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0IFxyXG5cdFx0XHRub3RlID0ga2luZEluZm8uZ2V0KGRhdGUsIGFsbCkgfHwgYXdhaXQga2luZEluZm8uY3JlYXRlKGRhdGUpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQgXHJcblx0XHRpZiAoIW5vdGUpIG5vdGUgPSBraW5kSW5mby5nZXQoZGF0ZSwgYWxsKTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIG5vdGUgPyB0cmltRmlsZShub3RlKSA6IG51bGw7XHJcblx0fSBjYXRjaCB7XHJcblx0XHQvLyBGYWxsYmFjayBpZiBkYWlseS1ub3Rlcy1pbnRlcmZhY2Ugbm90IGF2YWlsYWJsZVxyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGpvdXJuYWwgbm90ZSBwYXRoXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRKb3VybmFsTm90ZShqb3VybmFsTmFtZTogc3RyaW5nLCBwbHVnaW46IEhvbWVCYXNlUGx1Z2luKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcblx0IFxyXG5cdGNvbnN0IGpvdXJuYWxzID0gcGx1Z2luLmFwcC5wbHVnaW5zPy5wbHVnaW5zPy5bJ2pvdXJuYWxzJ107XHJcblx0aWYgKCFqb3VybmFscykgcmV0dXJuIG51bGw7XHJcblx0XHJcblx0dHJ5IHtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MsIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuXHRcdGNvbnN0IGpvdXJuYWwgPSBqb3VybmFscy5qb3VybmFscz8uZmluZCgoajogYW55KSA9PiBqLm5hbWUgPT09IGpvdXJuYWxOYW1lKTtcclxuXHRcdGlmICgham91cm5hbCkgcmV0dXJuIG51bGw7XHJcblx0XHRcclxuXHRcdC8vIFRyaWdnZXIgYXV0by1jcmVhdGUgaWYgbmVlZGVkXHJcblx0XHQgXHJcblx0XHRqb3VybmFscy5yZXByb2Nlc3NOb3Rlcz8uKCk7XHJcblx0XHQgXHJcblx0XHRjb25zdCBvcmlnQXV0b0NyZWF0ZSA9IGpvdXJuYWwuY29uZmlnPy52YWx1ZT8uYXV0b0NyZWF0ZTtcclxuXHRcdCBcclxuXHRcdGlmIChqb3VybmFsLmNvbmZpZz8udmFsdWUpIHtcclxuXHRcdFx0IFxyXG5cdFx0XHRqb3VybmFsLmNvbmZpZy52YWx1ZS5hdXRvQ3JlYXRlID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdCBcclxuXHRcdGF3YWl0IGpvdXJuYWwuYXV0b0NyZWF0ZT8uKCk7XHJcblx0XHQgXHJcblx0XHRpZiAoam91cm5hbC5jb25maWc/LnZhbHVlKSB7XHJcblx0XHRcdCBcclxuXHRcdFx0am91cm5hbC5jb25maWcudmFsdWUuYXV0b0NyZWF0ZSA9IG9yaWdBdXRvQ3JlYXRlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRpZiAoIXdpbmRvdy5tb21lbnQpIHJldHVybiBudWxsO1xyXG5cdFx0IFxyXG5cdFx0Y29uc3QgdG9kYXkgPSB3aW5kb3cubW9tZW50KCkubG9jYWxlKCdjdXN0b20tam91cm5hbC1sb2NhbGUnKS5zdGFydE9mKCdkYXknKTtcclxuXHRcdCBcclxuXHRcdGNvbnN0IG5vdGUgPSBqb3VybmFsLmdldD8uKHRvZGF5KTtcclxuXHRcdGlmICghbm90ZSkgcmV0dXJuIG51bGw7XHJcblx0XHRcclxuXHRcdCBcclxuXHRcdGNvbnN0IHBhdGggPSBqb3VybmFsLmdldE5vdGVQYXRoPy4obm90ZSk7XHJcblx0XHQgXHJcblx0XHRyZXR1cm4gcGF0aCA/IHBhdGgucmVwbGFjZSgvXFwubWQkLywgJycpIDogbnVsbDtcclxuXHR9IGNhdGNoIHtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENvbXB1dGUgdGhlIGFjdHVhbCBmaWxlIHBhdGggYmFzZWQgb24gaG9tZSBiYXNlIHR5cGVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21wdXRlSG9tZUJhc2VQYXRoKFxyXG5cdHR5cGU6IEhvbWVCYXNlVHlwZSxcclxuXHR2YWx1ZTogc3RyaW5nLFxyXG5cdHBsdWdpbjogSG9tZUJhc2VQbHVnaW5cclxuKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcblx0c3dpdGNoICh0eXBlKSB7XHJcblx0XHRjYXNlIEhvbWVCYXNlVHlwZS5GaWxlOlxyXG5cdFx0XHRyZXR1cm4gdmFsdWUgfHwgbnVsbDtcclxuXHRcdFxyXG5cdFx0Y2FzZSBIb21lQmFzZVR5cGUuUmFuZG9tOiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSByYW5kb21GaWxlKHBsdWdpbi5hcHApO1xyXG5cdFx0XHRyZXR1cm4gZmlsZSA/IHRyaW1GaWxlKGZpbGUpIDogbnVsbDtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Y2FzZSBIb21lQmFzZVR5cGUuUmFuZG9tRm9sZGVyOiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSByYW5kb21GaWxlKHBsdWdpbi5hcHAsIHZhbHVlKTtcclxuXHRcdFx0cmV0dXJuIGZpbGUgPyB0cmltRmlsZShmaWxlKSA6IG51bGw7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNhc2UgSG9tZUJhc2VUeXBlLkRhaWx5Tm90ZTpcclxuXHRcdGNhc2UgSG9tZUJhc2VUeXBlLldlZWtseU5vdGU6XHJcblx0XHRjYXNlIEhvbWVCYXNlVHlwZS5Nb250aGx5Tm90ZTpcclxuXHRcdGNhc2UgSG9tZUJhc2VUeXBlLlllYXJseU5vdGU6XHJcblx0XHRcdHJldHVybiBhd2FpdCBnZXRQZXJpb2RpY05vdGUodHlwZSwgcGx1Z2luKTtcclxuXHRcdFxyXG5cdFx0Y2FzZSBIb21lQmFzZVR5cGUuSm91cm5hbDpcclxuXHRcdFx0cmV0dXJuIGF3YWl0IGdldEpvdXJuYWxOb3RlKHZhbHVlLCBwbHVnaW4pO1xyXG5cdFx0XHJcblx0XHRjYXNlIEhvbWVCYXNlVHlwZS5Xb3Jrc3BhY2U6XHJcblx0XHRjYXNlIEhvbWVCYXNlVHlwZS5HcmFwaDpcclxuXHRcdGNhc2UgSG9tZUJhc2VUeXBlLk5vbmU6XHJcblx0XHRcdC8vIFRoZXNlIGRvbid0IHJlc29sdmUgdG8gYSBmaWxlIHBhdGhcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHRcclxuXHRcdGRlZmF1bHQ6XHJcblx0XHRcdHJldHVybiB2YWx1ZSB8fCBudWxsO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgaG9tZSBiYXNlIHR5cGUgcmVxdWlyZXMgYSBmaWxlIHRvIGJlIG9wZW5lZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlcXVpcmVzRmlsZSh0eXBlOiBIb21lQmFzZVR5cGUpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gdHlwZSAhPT0gSG9tZUJhc2VUeXBlLldvcmtzcGFjZSAmJiBcclxuXHQgICAgICAgdHlwZSAhPT0gSG9tZUJhc2VUeXBlLkdyYXBoICYmIFxyXG5cdCAgICAgICB0eXBlICE9PSBIb21lQmFzZVR5cGUuTm9uZTtcclxufVxyXG5cclxuIiwgIi8qKlxyXG4gKiBOZXcgVGFiIFNlcnZpY2VcclxuICogSGFuZGxlcyBzdGFydHVwIGRldGVjdGlvbiBhbmQgbmV3IHRhYiByZXBsYWNlbWVudFxyXG4gKiBJbnNwaXJlZCBieSBvYnNpZGlhbi1ob21lcGFnZSBhbmQgbmV3LXRhYi1kZWZhdWx0LXBhZ2VcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIFdvcmtzcGFjZUxlYWYsIFZpZXcsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgdHlwZSBIb21lQmFzZVBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuXHJcbmV4cG9ydCBjbGFzcyBOZXdUYWJTZXJ2aWNlIHtcclxuXHRwcml2YXRlIGFwcDogQXBwO1xyXG5cdHByaXZhdGUgcGx1Z2luOiBIb21lQmFzZVBsdWdpbjtcclxuXHRwcml2YXRlIGV4aXN0aW5nTGVhdmVzOiBXZWFrU2V0PFdvcmtzcGFjZUxlYWY+ID0gbmV3IFdlYWtTZXQoKTtcclxuXHRwcml2YXRlIGlzU3RhcnR1cDogYm9vbGVhbiA9IHRydWU7XHJcblx0cHJpdmF0ZSBzdGFydHVwQ29tcGxldGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogSG9tZUJhc2VQbHVnaW4pIHtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdFx0dGhpcy5hcHAgPSBwbHVnaW4uYXBwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSW5pdGlhbGl6ZSB0aGUgc2VydmljZSAtIGNhbGxlZCB3aGVuIGxheW91dCBpcyByZWFkeVxyXG5cdCAqL1xyXG5cdGluaXRpYWxpemUoKTogdm9pZCB7XHJcblx0XHQvLyBUcmFjayBhbGwgZXhpc3RpbmcgbGVhdmVzXHJcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcygobGVhZikgPT4ge1xyXG5cdFx0XHR0aGlzLmV4aXN0aW5nTGVhdmVzLmFkZChsZWFmKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEhhbmRsZSBzdGFydHVwXHJcblx0XHR2b2lkIHRoaXMuaGFuZGxlU3RhcnR1cCgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSGFuZGxlIGFwcCBzdGFydHVwIC0gb3BlbiBob21lIGJhc2UgaWYgbmVlZGVkXHJcblx0ICogT25seSBjYWxsZWQgb24gYWN0dWFsIGFwcCBzdGFydHVwLCBub3QgcGx1Z2luIHJlbG9hZHNcclxuXHQgKi9cclxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVN0YXJ0dXAoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cclxuXHRcdGlmICghc2V0dGluZ3Mub3Blbk9uU3RhcnR1cCB8fCAhc2V0dGluZ3MuaG9tZUJhc2VQYXRoKSB7XHJcblx0XHRcdHRoaXMuc3RhcnR1cENvbXBsZXRlZCA9IHRydWU7XHJcblx0XHRcdHRoaXMuaXNTdGFydHVwID0gZmFsc2U7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBmb3IgVVJMIHBhcmFtcyAobGlrZSBvYnNpZGlhbjovL29wZW4gbGlua3MpIC0gaWYgcHJlc2VudCwgc2tpcCBldmVyeXRoaW5nXHJcblx0XHRpZiAoYXdhaXQgdGhpcy5oYXNVcmxQYXJhbXMoKSkge1xyXG5cdFx0XHRjb25zb2xlLmRlYnVnKCdIb21lIEJhc2U6IFVSTCBwYXJhbXMgZGV0ZWN0ZWQsIHNraXBwaW5nIHN0YXJ0dXAgb3BlbicpO1xyXG5cdFx0XHR0aGlzLnN0YXJ0dXBDb21wbGV0ZWQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmlzU3RhcnR1cCA9IGZhbHNlO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gV2FpdCBhIGJpdCBmb3IgT2JzaWRpYW4gdG8gZmluaXNoIHJlc3RvcmluZyB0aGUgd29ya3NwYWNlXHJcblx0XHQvLyBUaGlzIGVuc3VyZXMgYWxsIHRhYnMgYXJlIGxvYWRlZCBiZWZvcmUgd2UgdHJ5IHRvIGNsb3NlIHRoZW1cclxuXHRcdC8vIE5lZWQgbG9uZ2VyIGRlbGF5IHRvIGVuc3VyZSB3b3Jrc3BhY2UgaXMgZnVsbHkgcmVzdG9yZWRcclxuXHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcclxuXHJcblx0XHQvLyBJZiBrZWVwRXhpc3RpbmdUYWJzIGlzIGZhbHNlLCBjbG9zZSBBTEwgdGFicyBmaXJzdCwgdGhlbiBvcGVuIGhvbWUgYmFzZVxyXG5cdFx0Ly8gVGhpcyBzaG91bGQgT05MWSBoYXBwZW4gb24gc3RhcnR1cCwgbm90IHdoZW4gbWFudWFsbHkgb3BlbmluZ1xyXG5cdFx0Ly8gV2UgY2xvc2UgZXZlcnl0aGluZyBmaXJzdCwgdGhlbiBvcGVuIGZyZXNoIC0gZG9uJ3QgdHJ5IHRvIGZpbmQgdGFicyB0byBrZWVwXHJcblx0XHQvLyBFeGNlcHRpb246IElmIGhpZGVSZWxlYXNlTm90ZXMgaXMgT0ZGLCBwcmVzZXJ2ZSByZWxlYXNlIG5vdGVzIHRhYlxyXG5cdFx0aWYgKCFzZXR0aW5ncy5rZWVwRXhpc3RpbmdUYWJzKSB7XHJcblx0XHRcdGNvbnNvbGUuZGVidWcoJ0hvbWUgQmFzZToga2VlcEV4aXN0aW5nVGFicyBpcyBmYWxzZSwgY2xvc2luZyBhbGwgdGFicycpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gSWYgaGlkZVJlbGVhc2VOb3RlcyBpcyBPRkYsIHdlIHNob3VsZCBwcmVzZXJ2ZSByZWxlYXNlIG5vdGVzIHRhYlxyXG5cdFx0XHRsZXQgZXhjZXB0TGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGwgPSBudWxsO1xyXG5cdFx0XHRpZiAoIXNldHRpbmdzLmhpZGVSZWxlYXNlTm90ZXMpIHtcclxuXHRcdFx0XHQvLyBUcnkgdG8gZmluZCByZWxlYXNlIG5vdGVzIHRhYlxyXG5cdFx0XHRcdGNvbnN0IGFsbExlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XHJcblx0XHRcdFx0Zm9yIChjb25zdCBsZWFmIG9mIGFsbExlYXZlcykge1xyXG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcclxuXHRcdFx0XHRcdCBcclxuXHRcdFx0XHRcdGNvbnN0IG1hcmtkb3duVmlldyA9IHZpZXcgYXMgdW5rbm93biBhcyB7IGZpbGU/OiBURmlsZTsgY29udGFpbmVyRWw/OiBIVE1MRWxlbWVudCB9O1xyXG5cdFx0XHRcdFx0aWYgKG1hcmtkb3duVmlldy5maWxlKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGUgPSBtYXJrZG93blZpZXcuZmlsZTtcclxuXHRcdFx0XHRcdC8vIFJlbGVhc2Ugbm90ZXMgYXJlIHR5cGljYWxseSBpbiBjb25maWcgZm9sZGVyIG9yIGhhdmUgc3BlY2lmaWMgbmFtaW5nXHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgcmVsZWFzZSBub3RlcyB0YWIgYnkgbG9va2luZyBhdCB0aGUgZmlsZSBwYXRoXHJcblx0XHRcdFx0XHRjb25zdCBjb25maWdEaXIgPSB0aGlzLmFwcC52YXVsdC5jb25maWdEaXI7XHJcblx0XHRcdFx0XHRpZiAoZmlsZS5wYXRoLmluY2x1ZGVzKCdyZWxlYXNlJykgfHwgZmlsZS5wYXRoLmluY2x1ZGVzKGNvbmZpZ0RpcikpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGFjdHVhbGx5IGEgcmVsZWFzZSBub3RlcyB2aWV3XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGFpbmVyID0gbWFya2Rvd25WaWV3LmNvbnRhaW5lckVsO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjb250YWluZXIgJiYgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5yZWxlYXNlLW5vdGVzJykpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGV4Y2VwdExlYWYgPSBsZWFmO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBDbG9zZSBBTEwgdGFicyAtIGRvbid0IHRyeSB0byBrZWVwIGFueSwganVzdCBjbG9zZSBldmVyeXRoaW5nIChleGNlcHQgcmVsZWFzZSBub3RlcyBpZiBhcHBsaWNhYmxlKVxyXG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5ob21lU2VydmljZS5jbG9zZUFsbExlYXZlc0V4Y2VwdChleGNlcHRMZWFmKTtcclxuXHRcdFx0Ly8gV2FpdCBsb25nZXIgdG8gZW5zdXJlIGFsbCBkZXRhY2htZW50cyBhcmUgcHJvY2Vzc2VkXHJcblx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcclxuXHRcdFx0Y29uc29sZS5kZWJ1ZygnSG9tZSBCYXNlOiBBbGwgdGFicyBjbG9zZWQsIG5vdyBvcGVuaW5nIGhvbWUgYmFzZScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIE9uIHN0YXJ0dXAsIHVzZSBnaG9zdCB0YWIgaWYgc3RpY2t5IGljb24gaXMgZW5hYmxlZCwgb3RoZXJ3aXNlIHVzZSBub3JtYWwgb3BlbkhvbWVCYXNlXHJcblx0XHRpZiAoc2V0dGluZ3Muc2hvd1N0aWNreUhvbWVJY29uKSB7XHJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZUluR2hvc3RUYWIoe1xyXG5cdFx0XHRcdHJ1bkNvbW1hbmQ6IHRydWUsXHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gQWx3YXlzIGNhbGwgb3BlbkhvbWVCYXNlIC0gaXQgd2lsbCBvcGVuIGhvbWUgYmFzZSBpZiBub3QgYWxyZWFkeSBvcGVuXHJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZSh7XHJcblx0XHRcdFx0cmVwbGFjZUFjdGl2ZUxlYWY6IGZhbHNlLFxyXG5cdFx0XHRcdHJ1bkNvbW1hbmQ6IHRydWUsXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc3RhcnR1cENvbXBsZXRlZCA9IHRydWU7XHJcblx0XHR0aGlzLmlzU3RhcnR1cCA9IGZhbHNlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2sgaWYgdGhlIHNldHRpbmdzIG1vZGFsIGlzIGN1cnJlbnRseSBvcGVuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBpc1NldHRpbmdzTW9kYWxPcGVuKCk6IGJvb2xlYW4ge1xyXG5cdFx0Ly8gQ2hlY2sgZm9yIHNldHRpbmdzIG1vZGFsIGJ5IGxvb2tpbmcgZm9yIHRoZSBtb2RhbCBjb250YWluZXJcclxuXHRcdC8vIFRyeSBtdWx0aXBsZSBzZWxlY3RvcnMgdG8gYmUgbW9yZSByb2J1c3RcclxuXHRcdGNvbnN0IHNldHRpbmdzTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGFpbmVyLm1vZC1zZXR0aW5ncycpIHx8XHJcblx0XHQgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLm1vZC1zZXR0aW5ncycpIHx8XHJcblx0XHQgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZlcnRpY2FsLXRhYi1jb250ZW50Jyk7XHJcblx0XHRcclxuXHRcdC8vIEFsc28gY2hlY2sgaWYgYW55IG1vZGFsIGlzIG9wZW4gYW5kIGNvbnRhaW5zIHNldHRpbmdzIGNvbnRlbnRcclxuXHRcdGlmICghc2V0dGluZ3NNb2RhbCkge1xyXG5cdFx0XHRjb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWwtY29udGFpbmVyJyk7XHJcblx0XHRcdGZvciAoY29uc3QgbW9kYWwgb2YgQXJyYXkuZnJvbShhbGxNb2RhbHMpKSB7XHJcblx0XHRcdFx0aWYgKG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52ZXJ0aWNhbC10YWItY29udGVudCcpIHx8IFxyXG5cdFx0XHRcdCAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtY29udGVudCcpIHx8XHJcblx0XHRcdFx0ICAgIG1vZGFsLmNsYXNzTGlzdC5jb250YWlucygnbW9kLXNldHRpbmdzJykpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2V0dGluZ3NNb2RhbCAhPT0gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGZvciBVUkwgcGFyYW1ldGVycyB0aGF0IGluZGljYXRlIE9ic2lkaWFuIHdhcyBvcGVuZWQgdmlhIGEgbGlua1xyXG5cdCAqIEJhc2VkIG9uIG9ic2lkaWFuLWhvbWVwYWdlIGltcGxlbWVudGF0aW9uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBhc3luYyBoYXNVcmxQYXJhbXMoKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHQvLyBDaGVjayBmb3IgbW9iaWxlIFVSTCBwYXJhbXMgKENhcGFjaXRvciBBUEkpXHJcblx0XHRjb25zdCB3aW5kb3dBbnkgPSB3aW5kb3cgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuXHRcdFxyXG5cdFx0Y29uc3QgY2FwYWNpdG9yID0gd2luZG93QW55LkNhcGFjaXRvciBhcyB7IFBsdWdpbnM/OiB7IEFwcD86IHsgZ2V0TGF1bmNoVXJsOiAoKSA9PiBQcm9taXNlPHsgdXJsPzogc3RyaW5nIH0gfCBudWxsPiB9IH0gfSB8IHVuZGVmaW5lZDtcclxuXHRcdGlmIChjYXBhY2l0b3I/LlBsdWdpbnM/LkFwcCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGNvbnN0IGxhdW5jaFVybCA9IGF3YWl0IGNhcGFjaXRvci5QbHVnaW5zLkFwcC5nZXRMYXVuY2hVcmwoKTtcclxuXHRcdFx0XHRpZiAobGF1bmNoVXJsPy51cmwpIHtcclxuXHRcdFx0XHRcdGNvbnN0IHVybCA9IG5ldyBVUkwobGF1bmNoVXJsLnVybCk7XHJcblx0XHRcdFx0XHRjb25zdCBwYXJhbXMgPSBBcnJheS5mcm9tKHVybC5zZWFyY2hQYXJhbXMua2V5cygpKTtcclxuXHRcdFx0XHRcdGNvbnN0IGFjdGlvbiA9IHVybC5ob3N0bmFtZTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYgKFsnb3BlbicsICdhZHZhbmNlZC11cmknXS5pbmNsdWRlcyhhY3Rpb24pICYmXHJcblx0XHRcdFx0XHRcdFsnZmlsZScsICdmaWxlcGF0aCcsICd3b3Jrc3BhY2UnXS5zb21lKGUgPT4gcGFyYW1zLmluY2x1ZGVzKGUpKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRcdC8vIElnbm9yZSBlcnJvcnNcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIENoZWNrIGZvciBkZXNrdG9wIFVSTCBwYXJhbXNcclxuXHRcdGNvbnN0IG9ic0FjdCA9IHdpbmRvd0FueS5PQlNfQUNUIGFzIHsgYWN0aW9uPzogc3RyaW5nIH0gfCB1bmRlZmluZWQ7XHJcblx0XHRpZiAob2JzQWN0KSB7XHJcblx0XHRcdGNvbnN0IHBhcmFtcyA9IE9iamVjdC5rZXlzKG9ic0FjdCk7XHJcblx0XHRcdGNvbnN0IGFjdGlvbiA9IG9ic0FjdC5hY3Rpb247XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoYWN0aW9uICYmIFsnb3BlbicsICdhZHZhbmNlZC11cmknXS5pbmNsdWRlcyhhY3Rpb24pICYmXHJcblx0XHRcdFx0WydmaWxlJywgJ2ZpbGVwYXRoJywgJ3dvcmtzcGFjZSddLnNvbWUoZSA9PiBwYXJhbXMuaW5jbHVkZXMoZSkpKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBIYW5kbGUgbGF5b3V0IGNoYW5nZSBldmVudCAtIGNoZWNrIGZvciBuZXcgZW1wdHkgdGFic1xyXG5cdCAqIEJhc2VkIG9uIG5ldy10YWItZGVmYXVsdC1wYWdlIGltcGxlbWVudGF0aW9uXHJcblx0ICovXHJcblx0aGFuZGxlTGF5b3V0Q2hhbmdlKCk6IHZvaWQge1xyXG5cdFx0Ly8gU2tpcCBpZiBuZXcgdGFiIHJlcGxhY2VtZW50IGlzIGRpc2FibGVkXHJcblx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLnJlcGxhY2VOZXdUYWIpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNraXAgZHVyaW5nIHN0YXJ0dXBcclxuXHRcdGlmICh0aGlzLmlzU3RhcnR1cCB8fCAhdGhpcy5zdGFydHVwQ29tcGxldGVkKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBhbGwgbGVhdmVzIGZvciBuZXcgZW1wdHkgb25lc1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMoKGxlYWYpID0+IHtcclxuXHRcdFx0Ly8gU2tpcCBpZiB3ZSd2ZSBhbHJlYWR5IHNlZW4gdGhpcyBsZWFmXHJcblx0XHRcdGlmICh0aGlzLmV4aXN0aW5nTGVhdmVzLmhhcyhsZWFmKSkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gTWFyayBhcyBzZWVuXHJcblx0XHRcdHRoaXMuZXhpc3RpbmdMZWF2ZXMuYWRkKGxlYWYpO1xyXG5cclxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBlbXB0eSB0YWJcclxuXHRcdFx0aWYgKCF0aGlzLmlzRW1wdHlUYWIobGVhZikpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEhhbmRsZSBiYXNlZCBvbiBtb2RlXHJcblx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdUYWJNb2RlID09PSAnb25seS13aGVuLWVtcHR5Jykge1xyXG5cdFx0XHRcdC8vIE9ubHkgcmVwbGFjZSBpZiB0aGlzIGlzIHRoZSBvbmx5IHRhYlxyXG5cdFx0XHRcdGlmICghdGhpcy5pc09ubHlUYWIobGVhZikpIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFJlcGxhY2UgdGhlIGVtcHR5IHRhYiB3aXRoIGhvbWUgYmFzZVxyXG5cdFx0XHR2b2lkIHRoaXMucmVwbGFjZUVtcHR5VGFiKGxlYWYpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVjayBpZiBhIGxlYWYgaXMgYW4gZW1wdHkgdGFiXHJcblx0ICovXHJcblx0cHJpdmF0ZSBpc0VtcHR5VGFiKGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBib29sZWFuIHtcclxuXHRcdGlmICghbGVhZi52aWV3KSByZXR1cm4gdHJ1ZTtcclxuXHRcdHJldHVybiBsZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKSA9PT0gJ2VtcHR5JztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIHRoaXMgaXMgdGhlIG9ubHkgdGFiIGluIHRoZSB3b3Jrc3BhY2VcclxuXHQgKi9cclxuXHRwcml2YXRlIGlzT25seVRhYihsZWFmOiBXb3Jrc3BhY2VMZWFmKTogYm9vbGVhbiB7XHJcblx0XHRjb25zdCBsZWFmQW55ID0gbGVhZiBhcyB1bmtub3duIGFzIHsgcGFyZW50U3BsaXQ/OiB7IGNoaWxkcmVuPzogdW5rbm93bltdIH0gfTtcclxuXHRcdGNvbnN0IHBhcmVudCA9IGxlYWZBbnkucGFyZW50U3BsaXQ7XHJcblx0XHRpZiAoIXBhcmVudCkgcmV0dXJuIHRydWU7XHJcblx0XHRcclxuXHRcdGNvbnN0IGNoaWxkcmVuID0gcGFyZW50LmNoaWxkcmVuO1xyXG5cdFx0aWYgKCFjaGlsZHJlbikgcmV0dXJuIHRydWU7XHJcblx0XHRcclxuXHRcdHJldHVybiBjaGlsZHJlbi5sZW5ndGggPT09IDE7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXBsYWNlIGFuIGVtcHR5IHRhYiB3aXRoIHRoZSBob21lIGJhc2VcclxuXHQgKi9cclxuXHRwcml2YXRlIGFzeW5jIHJlcGxhY2VFbXB0eVRhYihsZWFmOiBXb3Jrc3BhY2VMZWFmKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHQvLyBTbWFsbCBkZWxheSB0byBoYW5kbGUgcmFjZSBjb25kaXRpb25zIHdpdGggb3RoZXIgcGx1Z2luc1xyXG5cdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XHJcblxyXG5cdFx0Ly8gRG91YmxlLWNoZWNrIHRoZSB0YWIgaXMgc3RpbGwgZW1wdHlcclxuXHRcdGlmICghdGhpcy5pc0VtcHR5VGFiKGxlYWYpKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBPcGVuIGhvbWUgYmFzZSBpbiB0aGlzIGxlYWZcclxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLm9wZW5JbkxlYWYobGVhZik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGb3JjZSBjaGVjayBmb3IgZW1wdHkgd29ya3NwYWNlIGFuZCBvcGVuIGhvbWUgYmFzZVxyXG5cdCAqL1xyXG5cdGFzeW5jIG9wZW5JZkVtcHR5KCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhbiBlbXB0eSB2aWV3XHJcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoVmlldyk7XHJcblx0XHRjb25zdCBhY3RpdmVMZWFmID0gYWN0aXZlVmlldz8ubGVhZjtcclxuXHJcblx0XHRpZiAoIWFjdGl2ZUxlYWYpIHJldHVybjtcclxuXHJcblx0XHQvLyBDaGVjayBpZiBpdCdzIGVtcHR5IGFuZCBpcyB0aGUgb25seSB0YWJcclxuXHRcdGlmICh0aGlzLmlzRW1wdHlUYWIoYWN0aXZlTGVhZikgJiYgdGhpcy5pc09ubHlUYWIoYWN0aXZlTGVhZikpIHtcclxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uaG9tZVNlcnZpY2Uub3BlbkluTGVhZihhY3RpdmVMZWFmKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBTdGlja3kgVGFiIFNlcnZpY2VcclxuICogTWFuYWdlcyB0aGUgc3RpY2t5IGhvbWUgaWNvbiBpbiB0aGUgdGFiIGJhclxyXG4gKi9cclxuXHJcbmltcG9ydCB7IE1lbnUsIFBsYXRmb3JtLCBzZXRJY29uLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgdHlwZSBIb21lQmFzZVBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuaW1wb3J0IHsgZ2V0RmlsZUJ5UGF0aCwgbGVhZkhhc0ZpbGUgfSBmcm9tICcuLi91dGlscy9maWxlLXV0aWxzJztcclxuaW1wb3J0IHsgSWNvblBpY2tlciB9IGZyb20gJy4uL3VpL2ljb24tcGlja2VyJztcclxuXHJcbi8qKlxyXG4gKiBDU1MgY2xhc3MgZm9yIHRoZSBzdGlja3kgaG9tZSBpY29uIGNvbnRhaW5lclxyXG4gKi9cclxuY29uc3QgU1RJQ0tZX0lDT05fQ0xBU1MgPSAnaG9tZS1iYXNlLXN0aWNreS1pY29uJztcclxuY29uc3QgU1RJQ0tZX0lDT05fQUNUSVZFX0NMQVNTID0gJ2hvbWUtYmFzZS1zdGlja3ktaWNvbi1hY3RpdmUnO1xyXG5cclxuLyoqXHJcbiAqIEV4dGVuZGVkIEhUTUxFbGVtZW50IGludGVyZmFjZSBmb3Igc3RpY2t5IGljb24gd2l0aCBjdXN0b20gcHJvcGVydGllc1xyXG4gKi9cclxuaW50ZXJmYWNlIFN0aWNreUljb25FbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG5cdF9jaGVja0ludGVydmFsPzogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0SW50ZXJ2YWw+O1xyXG5cdF9jb250YWluZXJPYnNlcnZlcj86IE11dGF0aW9uT2JzZXJ2ZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTdGlja3lUYWJTZXJ2aWNlIHtcclxuXHRwcml2YXRlIHBsdWdpbjogSG9tZUJhc2VQbHVnaW47XHJcblx0cHJpdmF0ZSBzdGlja3lJY29uRWw6IFN0aWNreUljb25FbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSBsYXlvdXRDaGFuZ2VIYW5kbGVyOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIHRhYkhlYWRlclVwZGF0ZVRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+IHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSBzaWRlYmFyT2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcclxuXHJcblx0Y29uc3RydWN0b3IocGx1Z2luOiBIb21lQmFzZVBsdWdpbikge1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBVcGRhdGUgdGhlIHN0aWNreSB0YWIgaWNvbiBiYXNlZCBvbiBzZXR0aW5nc1xyXG5cdCAqL1xyXG5cdHVwZGF0ZSgpOiB2b2lkIHtcclxuXHRcdC8vIE9ubHkgc2hvdyBvbiBkZXNrdG9wXHJcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0dGhpcy5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy51cGRhdGVUYWJIZWFkZXJzKCk7IC8vIENsZWFuIHVwIHRhYiBoZWFkZXJzXHJcblx0XHRcdHRoaXMudXBkYXRlV29ya3NwYWNlQ2xhc3MoZmFsc2UpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdGlja3lIb21lSWNvbikge1xyXG5cdFx0XHRpZiAodGhpcy5zdGlja3lJY29uRWwpIHtcclxuXHRcdFx0XHQvLyBJY29uIGFscmVhZHkgZXhpc3RzLCBqdXN0IHVwZGF0ZSB0aGUgaWNvblxyXG5cdFx0XHRcdGNvbnN0IGljb25OYW1lID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3RpY2t5SWNvbk5hbWUgfHwgJ2hvbWUnO1xyXG5cdFx0XHRcdHNldEljb24odGhpcy5zdGlja3lJY29uRWwsIGljb25OYW1lKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBJY29uIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSBpdFxyXG5cdFx0XHRcdHRoaXMuY3JlYXRlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy51cGRhdGVXb3Jrc3BhY2VDbGFzcyh0cnVlKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlKCk7XHJcblx0XHRcdHRoaXMudXBkYXRlVGFiSGVhZGVycygpOyAvLyBDbGVhbiB1cCB0YWIgaGVhZGVycyB3aGVuIHJlbW92aW5nIGljb25cclxuXHRcdFx0dGhpcy51cGRhdGVXb3Jrc3BhY2VDbGFzcyhmYWxzZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBBZGQvcmVtb3ZlIENTUyBjbGFzcyBvbiB3b3Jrc3BhY2UgdG8gY29uZGl0aW9uYWxseSBhcHBseSBzdHlsZXNcclxuXHQgKi9cclxuXHRwcml2YXRlIHVwZGF0ZVdvcmtzcGFjZUNsYXNzKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuXHRcdGNvbnN0IG1haW5Xb3Jrc3BhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXNwbGl0Lm1vZC12ZXJ0aWNhbC5tb2Qtcm9vdCcpO1xyXG5cdFx0aWYgKCFtYWluV29ya3NwYWNlKSByZXR1cm47XHJcblxyXG5cdFx0aWYgKGVuYWJsZWQpIHtcclxuXHRcdFx0bWFpbldvcmtzcGFjZS5jbGFzc0xpc3QuYWRkKCdob21lLWJhc2Utc3RpY2t5LWljb24tZW5hYmxlZCcpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0bWFpbldvcmtzcGFjZS5jbGFzc0xpc3QucmVtb3ZlKCdob21lLWJhc2Utc3RpY2t5LWljb24tZW5hYmxlZCcpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlIHRoZSBzdGlja3kgaG9tZSBpY29uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBjcmVhdGUoKTogdm9pZCB7XHJcblx0XHQvLyBSZW1vdmUgZXhpc3RpbmcgaWNvbiBmaXJzdFxyXG5cdFx0dGhpcy5yZW1vdmUoKTtcclxuXHJcblx0XHQvLyBDcmVhdGUgdGhlIHN0aWNreSBpY29uIGVsZW1lbnQgb25jZVxyXG5cdFx0dGhpcy5zdGlja3lJY29uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMuc3RpY2t5SWNvbkVsLmNsYXNzTmFtZSA9IGAke1NUSUNLWV9JQ09OX0NMQVNTfSBjbGlja2FibGUtaWNvbmA7XHJcblx0XHR0aGlzLnN0aWNreUljb25FbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnT3BlbiBob21lIGJhc2UnKTtcclxuXHRcdHRoaXMuc3RpY2t5SWNvbkVsLnNldEF0dHJpYnV0ZSgnZGF0YS10b29sdGlwLXBvc2l0aW9uJywgJ2JvdHRvbScpO1xyXG5cclxuXHRcdC8vIEFkZCB0aGUgaWNvbiBmcm9tIHNldHRpbmdzIChkZWZhdWx0IHRvICdob21lJylcclxuXHRcdGNvbnN0IGljb25OYW1lID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3RpY2t5SWNvbk5hbWUgfHwgJ2hvbWUnO1xyXG5cdFx0c2V0SWNvbih0aGlzLnN0aWNreUljb25FbCwgaWNvbk5hbWUpO1xyXG5cclxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVyXHJcblx0XHR0aGlzLnN0aWNreUljb25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIE9wZW4gaG9tZSBiYXNlIGluIGdob3N0IHRhYiAoYWx3YXlzIHVzZSBnaG9zdCB0YWIgZm9yIHN0aWNreSBpY29uKVxyXG5cdFx0XHR2b2lkIHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLm9wZW5Ib21lQmFzZUluR2hvc3RUYWIoe1xyXG5cdFx0XHRcdHJ1bkNvbW1hbmQ6IHRydWUsXHJcblx0XHRcdH0pLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdC8vIFVwZGF0ZSB0YWIgaGVhZGVycyBhZnRlciBvcGVuaW5nLCB3aXRoIGEgc2xpZ2h0IGRlbGF5IHRvIGxldCBhbmltYXRpb25zIGNvbXBsZXRlXHJcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHRcdFx0XHR9LCAxNTApO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEFkZCBjb250ZXh0IG1lbnUgZm9yIGNoYW5naW5nIGljb24gYW5kIGNsb3NpbmcgaG9tZSBiYXNlXHJcblx0XHR0aGlzLnN0aWNreUljb25FbC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChlKSA9PiB7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0XHJcblx0XHRcdGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gQWRkIENoYW5nZSBpY29uIG9wdGlvblxyXG5cdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuXHRcdFx0XHRpdGVtXHJcblx0XHRcdFx0XHQuc2V0VGl0bGUoJ0NoYW5nZSBpY29uJylcclxuXHRcdFx0XHRcdC5zZXRJY29uKCdsdWNpZGUtaW1hZ2UtcGx1cycpXHJcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHBpY2tlciA9IG5ldyBJY29uUGlja2VyKFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmFwcCxcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdGlja3lJY29uTmFtZSxcclxuXHRcdFx0XHRcdFx0XHQoaWNvbjogc3RyaW5nIHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdGlja3lJY29uTmFtZSA9IGljb247XHJcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGljb24gZGlzcGxheVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5zdGlja3lJY29uRWwpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZXRJY29uKHRoaXMuc3RpY2t5SWNvbkVsLCBpY29uIHx8ICdob21lJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pKCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRwaWNrZXIub3BlbigpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcblx0XHRcdFx0aXRlbVxyXG5cdFx0XHRcdFx0LnNldFRpdGxlKCdDbG9zZSBob21lIGJhc2UnKVxyXG5cdFx0XHRcdFx0LnNldEljb24oJ3gnKVxyXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHR2b2lkIHRoaXMuY2xvc2VIb21lQmFzZSgpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRtZW51LnNob3dBdE1vdXNlRXZlbnQoZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBGdW5jdGlvbiB0byBlbnN1cmUgaWNvbiBpcyBpbiB0aGUgcmlnaHQgcGxhY2VcclxuXHRcdC8vIEluc2VydCBpdCBpbnRvIHRoZSB3b3Jrc3BhY2UtdGFicyBjb250YWluZXIgc28gaXQncyBwb3NpdGlvbmVkIHJlbGF0aXZlIHRvIHRhYnNcclxuXHRcdGNvbnN0IGVuc3VyZUljb25JblBsYWNlID0gKCkgPT4ge1xyXG5cdFx0XHRpZiAoIXRoaXMuc3RpY2t5SWNvbkVsKSByZXR1cm47XHJcblxyXG5cdFx0XHRjb25zdCBtYWluV29ya3NwYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1zcGxpdC5tb2QtdmVydGljYWwubW9kLXJvb3QnKTtcclxuXHRcdFx0aWYgKCFtYWluV29ya3NwYWNlKSByZXR1cm47XHJcblxyXG5cdFx0XHQvLyBGaW5kIHRoZSB3b3Jrc3BhY2UtdGFicyBjb250YWluZXIgKHNpYmxpbmcgb2Ygd29ya3NwYWNlLXRhYi1jb250YWluZXIpXHJcblx0XHRcdGNvbnN0IHdvcmtzcGFjZVRhYnMgPSBtYWluV29ya3NwYWNlLnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2UtdGFicycpO1xyXG5cdFx0XHRpZiAoIXdvcmtzcGFjZVRhYnMpIHJldHVybjtcclxuXHJcblx0XHRcdC8vIENoZWNrIGlmIGljb24gaXMgYWxyZWFkeSBpbiB0aGUgdGFicyBjb250YWluZXJcclxuXHRcdFx0Y29uc3QgZXhpc3RpbmdJY29uID0gd29ya3NwYWNlVGFicy5xdWVyeVNlbGVjdG9yKGAuJHtTVElDS1lfSUNPTl9DTEFTU31gKTtcclxuXHRcdFx0aWYgKGV4aXN0aW5nSWNvbiA9PT0gdGhpcy5zdGlja3lJY29uRWwpIHtcclxuXHRcdFx0XHQvLyBBbHJlYWR5IGluIHBsYWNlLCBub3RoaW5nIHRvIGRvXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBJY29uIGlzIG1pc3NpbmcgLSBpbnNlcnQgaXQgaW50byB0aGUgd29ya3NwYWNlLXRhYnMgY29udGFpbmVyXHJcblx0XHRcdC8vIFRoaXMgd2F5IGl0J3MgcG9zaXRpb25lZCByZWxhdGl2ZSB0byB0aGUgdGFiIGJhciBidXQgd29uJ3QgbW92ZSB3aXRoIHRhYnNcclxuXHRcdFx0d29ya3NwYWNlVGFicy5hcHBlbmRDaGlsZCh0aGlzLnN0aWNreUljb25FbCk7XHJcblxyXG5cdFx0XHQvLyBVcGRhdGUgYWN0aXZlIHN0YXRlIGFmdGVyIGluc2VydGlvblxyXG5cdFx0XHR0aGlzLnVwZGF0ZUFjdGl2ZVN0YXRlKCk7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBVcGRhdGUgdGFiIGhlYWRlcnMgd2hlbiBpY29uIGlzIGNyZWF0ZWRcclxuXHRcdFx0dGhpcy51cGRhdGVUYWJIZWFkZXJzKCk7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBFbnN1cmUgd29ya3NwYWNlIGNsYXNzIGlzIHNldFxyXG5cdFx0XHR0aGlzLnVwZGF0ZVdvcmtzcGFjZUNsYXNzKHRydWUpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gVXBkYXRlIGljb24gcG9zaXRpb24gYmFzZWQgb24gc2lkZWJhciBzdGF0ZVxyXG5cdFx0XHR0aGlzLnVwZGF0ZUljb25Qb3NpdGlvbkZvclNpZGViYXIoKTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIFdhdGNoIGZvciBzaWRlYmFyIGNvbGxhcHNlL2V4cGFuZCBjaGFuZ2VzXHJcblx0XHRcdHRoaXMud2F0Y2hTaWRlYmFyU3RhdGUoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0Ly8gVHJ5IHRvIGluc2VydCBpbW1lZGlhdGVseVxyXG5cdFx0ZW5zdXJlSWNvbkluUGxhY2UoKTtcclxuXHJcblx0XHQvLyBTZXQgdXAgYSByZWxpYWJsZSBjaGVjayB0aGF0IHJ1bnMgcGVyaW9kaWNhbGx5IHRvIGVuc3VyZSBpY29uIGlzIGFsd2F5cyB0aGVyZVxyXG5cdFx0Ly8gVGhpcyBpcyBzaW1wbGUgYW5kIHJlbGlhYmxlIC0ganVzdCBjaGVjayBpZiBpdCdzIHRoZXJlLCBpZiBub3QsIHB1dCBpdCBiYWNrXHJcblx0XHRjb25zdCBjaGVja0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRpZiAoIXRoaXMuc3RpY2t5SWNvbkVsIHx8ICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3RpY2t5SG9tZUljb24pIHtcclxuXHRcdFx0XHRjbGVhckludGVydmFsKGNoZWNrSW50ZXJ2YWwpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbnN1cmVJY29uSW5QbGFjZSgpO1xyXG5cdFx0fSwgMTAwKTsgLy8gQ2hlY2sgZXZlcnkgMTAwbXMgLSBtb3JlIGZyZXF1ZW50IHRvIGNhdGNoIGNvbnRhaW5lciByZWNyZWF0aW9uIGltbWVkaWF0ZWx5XHJcblxyXG5cdFx0Ly8gU3RvcmUgaW50ZXJ2YWwgc28gd2UgY2FuIGNsZWFyIGl0IGxhdGVyXHJcblx0XHR0aGlzLnN0aWNreUljb25FbC5fY2hlY2tJbnRlcnZhbCA9IGNoZWNrSW50ZXJ2YWw7XHJcblxyXG5cdFx0Ly8gQWxzbyBjaGVjayBvbiBsYXlvdXQgY2hhbmdlcyAtIGJ1dCBkbyBpdCBpbW1lZGlhdGVseSwgbm8gZGVsYXlcclxuXHRcdGlmICghdGhpcy5sYXlvdXRDaGFuZ2VIYW5kbGVyKSB7XHJcblx0XHRcdHRoaXMubGF5b3V0Q2hhbmdlSGFuZGxlciA9ICgpID0+IHtcclxuXHRcdFx0XHRpZiAodGhpcy5zdGlja3lJY29uRWwgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1N0aWNreUhvbWVJY29uKSB7XHJcblx0XHRcdFx0XHQvLyBDaGVjayBpbW1lZGlhdGVseSAtIGRvbid0IHdhaXQgZm9yIGxheW91dCB0byBzZXR0bGVcclxuXHRcdFx0XHRcdC8vIFRoaXMgcHJldmVudHMgZmxpY2tlcmluZyB3aGVuIHRhYnMgY2xvc2VcclxuXHRcdFx0XHRcdGVuc3VyZUljb25JblBsYWNlKCk7XHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGFiIGhlYWRlcnMgb24gbGF5b3V0IGNoYW5nZVxyXG5cdFx0XHRcdFx0dGhpcy51cGRhdGVUYWJIZWFkZXJzKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0XHR0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdsYXlvdXQtY2hhbmdlJywgdGhpcy5sYXlvdXRDaGFuZ2VIYW5kbGVyKVxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEFsc28gd2F0Y2ggZm9yIHdoZW4gd29ya3NwYWNlLXRhYnMgY29udGFpbmVyIGlzIGFkZGVkIGJhY2sgKGFmdGVyIGFsbCB0YWJzIGNsb3NlZClcclxuXHRcdC8vIFVzZSBhIE11dGF0aW9uT2JzZXJ2ZXIgb24gdGhlIHdvcmtzcGFjZSBzcGxpdCB0byBjYXRjaCBjb250YWluZXIgcmVjcmVhdGlvblxyXG5cdFx0Y29uc3QgbWFpbldvcmtzcGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2Utc3BsaXQubW9kLXZlcnRpY2FsLm1vZC1yb290Jyk7XHJcblx0XHRpZiAobWFpbldvcmtzcGFjZSkge1xyXG5cdFx0XHRjb25zdCBjb250YWluZXJPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuc3RpY2t5SWNvbkVsIHx8ICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3RpY2t5SG9tZUljb24pIHJldHVybjtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBDaGVjayBpZiB3b3Jrc3BhY2UtdGFicyBjb250YWluZXIgZXhpc3RzIGFuZCBpY29uIGlzIG1pc3NpbmdcclxuXHRcdFx0XHRjb25zdCB3b3Jrc3BhY2VUYWJzID0gbWFpbldvcmtzcGFjZS5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYnMnKTtcclxuXHRcdFx0XHRpZiAod29ya3NwYWNlVGFicykge1xyXG5cdFx0XHRcdFx0Y29uc3QgZXhpc3RpbmdJY29uID0gd29ya3NwYWNlVGFicy5xdWVyeVNlbGVjdG9yKGAuJHtTVElDS1lfSUNPTl9DTEFTU31gKTtcclxuXHRcdFx0XHRcdGlmICghZXhpc3RpbmdJY29uIHx8IGV4aXN0aW5nSWNvbiAhPT0gdGhpcy5zdGlja3lJY29uRWwpIHtcclxuXHRcdFx0XHRcdFx0Ly8gQ29udGFpbmVyIGV4aXN0cyBidXQgaWNvbiBpcyBtaXNzaW5nIC0gcmUtaW5zZXJ0IGltbWVkaWF0ZWx5XHJcblx0XHRcdFx0XHRcdHdvcmtzcGFjZVRhYnMuYXBwZW5kQ2hpbGQodGhpcy5zdGlja3lJY29uRWwpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUFjdGl2ZVN0YXRlKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGNvbnRhaW5lck9ic2VydmVyLm9ic2VydmUobWFpbldvcmtzcGFjZSwge1xyXG5cdFx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcclxuXHRcdFx0XHRzdWJ0cmVlOiBmYWxzZSwgLy8gT25seSB3YXRjaCBkaXJlY3QgY2hpbGRyZW5cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTdG9yZSBvYnNlcnZlciBzbyB3ZSBjYW4gY2xlYW4gaXQgdXBcclxuXHRcdFx0dGhpcy5zdGlja3lJY29uRWwuX2NvbnRhaW5lck9ic2VydmVyID0gY29udGFpbmVyT2JzZXJ2ZXI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZW1vdmUgdGhlIHN0aWNreSBob21lIGljb25cclxuXHQgKi9cclxuXHRyZW1vdmUoKTogdm9pZCB7XHJcblx0XHQvLyBDbGVhciBhbnkgcGVuZGluZyB0YWIgaGVhZGVyIHVwZGF0ZXNcclxuXHRcdGlmICh0aGlzLnRhYkhlYWRlclVwZGF0ZVRpbWVvdXQpIHtcclxuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMudGFiSGVhZGVyVXBkYXRlVGltZW91dCk7XHJcblx0XHRcdHRoaXMudGFiSGVhZGVyVXBkYXRlVGltZW91dCA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2xlYXIgYW55IGNoZWNrIGludGVydmFsc1xyXG5cdFx0aWYgKHRoaXMuc3RpY2t5SWNvbkVsICYmIHRoaXMuc3RpY2t5SWNvbkVsLl9jaGVja0ludGVydmFsKSB7XHJcblx0XHRcdGNsZWFySW50ZXJ2YWwodGhpcy5zdGlja3lJY29uRWwuX2NoZWNrSW50ZXJ2YWwpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERpc2Nvbm5lY3QgY29udGFpbmVyIG9ic2VydmVyXHJcblx0XHRpZiAodGhpcy5zdGlja3lJY29uRWwgJiYgdGhpcy5zdGlja3lJY29uRWwuX2NvbnRhaW5lck9ic2VydmVyKSB7XHJcblx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsLl9jb250YWluZXJPYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gRGlzY29ubmVjdCBzaWRlYmFyIG9ic2VydmVyXHJcblx0XHRpZiAodGhpcy5zaWRlYmFyT2JzZXJ2ZXIpIHtcclxuXHRcdFx0dGhpcy5zaWRlYmFyT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cdFx0XHR0aGlzLnNpZGViYXJPYnNlcnZlciA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuc3RpY2t5SWNvbkVsKSB7XHJcblx0XHRcdC8vIE9ubHkgcmVtb3ZlIGlmIGl0J3MgYWN0dWFsbHkgaW4gdGhlIERPTVxyXG5cdFx0XHRpZiAodGhpcy5zdGlja3lJY29uRWwucGFyZW50RWxlbWVudCkge1xyXG5cdFx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsLnJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsID0gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBBbHNvIGNsZWFuIHVwIGFueSBvcnBoYW5lZCBpY29uc1xyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7U1RJQ0tZX0lDT05fQ0xBU1N9YCkuZm9yRWFjaChlbCA9PiB7XHJcblx0XHRcdGNvbnN0IHN0aWNreUVsID0gZWwgYXMgU3RpY2t5SWNvbkVsZW1lbnQ7XHJcblx0XHRcdGlmIChzdGlja3lFbC5fY2hlY2tJbnRlcnZhbCkge1xyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoc3RpY2t5RWwuX2NoZWNrSW50ZXJ2YWwpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChzdGlja3lFbC5fY29udGFpbmVyT2JzZXJ2ZXIpIHtcclxuXHRcdFx0XHRzdGlja3lFbC5fY29udGFpbmVyT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsLnJlbW92ZSgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBVcGRhdGUgdGhlIGFjdGl2ZSBzdGF0ZSBvZiB0aGUgc3RpY2t5IGljb25cclxuXHQgKi9cclxuXHR1cGRhdGVBY3RpdmVTdGF0ZSgpOiB2b2lkIHtcclxuXHRcdGlmICghdGhpcy5zdGlja3lJY29uRWwpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBpc0FjdGl2ZSA9IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLmlzRm9jdXNlZE9uSG9tZUJhc2UoKTtcclxuXHRcdFxyXG5cdFx0aWYgKGlzQWN0aXZlKSB7XHJcblx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsLmNsYXNzTGlzdC5hZGQoU1RJQ0tZX0lDT05fQUNUSVZFX0NMQVNTKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsLmNsYXNzTGlzdC5yZW1vdmUoU1RJQ0tZX0lDT05fQUNUSVZFX0NMQVNTKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBBbHNvIHVwZGF0ZSB0YWIgaGVhZGVycyB3aGVuIGFjdGl2ZSBzdGF0ZSBjaGFuZ2VzIChkZWJvdW5jZWQpXHJcblx0XHR0aGlzLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIHRoZSBsZWZ0IHNpZGViYXIgaXMgY29sbGFwc2VkXHJcblx0ICogQmFzZWQgb24gb2JzaWRpYW4tb3h5Z2VuLXNldHRpbmdzIGltcGxlbWVudGF0aW9uXHJcblx0ICovXHJcblx0cHJpdmF0ZSBpc0xlZnRTaWRlYmFyQ29sbGFwc2VkKCk6IGJvb2xlYW4ge1xyXG5cdFx0Ly8gVXNlIHRoZSBjb3JyZWN0IHNlbGVjdG9yIGZvciBsZWZ0IHNpZGViYXJcclxuXHRcdGNvbnN0IGxlZnRTaWRlYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1zcGxpdC5tb2QtbGVmdC1zcGxpdCcpIHx8IFxyXG5cdFx0ICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kLWxlZnQtc3BsaXQnKTtcclxuXHRcdFxyXG5cdFx0aWYgKCFsZWZ0U2lkZWJhcikgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHJcblx0XHQvLyBDaGVjayBmb3IgdGhlIGlzLXNpZGVkb2NrLWNvbGxhcHNlZCBjbGFzcyAtIHRoaXMgaXMgdGhlIG1vc3QgcmVsaWFibGUgaW5kaWNhdG9yXHJcblx0XHRyZXR1cm4gbGVmdFNpZGViYXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1zaWRlZG9jay1jb2xsYXBzZWQnKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVwZGF0ZSBpY29uIHBvc2l0aW9uIGJhc2VkIG9uIHNpZGViYXIgc3RhdGVcclxuXHQgKi9cclxuXHR1cGRhdGVJY29uUG9zaXRpb25Gb3JTaWRlYmFyKCk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLnN0aWNreUljb25FbCkgcmV0dXJuO1xyXG5cdFx0XHJcblx0XHRjb25zdCBpc0NvbGxhcHNlZCA9IHRoaXMuaXNMZWZ0U2lkZWJhckNvbGxhcHNlZCgpO1xyXG5cdFx0Y29uc3QgbWFpbldvcmtzcGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2Utc3BsaXQubW9kLXZlcnRpY2FsLm1vZC1yb290Jyk7XHJcblx0XHRcclxuXHRcdC8vIFVzZSBDU1MgY2xhc3MgaW5zdGVhZCBvZiBpbmxpbmUgc3R5bGVzXHJcblx0XHRpZiAoaXNDb2xsYXBzZWQpIHtcclxuXHRcdFx0dGhpcy5zdGlja3lJY29uRWwuY2xhc3NMaXN0LmFkZCgnaG9tZS1iYXNlLXN0aWNreS1pY29uLXNpZGViYXItY29sbGFwc2VkJyk7XHJcblx0XHRcdC8vIEFkanVzdCB0YWIgY29udGFpbmVyIHBhZGRpbmcgd2hlbiBzaWRlYmFyIGlzIGNvbGxhcHNlZFxyXG5cdFx0XHRpZiAobWFpbldvcmtzcGFjZSkge1xyXG5cdFx0XHRcdG1haW5Xb3Jrc3BhY2UuY2xhc3NMaXN0LmFkZCgnaG9tZS1iYXNlLXNpZGViYXItY29sbGFwc2VkJyk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuc3RpY2t5SWNvbkVsLmNsYXNzTGlzdC5yZW1vdmUoJ2hvbWUtYmFzZS1zdGlja3ktaWNvbi1zaWRlYmFyLWNvbGxhcHNlZCcpO1xyXG5cdFx0XHQvLyBSZW1vdmUgY29sbGFwc2VkIHBhZGRpbmcgYWRqdXN0bWVudFxyXG5cdFx0XHRpZiAobWFpbldvcmtzcGFjZSkge1xyXG5cdFx0XHRcdG1haW5Xb3Jrc3BhY2UuY2xhc3NMaXN0LnJlbW92ZSgnaG9tZS1iYXNlLXNpZGViYXItY29sbGFwc2VkJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFdhdGNoIGZvciBzaWRlYmFyIHN0YXRlIGNoYW5nZXMgYW5kIHVwZGF0ZSBpY29uIHBvc2l0aW9uXHJcblx0ICogQmFzZWQgb24gb2JzaWRpYW4tb3h5Z2VuLXNldHRpbmdzIGltcGxlbWVudGF0aW9uXHJcblx0ICovXHJcblx0cHJpdmF0ZSB3YXRjaFNpZGViYXJTdGF0ZSgpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLnNpZGViYXJPYnNlcnZlcikge1xyXG5cdFx0XHR0aGlzLnNpZGViYXJPYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGxlZnRTaWRlYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1zcGxpdC5tb2QtbGVmdC1zcGxpdCcpIHx8IFxyXG5cdFx0ICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kLWxlZnQtc3BsaXQnKTtcclxuXHRcdFxyXG5cdFx0aWYgKCFsZWZ0U2lkZWJhcikgcmV0dXJuO1xyXG5cdFx0XHJcblx0XHQvLyBXYXRjaCBmb3IgY2xhc3MgY2hhbmdlcyBvbiB0aGUgc2lkZWJhciBlbGVtZW50XHJcblx0XHR0aGlzLnNpZGViYXJPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcclxuXHRcdFx0bGV0IHNob3VsZFVwZGF0ZSA9IGZhbHNlO1xyXG5cdFx0XHRtdXRhdGlvbnMuZm9yRWFjaCgobXV0YXRpb24pID0+IHtcclxuXHRcdFx0XHRpZiAobXV0YXRpb24udHlwZSA9PT0gJ2F0dHJpYnV0ZXMnICYmIG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgPT09ICdjbGFzcycpIHtcclxuXHRcdFx0XHRcdHNob3VsZFVwZGF0ZSA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYgKHNob3VsZFVwZGF0ZSkge1xyXG5cdFx0XHRcdHRoaXMudXBkYXRlSWNvblBvc2l0aW9uRm9yU2lkZWJhcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0dGhpcy5zaWRlYmFyT2JzZXJ2ZXIub2JzZXJ2ZShsZWZ0U2lkZWJhciwge1xyXG5cdFx0XHRhdHRyaWJ1dGVzOiB0cnVlLFxyXG5cdFx0XHRhdHRyaWJ1dGVGaWx0ZXI6IFsnY2xhc3MnXSxcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVG9nZ2xlIHRoZSBzdGlja3kgaWNvbiB2aXNpYmlsaXR5XHJcblx0ICovXHJcblx0YXN5bmMgdG9nZ2xlKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1N0aWNreUhvbWVJY29uID0gIXRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdGlja3lIb21lSWNvbjtcclxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy51cGRhdGUoKTtcclxuXHRcdC8vIFVwZGF0ZSB0YWIgaGVhZGVycyB3aGVuIHRvZ2dsaW5nIHN0aWNreSBpY29uXHJcblx0XHR0aGlzLnVwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVwZGF0ZSB0YWIgaGVhZGVycyB0byBoaWRlL3Nob3cgZ2hvc3QgdGFiXHJcblx0ICogT25seSB3b3JrcyB3aGVuIHN0aWNreSBpY29uIGlzIGVuYWJsZWRcclxuXHQgKiBEZWJvdW5jZWQgdG8gcHJldmVudCBmbGlja2VyaW5nIGR1cmluZyB0YWIgdHJhbnNpdGlvbnNcclxuXHQgKi9cclxuXHR1cGRhdGVUYWJIZWFkZXJzKCk6IHZvaWQge1xyXG5cdFx0Ly8gQ2xlYXIgYW55IHBlbmRpbmcgdXBkYXRlXHJcblx0XHRpZiAodGhpcy50YWJIZWFkZXJVcGRhdGVUaW1lb3V0KSB7XHJcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnRhYkhlYWRlclVwZGF0ZVRpbWVvdXQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERlYm91bmNlIHRoZSB1cGRhdGUgdG8gYXZvaWQgZmxpY2tlcmluZyBkdXJpbmcgdGFiIGFuaW1hdGlvbnNcclxuXHRcdHRoaXMudGFiSGVhZGVyVXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnRhYkhlYWRlclVwZGF0ZVRpbWVvdXQgPSBudWxsO1xyXG5cdFx0XHR0aGlzLl9kb1VwZGF0ZVRhYkhlYWRlcnMoKTtcclxuXHRcdH0sIDEwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGxldCB0YWIgYW5pbWF0aW9ucyBjb21wbGV0ZVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSW50ZXJuYWwgbWV0aG9kIHRoYXQgYWN0dWFsbHkgdXBkYXRlcyB0aGUgdGFiIGhlYWRlcnNcclxuXHQgKi9cclxuXHRwcml2YXRlIF9kb1VwZGF0ZVRhYkhlYWRlcnMoKTogdm9pZCB7XHJcblx0XHQvLyBPbmx5IGhpZGUgZ2hvc3QgdGFiIGlmIEJPVEggc3RpY2t5IGljb24gQU5EIGhpZGUgdGFiIGhlYWRlciBhcmUgZW5hYmxlZFxyXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3RpY2t5SG9tZUljb24gfHwgIXRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVIb21lVGFiSGVhZGVyKSB7XHJcblx0XHRcdC8vIFJlbW92ZSBhbGwgaG9tZSBiYXNlIHRhYiBjbGFzc2VzIGlmIGVpdGhlciBzZXR0aW5nIGlzIGRpc2FibGVkXHJcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pcy1ob21lLWJhc2UtdGFiJykuZm9yRWFjaChlbCA9PiB7XHJcblx0XHRcdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaG9tZS1iYXNlLXRhYicpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGhvbWVCYXNlUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlUGF0aDtcclxuXHRcdGlmICghaG9tZUJhc2VQYXRoKSByZXR1cm47XHJcblxyXG5cdFx0Ly8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSB0byBlbnN1cmUgRE9NIGlzIHJlYWR5XHJcblx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG5cdFx0XHQvLyBPbmx5IGhpZGUgdGhlIGdob3N0IHRhYiAocGlubmVkIGhvbWUgYmFzZSB0YWIpXHJcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcygobGVhZikgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGlzSG9tZUJhc2UgPSBsZWFmSGFzRmlsZShsZWFmLCBob21lQmFzZVBhdGgpO1xyXG5cdFx0XHRcdGlmICghaXNIb21lQmFzZSkge1xyXG5cdFx0XHRcdFx0Y29uc3QgdGFiSGVhZGVyID0gdGhpcy5nZXRUYWJIZWFkZXJGb3JMZWFmKGxlYWYpO1xyXG5cdFx0XHRcdFx0aWYgKHRhYkhlYWRlcikge1xyXG5cdFx0XHRcdFx0XHR0YWJIZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaG9tZS1iYXNlLXRhYicpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyB0aGUgZ2hvc3QgdGFiIChwaW5uZWQpXHJcblx0XHRcdFx0Y29uc3Qgdmlld1N0YXRlID0gbGVhZi5nZXRWaWV3U3RhdGUoKTtcclxuXHRcdFx0XHRjb25zdCBpc0dob3N0VGFiID0gdmlld1N0YXRlLnBpbm5lZCA9PT0gdHJ1ZTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRjb25zdCB0YWJIZWFkZXIgPSB0aGlzLmdldFRhYkhlYWRlckZvckxlYWYobGVhZik7XHJcblx0XHRcdFx0aWYgKHRhYkhlYWRlcikge1xyXG5cdFx0XHRcdFx0aWYgKGlzR2hvc3RUYWIpIHtcclxuXHRcdFx0XHRcdFx0Ly8gSGlkZSBnaG9zdCB0YWIgaGVhZGVyXHJcblx0XHRcdFx0XHRcdHRhYkhlYWRlci5jbGFzc0xpc3QuYWRkKCdpcy1ob21lLWJhc2UtdGFiJyk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBEb24ndCBoaWRlIG5vcm1hbCB0YWJzXHJcblx0XHRcdFx0XHRcdHRhYkhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdpcy1ob21lLWJhc2UtdGFiJyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogR2V0IHRoZSB0YWIgaGVhZGVyIGVsZW1lbnQgZm9yIGEgZ2l2ZW4gbGVhZlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgZ2V0VGFiSGVhZGVyRm9yTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcclxuXHRcdC8vIFRyeSB0byBnZXQgZnJvbSBsZWFmJ3MgaW50ZXJuYWwgcHJvcGVydHkgZmlyc3QgKGlmIGF2YWlsYWJsZSlcclxuXHRcdGNvbnN0IGxlYWZBbnkgPSBsZWFmIGFzIHVua25vd24gYXMgeyB0YWJIZWFkZXJFbD86IEhUTUxFbGVtZW50IH07XHJcblx0XHRpZiAobGVhZkFueS50YWJIZWFkZXJFbCkge1xyXG5cdFx0XHRyZXR1cm4gbGVhZkFueS50YWJIZWFkZXJFbDtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBGYWxsYmFjazogZmluZCBieSBxdWVyeWluZyBET01cclxuXHRcdGNvbnN0IHZpZXdUeXBlID0gbGVhZi52aWV3Py5nZXRWaWV3VHlwZSgpO1xyXG5cdFx0aWYgKCF2aWV3VHlwZSkgcmV0dXJuIG51bGw7XHJcblxyXG5cdFx0Ly8gR2V0IHRoZSBhY3RpdmUgbGVhZiB0byBoZWxwIHdpdGggbWF0Y2hpbmdcclxuXHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldE1vc3RSZWNlbnRMZWFmKCk7XHJcblx0XHRjb25zdCBpc0FjdGl2ZSA9IGxlYWYgPT09IGFjdGl2ZUxlYWY7XHJcblxyXG5cdFx0Ly8gRmluZCBhbGwgdGFiIGhlYWRlcnMgd2l0aCBtYXRjaGluZyB2aWV3IHR5cGVcclxuXHRcdGNvbnN0IHRhYkhlYWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAud29ya3NwYWNlLXRhYi1oZWFkZXJbZGF0YS10eXBlPVwiJHt2aWV3VHlwZX1cIl1gKTtcclxuXHRcdFxyXG5cdFx0Ly8gSWYgdGhpcyBpcyB0aGUgYWN0aXZlIGxlYWYsIHByZWZlciB0aGUgYWN0aXZlIHRhYiBoZWFkZXJcclxuXHRcdGlmIChpc0FjdGl2ZSkge1xyXG5cdFx0XHRjb25zdCBhY3RpdmVIZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXIuaXMtYWN0aXZlJyk7XHJcblx0XHRcdGlmIChhY3RpdmVIZWFkZXIgJiYgYWN0aXZlSGVhZGVyLmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlJykgPT09IHZpZXdUeXBlKSB7XHJcblx0XHRcdFx0cmV0dXJuIGFjdGl2ZUhlYWRlciBhcyBIVE1MRWxlbWVudDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFRyeSB0byBtYXRjaCBieSBjaGVja2luZyBpZiBoZWFkZXIncyBsZWFmIHByb3BlcnR5IG1hdGNoZXNcclxuXHRcdGZvciAoY29uc3QgaGVhZGVyIG9mIEFycmF5LmZyb20odGFiSGVhZGVycykpIHtcclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSBoZWFkZXIgYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRcdGNvbnN0IGhlYWRlckVsV2l0aExlYWYgPSBoZWFkZXJFbCBhcyB1bmtub3duIGFzIHsgbGVhZj86IFdvcmtzcGFjZUxlYWYgfTtcclxuXHRcdFx0Y29uc3QgaGVhZGVyTGVhZiA9IGhlYWRlckVsV2l0aExlYWYubGVhZjtcclxuXHRcdFx0aWYgKGhlYWRlckxlYWYgPT09IGxlYWYpIHtcclxuXHRcdFx0XHRyZXR1cm4gaGVhZGVyRWw7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBJZiBvbmx5IG9uZSB0YWIgaGVhZGVyIG1hdGNoZXMgdGhlIHZpZXcgdHlwZSwgaXQncyBsaWtlbHkgdGhlIG9uZVxyXG5cdFx0aWYgKHRhYkhlYWRlcnMubGVuZ3RoID09PSAxKSB7XHJcblx0XHRcdHJldHVybiB0YWJIZWFkZXJzWzBdIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIExhc3QgcmVzb3J0OiBpZiB0aGlzIGlzIGFjdGl2ZSBhbmQgd2UgZm91bmQgYW4gYWN0aXZlIGhlYWRlciwgdXNlIGl0XHJcblx0XHRpZiAoaXNBY3RpdmUpIHtcclxuXHRcdFx0Y29uc3QgYWN0aXZlSGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS10YWItaGVhZGVyLmlzLWFjdGl2ZScpO1xyXG5cdFx0XHRpZiAoYWN0aXZlSGVhZGVyKSB7XHJcblx0XHRcdFx0cmV0dXJuIGFjdGl2ZUhlYWRlciBhcyBIVE1MRWxlbWVudDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2xvc2UgdGhlIGhvbWUgYmFzZSB0YWJcclxuXHQgKi9cclxuXHRhc3luYyBjbG9zZUhvbWVCYXNlKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Y29uc3QgaG9tZUJhc2VQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaG9tZUJhc2VQYXRoO1xyXG5cdFx0aWYgKCFob21lQmFzZVBhdGgpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCB7IGdldEZpbGVCeVBhdGggfSA9IGF3YWl0IGltcG9ydCgnLi4vdXRpbHMvZmlsZS11dGlscycpO1xyXG5cdFx0Y29uc3QgaG9tZUJhc2VGaWxlID0gZ2V0RmlsZUJ5UGF0aCh0aGlzLnBsdWdpbi5hcHAsIGhvbWVCYXNlUGF0aCk7XHJcblx0XHRpZiAoIWhvbWVCYXNlRmlsZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGhvbWVCYXNlTGVhZiA9IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLmZpbmRFeGlzdGluZ0hvbWVCYXNlTGVhZihob21lQmFzZUZpbGUpO1xyXG5cdFx0aWYgKGhvbWVCYXNlTGVhZikge1xyXG5cdFx0XHRob21lQmFzZUxlYWYuZGV0YWNoKCk7XHJcblx0XHRcdC8vIFVwZGF0ZSB0YWIgaGVhZGVycyBhZnRlciBjbG9zaW5nXHJcblx0XHRcdHRoaXMudXBkYXRlVGFiSGVhZGVycygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUGluIHRoZSBob21lIGJhc2UgdGFiXHJcblx0ICovXHJcblx0cGluSG9tZUJhc2VUYWIoKTogdm9pZCB7XHJcblx0XHRjb25zdCBob21lQmFzZVBhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ob21lQmFzZVBhdGg7XHJcblx0XHRpZiAoIWhvbWVCYXNlUGF0aCkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGhvbWVCYXNlRmlsZSA9IGdldEZpbGVCeVBhdGgodGhpcy5wbHVnaW4uYXBwLCBob21lQmFzZVBhdGgpO1xyXG5cdFx0aWYgKCFob21lQmFzZUZpbGUpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBob21lQmFzZUxlYWYgPSB0aGlzLnBsdWdpbi5ob21lU2VydmljZS5maW5kRXhpc3RpbmdIb21lQmFzZUxlYWYoaG9tZUJhc2VGaWxlKTtcclxuXHRcdGlmIChob21lQmFzZUxlYWYpIHtcclxuXHRcdFx0aG9tZUJhc2VMZWFmLnNldFBpbm5lZCh0cnVlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVucGluIHRoZSBob21lIGJhc2UgdGFiXHJcblx0ICovXHJcblx0dW5waW5Ib21lQmFzZVRhYigpOiB2b2lkIHtcclxuXHRcdGNvbnN0IGhvbWVCYXNlUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmhvbWVCYXNlUGF0aDtcclxuXHRcdGlmICghaG9tZUJhc2VQYXRoKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgaG9tZUJhc2VGaWxlID0gZ2V0RmlsZUJ5UGF0aCh0aGlzLnBsdWdpbi5hcHAsIGhvbWVCYXNlUGF0aCk7XHJcblx0XHRpZiAoIWhvbWVCYXNlRmlsZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGhvbWVCYXNlTGVhZiA9IHRoaXMucGx1Z2luLmhvbWVTZXJ2aWNlLmZpbmRFeGlzdGluZ0hvbWVCYXNlTGVhZihob21lQmFzZUZpbGUpO1xyXG5cdFx0aWYgKGhvbWVCYXNlTGVhZikge1xyXG5cdFx0XHRob21lQmFzZUxlYWYuc2V0UGlubmVkKGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrIGlmIHRoZSBob21lIGJhc2UgdGFiIGlzIHBpbm5lZFxyXG5cdCAqL1xyXG5cdGlzSG9tZUJhc2VUYWJQaW5uZWQoKTogYm9vbGVhbiB7XHJcblx0XHRjb25zdCBob21lQmFzZVBhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ob21lQmFzZVBhdGg7XHJcblx0XHRpZiAoIWhvbWVCYXNlUGF0aCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdGNvbnN0IGhvbWVCYXNlRmlsZSA9IGdldEZpbGVCeVBhdGgodGhpcy5wbHVnaW4uYXBwLCBob21lQmFzZVBhdGgpO1xyXG5cdFx0aWYgKCFob21lQmFzZUZpbGUpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRjb25zdCBob21lQmFzZUxlYWYgPSB0aGlzLnBsdWdpbi5ob21lU2VydmljZS5maW5kRXhpc3RpbmdIb21lQmFzZUxlYWYoaG9tZUJhc2VGaWxlKTtcclxuXHRcdGlmICghaG9tZUJhc2VMZWFmKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0Y29uc3Qgdmlld1N0YXRlID0gaG9tZUJhc2VMZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG5cdFx0cmV0dXJuIHZpZXdTdGF0ZS5waW5uZWQgPT09IHRydWU7XHJcblx0fVxyXG59XHJcbiIsICIvKipcclxuICogTW9iaWxlIEJ1dHRvbiBTZXJ2aWNlXHJcbiAqIE1hbmFnZXMgdGhlIG1vYmlsZSBuZXcgdGFiIGJ1dHRvbiByZXBsYWNlbWVudFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgdHlwZSBIb21lQmFzZVBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuXHJcbi8qKlxyXG4gKiBDU1MgY2xhc3MgZm9yIHdoZW4gbW9iaWxlIGJ1dHRvbiBpcyByZXBsYWNlZFxyXG4gKi9cclxuY29uc3QgTU9CSUxFX0hPTUVfQ0xBU1MgPSAnaG9tZS1iYXNlLW1vYmlsZS1lbmFibGVkJztcclxuXHJcbmV4cG9ydCBjbGFzcyBNb2JpbGVCdXR0b25TZXJ2aWNlIHtcclxuXHRwcml2YXRlIHBsdWdpbjogSG9tZUJhc2VQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogSG9tZUJhc2VQbHVnaW4pIHtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlIHRoZSBtb2JpbGUgYnV0dG9uIGJhc2VkIG9uIHNldHRpbmdzXHJcblx0ICovXHJcblx0dXBkYXRlKCk6IHZvaWQge1xyXG5cdFx0Ly8gT25seSBhcHBseSBvbiBtb2JpbGVcclxuXHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0dGhpcy5yZW1vdmUoKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBsYWNlTW9iaWxlTmV3VGFiKSB7XHJcblx0XHRcdHRoaXMuYXBwbHkoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBBcHBseSB0aGUgbW9iaWxlIGJ1dHRvbiByZXBsYWNlbWVudFxyXG5cdCAqL1xyXG5cdHByaXZhdGUgYXBwbHkoKTogdm9pZCB7XHJcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoTU9CSUxFX0hPTUVfQ0xBU1MpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVtb3ZlIHRoZSBtb2JpbGUgYnV0dG9uIHJlcGxhY2VtZW50XHJcblx0ICovXHJcblx0cmVtb3ZlKCk6IHZvaWQge1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKE1PQklMRV9IT01FX0NMQVNTKTtcclxuXHR9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQSw4QkFBQUE7QUFBQSxFQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBMEJPLFNBQVMscUJBQXFCLFdBQW9EO0FBQ3hGLFNBQU9BLHNCQUFxQixTQUFTLFNBQStCO0FBQ3JFO0FBS08sU0FBUyxpQkFBaUIsTUFBc0I7QUFqQ3ZEO0FBa0NDLFFBQU0sUUFBUSxLQUFLLE1BQU0sR0FBRztBQUM1QixTQUFPLE1BQU0sU0FBUyxNQUFLLFdBQU0sTUFBTSxTQUFTLENBQUMsTUFBdEIsWUFBMkIsSUFBSSxZQUFZLElBQUk7QUFDM0U7QUFLTyxTQUFTLG1CQUFtQixNQUFxQjtBQUN2RCxRQUFNLE1BQU0sS0FBSyxVQUFVLFlBQVk7QUFDdkMsTUFBSSxxQkFBcUIsR0FBRyxHQUFHO0FBQzlCLFdBQU8sY0FBYyxHQUFHO0FBQUEsRUFDekI7QUFDQSxTQUFPO0FBQ1I7QUFLTyxTQUFTLGVBQWUsTUFBc0I7QUFDcEQsUUFBTSxNQUFNLEtBQUssVUFBVSxZQUFZO0FBQ3ZDLFNBQU8sUUFBUSxRQUFRLFFBQVE7QUFDaEM7QUFLTyxTQUFTLFVBQVUsTUFBc0I7QUFDL0MsU0FBTyxLQUFLLFVBQVUsWUFBWSxNQUFNO0FBQ3pDO0FBS08sU0FBUyxhQUFhLE1BQXNCO0FBQ2xELFNBQU8sS0FBSyxVQUFVLFlBQVksTUFBTTtBQUN6QztBQUtPLFNBQVMsV0FBVyxNQUFzQjtBQUNoRCxTQUFPLEtBQUssVUFBVSxZQUFZLE1BQU07QUFDekM7QUFLTyxTQUFTLGNBQWMsS0FBVSxNQUE0QjtBQUVuRSxRQUFNLGFBQWEsSUFBSSxNQUFNLHNCQUFzQixJQUFJO0FBQ3ZELE1BQUksc0JBQXNC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QixzQkFBSTtBQUM5RCxRQUFJLENBQUMsY0FBYyxXQUFXLFlBQVksTUFBTSxTQUFTO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxnQkFBZ0IsT0FBTyxFQUMzRCxPQUFPLEtBQUssSUFBSSxVQUFVLGdCQUFnQixVQUFVLENBQUMsRUFDckQsT0FBTyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsUUFBUSxDQUFDLEVBQ25ELE9BQU8sS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLE9BQU8sQ0FBQztBQUdwRCxRQUFJLFdBQVcsV0FBVyxHQUFHO0FBQzVCLFdBQUssS0FBSyxZQUFZLHFCQUFxQixVQUFVLElBQUk7QUFBQSxJQUMxRDtBQUFBLEVBQ0Q7QUFDRDsiLAogICJuYW1lcyI6IFsiU1VQUE9SVEVEX0VYVEVOU0lPTlMiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJIb21lQmFzZVR5cGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiT1ZpZXciLCAic2hvdWxkRm9jdXMiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJtYWluV29ya3NwYWNlIiwgInRhYkhlYWRlciIsICJnZXRGaWxlQnlQYXRoIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
